<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Phalcon Framework. A full-stack PHP framework delivered as a PHP extension, offering lower resource consumption and high performance."><meta name=author content="Phalcon Team"><link href=https://docs.phalcon.io/3.4/tutorial-invo/ rel=canonical><link href=../tutorial-basic/ rel=prev><link href=../tutorial-rest/ rel=next><link rel=icon href=../assets/images/favicon.ico><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.5.49"><title>Invo - Phalcon Documentation</title><link rel=stylesheet href=../assets/stylesheets/main.6f8fc17f.min.css><link rel=stylesheet href=../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Titillium+Web:300,300i,400,400i,700,700i%7CSource+Code+Pro:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Titillium Web";--md-code-font:"Source Code Pro"}</style><link rel=stylesheet href=../assets/css/extra.css><script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-JR4REKBKH3"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-JR4REKBKH3",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-JR4REKBKH3",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script><!-- Fanart --><!--

Phalcon Framework

A full-stack PHP framework delivered as a PHP extension,
offering lower resource consumption and high performance.

<3 Phalcon Team

                         ..
                         ....
   %                  ,   ......
     %%%               ,,  .......
      %%%%%%           ,,,,.........
       %%%%%%%%&        ,,,,,.........,
    /    %%%%%%%%%%      ,,,,,,..........
      //  %%%%%%%%%%%%%    ,,,,,,..........
       //// %%%%%%%%%%%%%%%  ,,,,,,..........,
         ////%%%%%%%%%%%%%%%%%%,,,,,,...........
          ///////%%%%%%%%%%%%%%%%%%,,,,...........
            ////////%%%%%%%%%%%%%%%%%%/,,...........
          %%%%/////////(%%%%%%%%%%%%%%%%%%,..........
            %%%%%//////////%%%%%%%%%%%%%%%%%%........(
               %%%%///////////(%%%%%%%%%%%%%%%%.......(
                 %%%%%////////////%%%%%%%%%%%%%%%.....//
                ....%%%%%////////////#%%%%%%%%%%%%%....//
                   .......(%/////////////%%%%%%%%%%%%..  /
                      ...........///////********/%%%%%..
                     ,,,,.............,/***************.
                         ,,,,,.............************......,/(
                               ,,,,,,..........********.....//////////
                              ((((((((**((((((((((((((*.....///////////
                                  %*********.../(((((((..........///(/#/
                               **********..........#%%%           ..*%%%
                            *********(..........%%%                  %%%
                         *********/..........%%%                     %%
                   %    *******%%.........%%%%
                  %   ******%%%%...../.*((((((   %%%%
                     ****%%%%%%.....///* (((((((%%%%%
                    ***&%%%%%%.....////* ((((((((%%  %
                    *  &%%%%%#..../////*  (((     %
                       &%%%%%....//////*           %
                        %%%% ....//////***   %%%
                     (  %%%   ...*/////*****%%%%
                     (   %     ...  //(*****/%%
                      (  &      ..   // ***  %%
                                 .     /      %
--><!-- Fanart --></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#tutorial-invo class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=.. title="Phalcon Documentation" class="md-header__button md-logo" aria-label="Phalcon Documentation" data-md-component=logo> <img src=https://assets.phalcon.io/phalcon/images/svg/phalcon-logo-35x39.svg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Phalcon Documentation </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Invo </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media=(prefers-color-scheme) data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1M8 13h8v-2H8zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4a5 5 0 0 0 5-5 5 5 0 0 0-5-5"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=custom data-md-color-accent=teal aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=custom data-md-color-accent=teal aria-label="Switch to system preference" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to system preference" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5M7 15a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/phalcon/documentation title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> phalcon/documentation </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../introduction/ class=md-tabs__link> Home </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../installation/ class=md-tabs__link> Getting Started </a> </li> <li class=md-tabs__item> <a href=../application/ class=md-tabs__link> Core </a> </li> <li class=md-tabs__item> <a href=../db-layer/ class=md-tabs__link> Database </a> </li> <li class=md-tabs__item> <a href=../assets/ class=md-tabs__link> Front End </a> </li> <li class=md-tabs__item> <a href=../acl/ class=md-tabs__link> Business Logic </a> </li> <li class=md-tabs__item> <a href=../cache/ class=md-tabs__link> Services </a> </li> <li class=md-tabs__item> <a href=https://github.com/orgs/phalcon/discussions class=md-tabs__link> Discussions </a> </li> <li class=md-tabs__item> <a href=https://github.com/phalcon/phalcon/discussions class=md-tabs__link> Discussions(v6) </a> </li> <li class=md-tabs__item> <a href=https://blog.phalcon.io/ class=md-tabs__link> Blog </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=.. title="Phalcon Documentation" class="md-nav__button md-logo" aria-label="Phalcon Documentation" data-md-component=logo> <img src=https://assets.phalcon.io/phalcon/images/svg/phalcon-logo-35x39.svg alt=logo> </a> Phalcon Documentation </label> <div class=md-nav__source> <a href=https://github.com/phalcon/documentation title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> phalcon/documentation </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_1> <label class=md-nav__link for=__nav_1 id=__nav_1_label tabindex=0> <span class=md-ellipsis> Home </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_1_label aria-expanded=false> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> Home </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../introduction/ class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_1_2> <label class=md-nav__link for=__nav_1_2 id=__nav_1_2_label tabindex=0> <span class=md-ellipsis> Changelog </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_1_2_label aria-expanded=false> <label class=md-nav__title for=__nav_1_2> <span class="md-nav__icon md-icon"></span> Changelog </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=https://github.com/phalcon/cphalcon/blob/5.0.x/CHANGELOG-5.0.md class=md-nav__link> <span class=md-ellipsis> Current Version </span> </a> </li> <li class=md-nav__item> <a href=../releases.md class=md-nav__link> <span class=md-ellipsis> Releases </span> </a> </li> <li class=md-nav__item> <a href=../upgrade.md class=md-nav__link> <span class=md-ellipsis> How to upgrade </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_1_3> <label class=md-nav__link for=__nav_1_3 id=__nav_1_3_label tabindex=0> <span class=md-ellipsis> Contributing </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_1_3_label aria-expanded=false> <label class=md-nav__title for=__nav_1_3> <span class="md-nav__icon md-icon"></span> Contributing </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../contributions/ class=md-nav__link> <span class=md-ellipsis> Contributions </span> </a> </li> <li class=md-nav__item> <a href=https://phalcon.io/discussions class=md-nav__link> <span class=md-ellipsis> Asking a question </span> </a> </li> <li class=md-nav__item> <a href=../new-feature-request/ class=md-nav__link> <span class=md-ellipsis> Requesting a change </span> </a> </li> <li class=md-nav__item> <a href=../new-pull-request/ class=md-nav__link> <span class=md-ellipsis> Issuing a Pull Request </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_1_4> <label class=md-nav__link for=__nav_1_4 id=__nav_1_4_label tabindex=0> <span class=md-ellipsis> Guides </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_1_4_label aria-expanded=false> <label class=md-nav__title for=__nav_1_4> <span class="md-nav__icon md-icon"></span> Guides </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../generating-backtrace/ class=md-nav__link> <span class=md-ellipsis> Backtrace Generation </span> </a> </li> <li class=md-nav__item> <a href=../reproducible-tests/ class=md-nav__link> <span class=md-ellipsis> Reproducible Tests </span> </a> </li> <li class=md-nav__item> <a href=../testing-environment.md class=md-nav__link> <span class=md-ellipsis> Testing environment </span> </a> </li> <li class=md-nav__item> <a href=../coding-standard.md class=md-nav__link> <span class=md-ellipsis> Coding Standard </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../sponsors/ class=md-nav__link> <span class=md-ellipsis> Sponsoring </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2 checked> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex> <span class=md-ellipsis> Getting Started </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=true> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Getting Started </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../installation/ class=md-nav__link> <span class=md-ellipsis> Installation </span> </a> </li> <li class=md-nav__item> <a href=../webserver-setup/ class=md-nav__link> <span class=md-ellipsis> Webserver Setup </span> </a> </li> <li class=md-nav__item> <a href=../webserver-wamp/ class=md-nav__link> <span class=md-ellipsis> WAMP </span> </a> </li> <li class=md-nav__item> <a href=../webserver-xampp/ class=md-nav__link> <span class=md-ellipsis> XAMPP </span> </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_5> <label class=md-nav__link for=__nav_2_5 id=__nav_2_5_label tabindex> <span class=md-ellipsis> Environments </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_5_label aria-expanded=false> <label class=md-nav__title for=__nav_2_5> <span class="md-nav__icon md-icon"></span> Environments </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../environments-nanobox/ class=md-nav__link> <span class=md-ellipsis> Nanobox </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_6> <label class=md-nav__link for=__nav_2_6 id=__nav_2_6_label tabindex> <span class=md-ellipsis> Development Tools </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_6_label aria-expanded=false> <label class=md-nav__title for=__nav_2_6> <span class="md-nav__icon md-icon"></span> Development Tools </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../devtools-installation/ class=md-nav__link> <span class=md-ellipsis> Installation </span> </a> </li> <li class=md-nav__item> <a href=../devtools-usage/ class=md-nav__link> <span class=md-ellipsis> Usage </span> </a> </li> <li class=md-nav__item> <a href=../debug/ class=md-nav__link> <span class=md-ellipsis> Debug </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_7 checked> <label class=md-nav__link for=__nav_2_7 id=__nav_2_7_label tabindex> <span class=md-ellipsis> Tutorials </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_7_label aria-expanded=true> <label class=md-nav__title for=__nav_2_7> <span class="md-nav__icon md-icon"></span> Tutorials </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../tutorial-basic/ class=md-nav__link> <span class=md-ellipsis> Basic </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Invo </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Invo </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#project-structure class=md-nav__link> <span class=md-ellipsis> Project Structure </span> </a> </li> <li class=md-nav__item> <a href=#routing class=md-nav__link> <span class=md-ellipsis> Routing </span> </a> </li> <li class=md-nav__item> <a href=#configuration class=md-nav__link> <span class=md-ellipsis> Configuration </span> </a> </li> <li class=md-nav__item> <a href=#autoloaders class=md-nav__link> <span class=md-ellipsis> Autoloaders </span> </a> </li> <li class=md-nav__item> <a href=#registering-services class=md-nav__link> <span class=md-ellipsis> Registering services </span> </a> </li> <li class=md-nav__item> <a href=#handling-the-request class=md-nav__link> <span class=md-ellipsis> Handling the Request </span> </a> </li> <li class=md-nav__item> <a href=#dependency-injection class=md-nav__link> <span class=md-ellipsis> Dependency Injection </span> </a> </li> <li class=md-nav__item> <a href=#log-into-the-application class=md-nav__link> <span class=md-ellipsis> Log into the Application </span> </a> </li> <li class=md-nav__item> <a href=#securing-the-backend class=md-nav__link> <span class=md-ellipsis> Securing the Backend </span> </a> <nav class=md-nav aria-label="Securing the Backend"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#events-management class=md-nav__link> <span class=md-ellipsis> Events Management </span> </a> </li> <li class=md-nav__item> <a href=#getting-the-acl-list class=md-nav__link> <span class=md-ellipsis> Getting the ACL list </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#working-with-the-crud class=md-nav__link> <span class=md-ellipsis> Working with the CRUD </span> </a> </li> <li class=md-nav__item> <a href=#the-search-form class=md-nav__link> <span class=md-ellipsis> The Search Form </span> </a> </li> <li class=md-nav__item> <a href=#performing-a-search class=md-nav__link> <span class=md-ellipsis> Performing a Search </span> </a> </li> <li class=md-nav__item> <a href=#creating-and-updating-records class=md-nav__link> <span class=md-ellipsis> Creating and Updating Records </span> </a> </li> <li class=md-nav__item> <a href=#user-components class=md-nav__link> <span class=md-ellipsis> User Components </span> </a> </li> <li class=md-nav__item> <a href=#changing-the-title-dynamically class=md-nav__link> <span class=md-ellipsis> Changing the Title Dynamically </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../tutorial-rest/ class=md-nav__link> <span class=md-ellipsis> REST </span> </a> </li> <li class=md-nav__item> <a href=../tutorial-vokuro/ class=md-nav__link> <span class=md-ellipsis> Vokuro </span> </a> </li> <li class=md-nav__item> <a href=../performance/ class=md-nav__link> <span class=md-ellipsis> Performance </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Core </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Core </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../application/ class=md-nav__link> <span class=md-ellipsis> Application </span> </a> </li> <li class=md-nav__item> <a href=../application-micro/ class=md-nav__link> <span class=md-ellipsis> Micro </span> </a> </li> <li class=md-nav__item> <a href=../application-cli/ class=md-nav__link> <span class=md-ellipsis> CLI </span> </a> </li> <li class=md-nav__item> <a href=../di/ class=md-nav__link> <span class=md-ellipsis> DI Container </span> </a> </li> <li class=md-nav__item> <a href=../mvc/ class=md-nav__link> <span class=md-ellipsis> MVC </span> </a> </li> <li class=md-nav__item> <a href=../namespaces/ class=md-nav__link> <span class=md-ellipsis> Namespaces </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> Database </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Database </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../db-layer/ class=md-nav__link> <span class=md-ellipsis> Layer </span> </a> </li> <li class=md-nav__item> <a href=../db-phql/ class=md-nav__link> <span class=md-ellipsis> PHQL </span> </a> </li> <li class=md-nav__item> <a href=../db-odm/ class=md-nav__link> <span class=md-ellipsis> ODM </span> </a> </li> <li class=md-nav__item> <a href=../db-models/ class=md-nav__link> <span class=md-ellipsis> Models </span> </a> </li> <li class=md-nav__item> <a href=../db-models-behaviors/ class=md-nav__link> <span class=md-ellipsis> Behaviors </span> </a> </li> <li class=md-nav__item> <a href=../db-models-cache/ class=md-nav__link> <span class=md-ellipsis> Cache </span> </a> </li> <li class=md-nav__item> <a href=../db-models-events/ class=md-nav__link> <span class=md-ellipsis> Events </span> </a> </li> <li class=md-nav__item> <a href=../db-models-metadata/ class=md-nav__link> <span class=md-ellipsis> Metadata </span> </a> </li> <li class=md-nav__item> <a href=../db-models-relationships/ class=md-nav__link> <span class=md-ellipsis> Relationships </span> </a> </li> <li class=md-nav__item> <a href=../db-models-transactions/ class=md-nav__link> <span class=md-ellipsis> Transactions </span> </a> </li> <li class=md-nav__item> <a href=../db-models-validation/ class=md-nav__link> <span class=md-ellipsis> Validators </span> </a> </li> <li class=md-nav__item> <a href=../db-pagination/ class=md-nav__link> <span class=md-ellipsis> Pagination </span> </a> </li> <li class=md-nav__item> <a href=../db-migrations/ class=md-nav__link> <span class=md-ellipsis> Migrations </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> Front End </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Front End </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../assets/ class=md-nav__link> <span class=md-ellipsis> Assets </span> </a> </li> <li class=md-nav__item> <a href=../flash/ class=md-nav__link> <span class=md-ellipsis> Flash Messenger </span> </a> </li> <li class=md-nav__item> <a href=../forms/ class=md-nav__link> <span class=md-ellipsis> Forms </span> </a> </li> <li class=md-nav__item> <a href=../image/ class=md-nav__link> <span class=md-ellipsis> Image </span> </a> </li> <li class=md-nav__item> <a href=../tag/ class=md-nav__link> <span class=md-ellipsis> Tag </span> </a> </li> <li class=md-nav__item> <a href=../views/ class=md-nav__link> <span class=md-ellipsis> View </span> </a> </li> <li class=md-nav__item> <a href=../volt/ class=md-nav__link> <span class=md-ellipsis> Volt </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> <span class=md-ellipsis> Business Logic </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Business Logic </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../acl/ class=md-nav__link> <span class=md-ellipsis> Access Control Lists </span> </a> </li> <li class=md-nav__item> <a href=../annotations/ class=md-nav__link> <span class=md-ellipsis> Annotations </span> </a> </li> <li class=md-nav__item> <a href=../controllers/ class=md-nav__link> <span class=md-ellipsis> Controllers </span> </a> </li> <li class=md-nav__item> <a href=../dispatcher/ class=md-nav__link> <span class=md-ellipsis> Dispatcher </span> </a> </li> <li class=md-nav__item> <a href=../events/ class=md-nav__link> <span class=md-ellipsis> Event Manager </span> </a> </li> <li class=md-nav__item> <a href=../filter/ class=md-nav__link> <span class=md-ellipsis> Filters </span> </a> </li> <li class=md-nav__item> <a href=../routing/ class=md-nav__link> <span class=md-ellipsis> Routing </span> </a> </li> <li class=md-nav__item> <a href=../session/ class=md-nav__link> <span class=md-ellipsis> Sessions </span> </a> </li> <li class=md-nav__item> <a href=../url/ class=md-nav__link> <span class=md-ellipsis> Url </span> </a> </li> <li class=md-nav__item> <a href=../validation/ class=md-nav__link> <span class=md-ellipsis> Validation </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7> <label class=md-nav__link for=__nav_7 id=__nav_7_label tabindex=0> <span class=md-ellipsis> Services </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Services </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../cache/ class=md-nav__link> <span class=md-ellipsis> Cache </span> </a> </li> <li class=md-nav__item> <a href=../config/ class=md-nav__link> <span class=md-ellipsis> Config </span> </a> </li> <li class=md-nav__item> <a href=../escaper/ class=md-nav__link> <span class=md-ellipsis> Escaper </span> </a> </li> <li class=md-nav__item> <a href=../loader/ class=md-nav__link> <span class=md-ellipsis> Loader </span> </a> </li> <li class=md-nav__item> <a href=../logging/ class=md-nav__link> <span class=md-ellipsis> Logger </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_6> <label class=md-nav__link for=__nav_7_6 id=__nav_7_6_label tabindex=0> <span class=md-ellipsis> HTTP </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_7_6_label aria-expanded=false> <label class=md-nav__title for=__nav_7_6> <span class="md-nav__icon md-icon"></span> HTTP </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../cookies/ class=md-nav__link> <span class=md-ellipsis> Cookies </span> </a> </li> <li class=md-nav__item> <a href=../request/ class=md-nav__link> <span class=md-ellipsis> Request </span> </a> </li> <li class=md-nav__item> <a href=../response/ class=md-nav__link> <span class=md-ellipsis> Response </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_7> <label class=md-nav__link for=__nav_7_7 id=__nav_7_7_label tabindex=0> <span class=md-ellipsis> i18n </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_7_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7_7> <span class="md-nav__icon md-icon"></span> i18n </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../i18n/ class=md-nav__link> <span class=md-ellipsis> Internationalization </span> </a> </li> <li class=md-nav__item> <a href=../translate/ class=md-nav__link> <span class=md-ellipsis> Translate </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../queue/ class=md-nav__link> <span class=md-ellipsis> Queue </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_9> <label class=md-nav__link for=__nav_7_9 id=__nav_7_9_label tabindex=0> <span class=md-ellipsis> Security </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_7_9_label aria-expanded=false> <label class=md-nav__title for=__nav_7_9> <span class="md-nav__icon md-icon"></span> Security </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../crypt/ class=md-nav__link> <span class=md-ellipsis> Cryptography </span> </a> </li> <li class=md-nav__item> <a href=../security/ class=md-nav__link> <span class=md-ellipsis> Security </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=https://github.com/orgs/phalcon/discussions class=md-nav__link> <span class=md-ellipsis> Discussions </span> </a> </li> <li class=md-nav__item> <a href=https://github.com/phalcon/phalcon/discussions class=md-nav__link> <span class=md-ellipsis> Discussions(v6) </span> </a> </li> <li class=md-nav__item> <a href=https://blog.phalcon.io/ class=md-nav__link> <span class=md-ellipsis> Blog </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#project-structure class=md-nav__link> <span class=md-ellipsis> Project Structure </span> </a> </li> <li class=md-nav__item> <a href=#routing class=md-nav__link> <span class=md-ellipsis> Routing </span> </a> </li> <li class=md-nav__item> <a href=#configuration class=md-nav__link> <span class=md-ellipsis> Configuration </span> </a> </li> <li class=md-nav__item> <a href=#autoloaders class=md-nav__link> <span class=md-ellipsis> Autoloaders </span> </a> </li> <li class=md-nav__item> <a href=#registering-services class=md-nav__link> <span class=md-ellipsis> Registering services </span> </a> </li> <li class=md-nav__item> <a href=#handling-the-request class=md-nav__link> <span class=md-ellipsis> Handling the Request </span> </a> </li> <li class=md-nav__item> <a href=#dependency-injection class=md-nav__link> <span class=md-ellipsis> Dependency Injection </span> </a> </li> <li class=md-nav__item> <a href=#log-into-the-application class=md-nav__link> <span class=md-ellipsis> Log into the Application </span> </a> </li> <li class=md-nav__item> <a href=#securing-the-backend class=md-nav__link> <span class=md-ellipsis> Securing the Backend </span> </a> <nav class=md-nav aria-label="Securing the Backend"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#events-management class=md-nav__link> <span class=md-ellipsis> Events Management </span> </a> </li> <li class=md-nav__item> <a href=#getting-the-acl-list class=md-nav__link> <span class=md-ellipsis> Getting the ACL list </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#working-with-the-crud class=md-nav__link> <span class=md-ellipsis> Working with the CRUD </span> </a> </li> <li class=md-nav__item> <a href=#the-search-form class=md-nav__link> <span class=md-ellipsis> The Search Form </span> </a> </li> <li class=md-nav__item> <a href=#performing-a-search class=md-nav__link> <span class=md-ellipsis> Performing a Search </span> </a> </li> <li class=md-nav__item> <a href=#creating-and-updating-records class=md-nav__link> <span class=md-ellipsis> Creating and Updating Records </span> </a> </li> <li class=md-nav__item> <a href=#user-components class=md-nav__link> <span class=md-ellipsis> User Components </span> </a> </li> <li class=md-nav__item> <a href=#changing-the-title-dynamically class=md-nav__link> <span class=md-ellipsis> Changing the Title Dynamically </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/phalcon/documentation/edit/master/docs/tutorial-invo.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg> </a> <a href=https://github.com/phalcon/documentation/raw/master/docs/tutorial-invo.md title="View source of this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg> </a> <h1 id=tutorial-invo>Tutorial: INVO<a class=headerlink href=#tutorial-invo title="Permanent link">&para;</a></h1> <p>In this second tutorial, we'll explain a more complete application in order to gain a deeper understanding of developing with Phalcon. INVO is one of the sample applications we have created. INVO is a small website that allows users to generate invoices and do other tasks such as manage customers and products. You can clone its code from <a href=https://github.com/phalcon/invo>GitHub</a>.</p> <p>INVO was made with the client-side framework <a href=https://getbootstrap.com/ >Bootstrap</a>. Although the application does not generate actual invoices, it still serves as an example showing how the framework works.</p> <h2 id=project-structure>Project Structure<a class=headerlink href=#project-structure title="Permanent link">&para;</a></h2> <p>Once you clone the project in your document root you'll see the following structure:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a>invo/
<a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=w>    </span>app/
<a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=w>        </span>config/
<a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=w>        </span>controllers/
<a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=w>        </span>forms/
<a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=w>        </span>library/
<a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=w>        </span>logs/
<a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=w>        </span>models/
<a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a><span class=w>        </span>plugins/
<a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a><span class=w>        </span>views/
<a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a><span class=w>    </span>cache/
<a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a><span class=w>        </span>volt/
<a id=__codelineno-0-13 name=__codelineno-0-13 href=#__codelineno-0-13></a><span class=w>    </span>docs/
<a id=__codelineno-0-14 name=__codelineno-0-14 href=#__codelineno-0-14></a><span class=w>    </span>public/
<a id=__codelineno-0-15 name=__codelineno-0-15 href=#__codelineno-0-15></a><span class=w>        </span>css/
<a id=__codelineno-0-16 name=__codelineno-0-16 href=#__codelineno-0-16></a><span class=w>        </span>fonts/
<a id=__codelineno-0-17 name=__codelineno-0-17 href=#__codelineno-0-17></a><span class=w>        </span>js/
<a id=__codelineno-0-18 name=__codelineno-0-18 href=#__codelineno-0-18></a><span class=w>    </span>schemas/
</code></pre></div> <p>As you know, Phalcon does not impose a particular file structure for application development. This project has a simple MVC structure and a public document root.</p> <p>Once you open the application in your browser <code>http://localhost/invo</code> you'll see something like this:</p> <p><img alt src=../assets/images/content/tutorial-invo-1.png></p> <p>The application is divided into two parts: a frontend and a backend. The frontend is a public area where visitors can receive information about INVO and request contact information. The backend is an administrative area where registered users can manage their products and customers.</p> <h2 id=routing>Routing<a class=headerlink href=#routing title="Permanent link">&para;</a></h2> <p>INVO uses the standard route that is built-in with the <a href=../routing/ >Router</a> component. These routes match the following pattern: <code>/:controller/:action/:params</code>. This means that the first part of a URI is the controller, the second the controller action and the rest are the parameters.</p> <p>The following route <code>/session/register</code> executes the controller <code>SessionController</code> and its action <code>registerAction</code>.</p> <h2 id=configuration>Configuration<a class=headerlink href=#configuration title="Permanent link">&para;</a></h2> <p>INVO has a configuration file that sets general parameters in the application. This file is located at <code>app/config/config.ini</code> and is loaded in the very first lines of the application bootstrap (<code>public/index.php</code>):</p> <div class=highlight><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a>
<a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a><span class=k>use</span> <span class=nx>Phalcon\Config\Adapter\Ini</span> <span class=k>as</span> <span class=nx>ConfigIni</span><span class=p>;</span>
<a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a>
<a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a><span class=c1>// ...</span>
<a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a>
<a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a><span class=c1>// Read the configuration</span>
<a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a><span class=nv>$config</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>ConfigIni</span><span class=p>(</span>
<a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a>    <span class=nx>APP_PATH</span> <span class=o>.</span> <span class=s1>&#39;app/config/config.ini&#39;</span>
<a id=__codelineno-1-10 name=__codelineno-1-10 href=#__codelineno-1-10></a><span class=p>);</span>
</code></pre></div> <p><a href=../config/ >Phalcon Config</a> (<a href=../api/Phalcon_Config/ >Phalcon\Config</a>) allows us to manipulate the file in an object-oriented way. In this example, we're using an ini file for configuration but Phalcon has <a href=../config/ >adapters</a> for other file types as well. The configuration file contains the following settings:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=k>[database]</span>
<a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a><span class=na>host</span><span class=w>     </span><span class=o>=</span><span class=w> </span><span class=s>localhost</span>
<a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a><span class=na>username</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>root</span>
<a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a><span class=na>password</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>secret</span>
<a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a><span class=na>name</span><span class=w>     </span><span class=o>=</span><span class=w> </span><span class=s>invo</span>
<a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a>
<a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a><span class=k>[application]</span>
<a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a><span class=na>controllersDir</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>app/controllers/</span>
<a id=__codelineno-2-9 name=__codelineno-2-9 href=#__codelineno-2-9></a><span class=na>modelsDir</span><span class=w>      </span><span class=o>=</span><span class=w> </span><span class=s>app/models/</span>
<a id=__codelineno-2-10 name=__codelineno-2-10 href=#__codelineno-2-10></a><span class=na>viewsDir</span><span class=w>       </span><span class=o>=</span><span class=w> </span><span class=s>app/views/</span>
<a id=__codelineno-2-11 name=__codelineno-2-11 href=#__codelineno-2-11></a><span class=na>pluginsDir</span><span class=w>     </span><span class=o>=</span><span class=w> </span><span class=s>app/plugins/</span>
<a id=__codelineno-2-12 name=__codelineno-2-12 href=#__codelineno-2-12></a><span class=na>formsDir</span><span class=w>       </span><span class=o>=</span><span class=w> </span><span class=s>app/forms/</span>
<a id=__codelineno-2-13 name=__codelineno-2-13 href=#__codelineno-2-13></a><span class=na>libraryDir</span><span class=w>     </span><span class=o>=</span><span class=w> </span><span class=s>app/library/</span>
<a id=__codelineno-2-14 name=__codelineno-2-14 href=#__codelineno-2-14></a><span class=na>baseUri</span><span class=w>        </span><span class=o>=</span><span class=w> </span><span class=s>/invo/</span>
</code></pre></div> <p>Phalcon doesn't have any pre-defined settings convention. Sections help us to organize the options as appropriate. In this file there are two sections to be used later: <code>application</code> and <code>database</code>.</p> <h2 id=autoloaders>Autoloaders<a class=headerlink href=#autoloaders title="Permanent link">&para;</a></h2> <p>The second part that appears in the bootstrap file (<code>public/index.php</code>) is the autoloader:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a>
<a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a><span class=sd>/**</span>
<a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a><span class=sd> * Auto-loader configuration</span>
<a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a><span class=sd> */</span>
<a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a><span class=k>require</span> <span class=nx>APP_PATH</span> <span class=o>.</span> <span class=s1>&#39;app/config/loader.php&#39;</span><span class=p>;</span>
</code></pre></div> <p>The autoloader registers a set of directories in which the application will look for the classes that it will eventually need.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a>
<a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a><span class=nv>$loader</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Phalcon\Loader</span><span class=p>();</span>
<a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a>
<a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a><span class=c1>// We&#39;re a registering a set of directories taken from the configuration file</span>
<a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a><span class=nv>$loader</span><span class=o>-&gt;</span><span class=na>registerDirs</span><span class=p>(</span>
<a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a>    <span class=p>[</span>
<a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a>        <span class=nx>APP_PATH</span> <span class=o>.</span> <span class=nv>$config</span><span class=o>-&gt;</span><span class=na>application</span><span class=o>-&gt;</span><span class=na>controllersDir</span><span class=p>,</span>
<a id=__codelineno-4-9 name=__codelineno-4-9 href=#__codelineno-4-9></a>        <span class=nx>APP_PATH</span> <span class=o>.</span> <span class=nv>$config</span><span class=o>-&gt;</span><span class=na>application</span><span class=o>-&gt;</span><span class=na>pluginsDir</span><span class=p>,</span>
<a id=__codelineno-4-10 name=__codelineno-4-10 href=#__codelineno-4-10></a>        <span class=nx>APP_PATH</span> <span class=o>.</span> <span class=nv>$config</span><span class=o>-&gt;</span><span class=na>application</span><span class=o>-&gt;</span><span class=na>libraryDir</span><span class=p>,</span>
<a id=__codelineno-4-11 name=__codelineno-4-11 href=#__codelineno-4-11></a>        <span class=nx>APP_PATH</span> <span class=o>.</span> <span class=nv>$config</span><span class=o>-&gt;</span><span class=na>application</span><span class=o>-&gt;</span><span class=na>modelsDir</span><span class=p>,</span>
<a id=__codelineno-4-12 name=__codelineno-4-12 href=#__codelineno-4-12></a>        <span class=nx>APP_PATH</span> <span class=o>.</span> <span class=nv>$config</span><span class=o>-&gt;</span><span class=na>application</span><span class=o>-&gt;</span><span class=na>formsDir</span><span class=p>,</span>
<a id=__codelineno-4-13 name=__codelineno-4-13 href=#__codelineno-4-13></a>    <span class=p>]</span>
<a id=__codelineno-4-14 name=__codelineno-4-14 href=#__codelineno-4-14></a><span class=p>);</span>
<a id=__codelineno-4-15 name=__codelineno-4-15 href=#__codelineno-4-15></a>
<a id=__codelineno-4-16 name=__codelineno-4-16 href=#__codelineno-4-16></a><span class=nv>$loader</span><span class=o>-&gt;</span><span class=na>register</span><span class=p>();</span>
</code></pre></div> <p>Note that the above code has registered the directories that were defined in the configuration file. The only directory that is not registered is the viewsDir because it contains HTML + PHP files but no classes. Also, note that we use a constant called APP_PATH. This constant is defined in the bootstrap (<code>public/index.php</code>) to allow us to have a reference to the root of our project:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a>
<a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a><span class=c1>// ...</span>
<a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a>
<a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a><span class=nb>define</span><span class=p>(</span>
<a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a>    <span class=s1>&#39;APP_PATH&#39;</span><span class=p>,</span>
<a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a>    <span class=nb>realpath</span><span class=p>(</span><span class=s1>&#39;..&#39;</span><span class=p>)</span> <span class=o>.</span> <span class=s1>&#39;/&#39;</span>
<a id=__codelineno-5-8 name=__codelineno-5-8 href=#__codelineno-5-8></a><span class=p>);</span>
</code></pre></div> <h2 id=registering-services>Registering services<a class=headerlink href=#registering-services title="Permanent link">&para;</a></h2> <p>Another file that is required in the bootstrap is (<code>app/config/services.php</code>). This file allows us to organize the services that INVO uses.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a>
<a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a><span class=sd>/**</span>
<a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a><span class=sd> * Load application services</span>
<a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a><span class=sd> */</span>
<a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a><span class=k>require</span> <span class=nx>APP_PATH</span> <span class=o>.</span> <span class=s1>&#39;app/config/services.php&#39;</span><span class=p>;</span>
</code></pre></div> <p>Service registration is achieved with closures for lazy loading the required components:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a>
<a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Url</span> <span class=k>as</span> <span class=nx>UrlProvider</span><span class=p>;</span>
<a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a>
<a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a><span class=c1>// ...</span>
<a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a>
<a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a><span class=sd>/**</span>
<a id=__codelineno-7-8 name=__codelineno-7-8 href=#__codelineno-7-8></a><span class=sd> * The URL component is used to generate all kind of URLs in the application</span>
<a id=__codelineno-7-9 name=__codelineno-7-9 href=#__codelineno-7-9></a><span class=sd> */</span>
<a id=__codelineno-7-10 name=__codelineno-7-10 href=#__codelineno-7-10></a><span class=nv>$di</span><span class=o>-&gt;</span><span class=na>set</span><span class=p>(</span>
<a id=__codelineno-7-11 name=__codelineno-7-11 href=#__codelineno-7-11></a>    <span class=s1>&#39;url&#39;</span><span class=p>,</span>
<a id=__codelineno-7-12 name=__codelineno-7-12 href=#__codelineno-7-12></a>    <span class=k>function</span> <span class=p>()</span> <span class=k>use</span> <span class=p>(</span><span class=nv>$config</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-7-13 name=__codelineno-7-13 href=#__codelineno-7-13></a>        <span class=nv>$url</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>UrlProvider</span><span class=p>();</span>
<a id=__codelineno-7-14 name=__codelineno-7-14 href=#__codelineno-7-14></a>
<a id=__codelineno-7-15 name=__codelineno-7-15 href=#__codelineno-7-15></a>        <span class=nv>$url</span><span class=o>-&gt;</span><span class=na>setBaseUri</span><span class=p>(</span>
<a id=__codelineno-7-16 name=__codelineno-7-16 href=#__codelineno-7-16></a>            <span class=nv>$config</span><span class=o>-&gt;</span><span class=na>application</span><span class=o>-&gt;</span><span class=na>baseUri</span>
<a id=__codelineno-7-17 name=__codelineno-7-17 href=#__codelineno-7-17></a>        <span class=p>);</span>
<a id=__codelineno-7-18 name=__codelineno-7-18 href=#__codelineno-7-18></a>
<a id=__codelineno-7-19 name=__codelineno-7-19 href=#__codelineno-7-19></a>        <span class=k>return</span> <span class=nv>$url</span><span class=p>;</span>
<a id=__codelineno-7-20 name=__codelineno-7-20 href=#__codelineno-7-20></a>    <span class=p>}</span>
<a id=__codelineno-7-21 name=__codelineno-7-21 href=#__codelineno-7-21></a><span class=p>);</span>
</code></pre></div> <p>We will discuss this file in depth later.</p> <h2 id=handling-the-request>Handling the Request<a class=headerlink href=#handling-the-request title="Permanent link">&para;</a></h2> <p>If we skip to the end of the file (<code>public/index.php</code>), the request is finally handled by <a href=../api/Phalcon_Mvc_Application/ >Phalcon\Mvc\Application</a> which initializes and executes all that is necessary to make the application run:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a>
<a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Application</span><span class=p>;</span>
<a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a>
<a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a><span class=c1>// ...</span>
<a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a>
<a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a><span class=nv>$application</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Application</span><span class=p>(</span><span class=nv>$di</span><span class=p>);</span>
<a id=__codelineno-8-8 name=__codelineno-8-8 href=#__codelineno-8-8></a>
<a id=__codelineno-8-9 name=__codelineno-8-9 href=#__codelineno-8-9></a><span class=nv>$response</span> <span class=o>=</span> <span class=nv>$application</span><span class=o>-&gt;</span><span class=na>handle</span><span class=p>();</span>
<a id=__codelineno-8-10 name=__codelineno-8-10 href=#__codelineno-8-10></a>
<a id=__codelineno-8-11 name=__codelineno-8-11 href=#__codelineno-8-11></a><span class=nv>$response</span><span class=o>-&gt;</span><span class=na>send</span><span class=p>();</span>
</code></pre></div> <h2 id=dependency-injection>Dependency Injection<a class=headerlink href=#dependency-injection title="Permanent link">&para;</a></h2> <p>In the first line of the code block above, the Application class constructor is receiving the variable <code>$di</code> as an argument. What is the purpose of that variable? Phalcon is a highly decoupled framework so we need a component that acts as glue to make everything work together. That component is <a href=../api/Phalcon_Di/ >Phalcon\Di</a>. It's a service container that also performs dependency injection and service location, instantiating all components as they are needed by the application.</p> <p>There are many ways of registering services in the container. In INVO, most services have been registered using anonymous functions/closures. Thanks to this, the objects are instantiated in a lazy way, reducing the resources needed by the application.</p> <p>For instance, in the following excerpt the session service is registered. The anonymous function will only be called when the application requires access to the session data:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a>
<a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a><span class=k>use</span> <span class=nx>Phalcon\Session\Adapter\Files</span> <span class=k>as</span> <span class=nx>Session</span><span class=p>;</span>
<a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a>
<a id=__codelineno-9-5 name=__codelineno-9-5 href=#__codelineno-9-5></a><span class=c1>// ...</span>
<a id=__codelineno-9-6 name=__codelineno-9-6 href=#__codelineno-9-6></a>
<a id=__codelineno-9-7 name=__codelineno-9-7 href=#__codelineno-9-7></a><span class=c1>// Start the session the first time a component requests the session service</span>
<a id=__codelineno-9-8 name=__codelineno-9-8 href=#__codelineno-9-8></a><span class=nv>$di</span><span class=o>-&gt;</span><span class=na>set</span><span class=p>(</span>
<a id=__codelineno-9-9 name=__codelineno-9-9 href=#__codelineno-9-9></a>    <span class=s1>&#39;session&#39;</span><span class=p>,</span>
<a id=__codelineno-9-10 name=__codelineno-9-10 href=#__codelineno-9-10></a>    <span class=k>function</span> <span class=p>()</span> <span class=p>{</span>
<a id=__codelineno-9-11 name=__codelineno-9-11 href=#__codelineno-9-11></a>        <span class=nv>$session</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Session</span><span class=p>();</span>
<a id=__codelineno-9-12 name=__codelineno-9-12 href=#__codelineno-9-12></a>
<a id=__codelineno-9-13 name=__codelineno-9-13 href=#__codelineno-9-13></a>        <span class=nv>$session</span><span class=o>-&gt;</span><span class=na>start</span><span class=p>();</span>
<a id=__codelineno-9-14 name=__codelineno-9-14 href=#__codelineno-9-14></a>
<a id=__codelineno-9-15 name=__codelineno-9-15 href=#__codelineno-9-15></a>        <span class=k>return</span> <span class=nv>$session</span><span class=p>;</span>
<a id=__codelineno-9-16 name=__codelineno-9-16 href=#__codelineno-9-16></a>    <span class=p>}</span>
<a id=__codelineno-9-17 name=__codelineno-9-17 href=#__codelineno-9-17></a><span class=p>);</span>
</code></pre></div> <p>Here, we have the freedom to change the adapter, perform additional initialization and much more. Note that the service was registered using the name <code>session</code>. This is a convention that will allow the framework to identify the active service in the services container.</p> <p>A request can use many services and registering each service individually can be a cumbersome task. For that reason, the framework provides a variant of <a href=../api/Phalcon_Di/ >Phalcon\Di</a> called <a href=../api/Phalcon_Di/ >Phalcon\Di\FactoryDefault</a> whose task is to register all services providing a full-stack framework.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a>
<a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a><span class=k>use</span> <span class=nx>Phalcon\Di\FactoryDefault</span><span class=p>;</span>
<a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a>
<a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a><span class=c1>// ...</span>
<a id=__codelineno-10-6 name=__codelineno-10-6 href=#__codelineno-10-6></a>
<a id=__codelineno-10-7 name=__codelineno-10-7 href=#__codelineno-10-7></a><span class=c1>// The FactoryDefault Dependency Injector automatically registers the</span>
<a id=__codelineno-10-8 name=__codelineno-10-8 href=#__codelineno-10-8></a><span class=c1>// right services providing a full-stack framework</span>
<a id=__codelineno-10-9 name=__codelineno-10-9 href=#__codelineno-10-9></a><span class=nv>$di</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>FactoryDefault</span><span class=p>();</span>
</code></pre></div> <p>It registers the majority of services with components provided by the framework as standard. If we need to override the definition of some service we could just set it again as we did above with <code>session</code> or <code>url</code>. This is the reason for the existence of the variable <code>$di</code>.</p> <h2 id=log-into-the-application>Log into the Application<a class=headerlink href=#log-into-the-application title="Permanent link">&para;</a></h2> <p>A <code>log in</code> facility will allow us to work on backend controllers. The separation between backend controllers and frontend ones is only logical. All controllers are located in the same directory (<code>app/controllers/</code>).</p> <p>To enter the system, users must have a valid username and password. Users are stored in the table <code>users</code> in the database <code>invo</code>.</p> <p>Before we can start a session, we need to configure the connection to the database in the application. A service called <code>db</code> is set up in the service container with the connection information. As with the autoloader, we are again taking parameters from the configuration file in order to configure a service:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a>
<a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a><span class=k>use</span> <span class=nx>Phalcon\Db\Adapter\Pdo\Mysql</span> <span class=k>as</span> <span class=nx>DbAdapter</span><span class=p>;</span>
<a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a>
<a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a><span class=c1>// ...</span>
<a id=__codelineno-11-6 name=__codelineno-11-6 href=#__codelineno-11-6></a>
<a id=__codelineno-11-7 name=__codelineno-11-7 href=#__codelineno-11-7></a><span class=c1>// Database connection is created based on parameters defined in the configuration file</span>
<a id=__codelineno-11-8 name=__codelineno-11-8 href=#__codelineno-11-8></a><span class=nv>$di</span><span class=o>-&gt;</span><span class=na>set</span><span class=p>(</span>
<a id=__codelineno-11-9 name=__codelineno-11-9 href=#__codelineno-11-9></a>    <span class=s1>&#39;db&#39;</span><span class=p>,</span>
<a id=__codelineno-11-10 name=__codelineno-11-10 href=#__codelineno-11-10></a>    <span class=k>function</span> <span class=p>()</span> <span class=k>use</span> <span class=p>(</span><span class=nv>$config</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-11-11 name=__codelineno-11-11 href=#__codelineno-11-11></a>        <span class=k>return</span> <span class=k>new</span> <span class=nx>DbAdapter</span><span class=p>(</span>
<a id=__codelineno-11-12 name=__codelineno-11-12 href=#__codelineno-11-12></a>            <span class=p>[</span>
<a id=__codelineno-11-13 name=__codelineno-11-13 href=#__codelineno-11-13></a>                <span class=s1>&#39;host&#39;</span>     <span class=o>=&gt;</span> <span class=nv>$config</span><span class=o>-&gt;</span><span class=na>database</span><span class=o>-&gt;</span><span class=na>host</span><span class=p>,</span>
<a id=__codelineno-11-14 name=__codelineno-11-14 href=#__codelineno-11-14></a>                <span class=s1>&#39;username&#39;</span> <span class=o>=&gt;</span> <span class=nv>$config</span><span class=o>-&gt;</span><span class=na>database</span><span class=o>-&gt;</span><span class=na>username</span><span class=p>,</span>
<a id=__codelineno-11-15 name=__codelineno-11-15 href=#__codelineno-11-15></a>                <span class=s1>&#39;password&#39;</span> <span class=o>=&gt;</span> <span class=nv>$config</span><span class=o>-&gt;</span><span class=na>database</span><span class=o>-&gt;</span><span class=na>password</span><span class=p>,</span>
<a id=__codelineno-11-16 name=__codelineno-11-16 href=#__codelineno-11-16></a>                <span class=s1>&#39;dbname&#39;</span>   <span class=o>=&gt;</span> <span class=nv>$config</span><span class=o>-&gt;</span><span class=na>database</span><span class=o>-&gt;</span><span class=na>name</span><span class=p>,</span>
<a id=__codelineno-11-17 name=__codelineno-11-17 href=#__codelineno-11-17></a>            <span class=p>]</span>
<a id=__codelineno-11-18 name=__codelineno-11-18 href=#__codelineno-11-18></a>        <span class=p>);</span>
<a id=__codelineno-11-19 name=__codelineno-11-19 href=#__codelineno-11-19></a>    <span class=p>}</span>
<a id=__codelineno-11-20 name=__codelineno-11-20 href=#__codelineno-11-20></a><span class=p>);</span>
</code></pre></div> <p>Here, we return an instance of the MySQL connection adapter. If needed, you could do extra actions such as adding a logger, a profiler or change the adapter, setting it up as you want.</p> <p>The following simple form (<code>app/views/session/index.volt</code>) requests the login information. We've removed some HTML code to make the example more concise:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a><span class=cp>{%</span> <span class=k>raw</span> <span class=cp>%}</span>
<a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a><span class=x>{{ form(&#39;session/start&#39;) }}</span>
<a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a><span class=x>    &lt;fieldset&gt;</span>
<a id=__codelineno-12-4 name=__codelineno-12-4 href=#__codelineno-12-4></a><span class=x>        &lt;div&gt;</span>
<a id=__codelineno-12-5 name=__codelineno-12-5 href=#__codelineno-12-5></a><span class=x>            &lt;label for=&#39;email&#39;&gt;</span>
<a id=__codelineno-12-6 name=__codelineno-12-6 href=#__codelineno-12-6></a><span class=x>                Username/Email</span>
<a id=__codelineno-12-7 name=__codelineno-12-7 href=#__codelineno-12-7></a><span class=x>            &lt;/label&gt;</span>
<a id=__codelineno-12-8 name=__codelineno-12-8 href=#__codelineno-12-8></a>
<a id=__codelineno-12-9 name=__codelineno-12-9 href=#__codelineno-12-9></a><span class=x>            &lt;div&gt;</span>
<a id=__codelineno-12-10 name=__codelineno-12-10 href=#__codelineno-12-10></a><span class=x>                {{ text_field(&#39;email&#39;) }}</span>
<a id=__codelineno-12-11 name=__codelineno-12-11 href=#__codelineno-12-11></a><span class=x>            &lt;/div&gt;</span>
<a id=__codelineno-12-12 name=__codelineno-12-12 href=#__codelineno-12-12></a><span class=x>        &lt;/div&gt;</span>
<a id=__codelineno-12-13 name=__codelineno-12-13 href=#__codelineno-12-13></a>
<a id=__codelineno-12-14 name=__codelineno-12-14 href=#__codelineno-12-14></a><span class=x>        &lt;div&gt;</span>
<a id=__codelineno-12-15 name=__codelineno-12-15 href=#__codelineno-12-15></a><span class=x>            &lt;label for=&#39;password&#39;&gt;</span>
<a id=__codelineno-12-16 name=__codelineno-12-16 href=#__codelineno-12-16></a><span class=x>                Password</span>
<a id=__codelineno-12-17 name=__codelineno-12-17 href=#__codelineno-12-17></a><span class=x>            &lt;/label&gt;</span>
<a id=__codelineno-12-18 name=__codelineno-12-18 href=#__codelineno-12-18></a>
<a id=__codelineno-12-19 name=__codelineno-12-19 href=#__codelineno-12-19></a><span class=x>            &lt;div&gt;</span>
<a id=__codelineno-12-20 name=__codelineno-12-20 href=#__codelineno-12-20></a><span class=x>                {{ password_field(&#39;password&#39;) }}</span>
<a id=__codelineno-12-21 name=__codelineno-12-21 href=#__codelineno-12-21></a><span class=x>            &lt;/div&gt;</span>
<a id=__codelineno-12-22 name=__codelineno-12-22 href=#__codelineno-12-22></a><span class=x>        &lt;/div&gt;</span>
<a id=__codelineno-12-23 name=__codelineno-12-23 href=#__codelineno-12-23></a>
<a id=__codelineno-12-24 name=__codelineno-12-24 href=#__codelineno-12-24></a><span class=x>        &lt;div&gt;</span>
<a id=__codelineno-12-25 name=__codelineno-12-25 href=#__codelineno-12-25></a><span class=x>            {{ submit_button(&#39;Login&#39;) }}</span>
<a id=__codelineno-12-26 name=__codelineno-12-26 href=#__codelineno-12-26></a><span class=x>        &lt;/div&gt;</span>
<a id=__codelineno-12-27 name=__codelineno-12-27 href=#__codelineno-12-27></a><span class=x>    &lt;/fieldset&gt;</span>
<a id=__codelineno-12-28 name=__codelineno-12-28 href=#__codelineno-12-28></a><span class=x>{{ endForm() }}</span>
<a id=__codelineno-12-29 name=__codelineno-12-29 href=#__codelineno-12-29></a><span class=cp>{%</span> <span class=k>endraw</span> <span class=cp>%}</span>
</code></pre></div> <p>Instead of using raw PHP as the previous tutorial, we started to use <a href=../volt/ >Volt</a>. This is a built-in template engine inspired by Jinja_ providing a simpler and friendly syntax to create templates. It will not take too long before you become familiar with Volt.</p> <p>The <code>SessionController::startAction</code> function (<code>app/controllers/SessionController.php</code>) has the task of validating the data entered in the form including checking for a valid user in the database:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a>
<a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a><span class=k>class</span> <span class=nc>SessionController</span> <span class=k>extends</span> <span class=nx>ControllerBase</span>
<a id=__codelineno-13-4 name=__codelineno-13-4 href=#__codelineno-13-4></a><span class=p>{</span>
<a id=__codelineno-13-5 name=__codelineno-13-5 href=#__codelineno-13-5></a>    <span class=c1>// ...</span>
<a id=__codelineno-13-6 name=__codelineno-13-6 href=#__codelineno-13-6></a>
<a id=__codelineno-13-7 name=__codelineno-13-7 href=#__codelineno-13-7></a>    <span class=k>private</span> <span class=k>function</span> <span class=nf>_registerSession</span><span class=p>(</span><span class=nv>$user</span><span class=p>)</span>
<a id=__codelineno-13-8 name=__codelineno-13-8 href=#__codelineno-13-8></a>    <span class=p>{</span>
<a id=__codelineno-13-9 name=__codelineno-13-9 href=#__codelineno-13-9></a>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>session</span><span class=o>-&gt;</span><span class=na>set</span><span class=p>(</span>
<a id=__codelineno-13-10 name=__codelineno-13-10 href=#__codelineno-13-10></a>            <span class=s1>&#39;auth&#39;</span><span class=p>,</span>
<a id=__codelineno-13-11 name=__codelineno-13-11 href=#__codelineno-13-11></a>            <span class=p>[</span>
<a id=__codelineno-13-12 name=__codelineno-13-12 href=#__codelineno-13-12></a>                <span class=s1>&#39;id&#39;</span>   <span class=o>=&gt;</span> <span class=nv>$user</span><span class=o>-&gt;</span><span class=na>id</span><span class=p>,</span>
<a id=__codelineno-13-13 name=__codelineno-13-13 href=#__codelineno-13-13></a>                <span class=s1>&#39;name&#39;</span> <span class=o>=&gt;</span> <span class=nv>$user</span><span class=o>-&gt;</span><span class=na>name</span><span class=p>,</span>
<a id=__codelineno-13-14 name=__codelineno-13-14 href=#__codelineno-13-14></a>            <span class=p>]</span>
<a id=__codelineno-13-15 name=__codelineno-13-15 href=#__codelineno-13-15></a>        <span class=p>);</span>
<a id=__codelineno-13-16 name=__codelineno-13-16 href=#__codelineno-13-16></a>    <span class=p>}</span>
<a id=__codelineno-13-17 name=__codelineno-13-17 href=#__codelineno-13-17></a>
<a id=__codelineno-13-18 name=__codelineno-13-18 href=#__codelineno-13-18></a>    <span class=sd>/**</span>
<a id=__codelineno-13-19 name=__codelineno-13-19 href=#__codelineno-13-19></a><span class=sd>     * This action authenticate and logs a user into the application</span>
<a id=__codelineno-13-20 name=__codelineno-13-20 href=#__codelineno-13-20></a><span class=sd>     */</span>
<a id=__codelineno-13-21 name=__codelineno-13-21 href=#__codelineno-13-21></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>startAction</span><span class=p>()</span>
<a id=__codelineno-13-22 name=__codelineno-13-22 href=#__codelineno-13-22></a>    <span class=p>{</span>
<a id=__codelineno-13-23 name=__codelineno-13-23 href=#__codelineno-13-23></a>        <span class=k>if</span> <span class=p>(</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>request</span><span class=o>-&gt;</span><span class=na>isPost</span><span class=p>())</span> <span class=p>{</span>
<a id=__codelineno-13-24 name=__codelineno-13-24 href=#__codelineno-13-24></a>            <span class=c1>// Get the data from the user</span>
<a id=__codelineno-13-25 name=__codelineno-13-25 href=#__codelineno-13-25></a>            <span class=nv>$email</span>    <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>request</span><span class=o>-&gt;</span><span class=na>getPost</span><span class=p>(</span><span class=s1>&#39;email&#39;</span><span class=p>);</span>
<a id=__codelineno-13-26 name=__codelineno-13-26 href=#__codelineno-13-26></a>            <span class=nv>$password</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>request</span><span class=o>-&gt;</span><span class=na>getPost</span><span class=p>(</span><span class=s1>&#39;password&#39;</span><span class=p>);</span>
<a id=__codelineno-13-27 name=__codelineno-13-27 href=#__codelineno-13-27></a>
<a id=__codelineno-13-28 name=__codelineno-13-28 href=#__codelineno-13-28></a>            <span class=c1>// Find the user in the database</span>
<a id=__codelineno-13-29 name=__codelineno-13-29 href=#__codelineno-13-29></a>            <span class=nv>$user</span> <span class=o>=</span> <span class=nx>Users</span><span class=o>::</span><span class=na>findFirst</span><span class=p>(</span>
<a id=__codelineno-13-30 name=__codelineno-13-30 href=#__codelineno-13-30></a>                <span class=p>[</span>
<a id=__codelineno-13-31 name=__codelineno-13-31 href=#__codelineno-13-31></a>                    <span class=s2>&quot;(email = :email: OR username = :email:) AND password = :password: AND active = &#39;Y&#39;&quot;</span><span class=p>,</span>
<a id=__codelineno-13-32 name=__codelineno-13-32 href=#__codelineno-13-32></a>                    <span class=s1>&#39;bind&#39;</span> <span class=o>=&gt;</span> <span class=p>[</span>
<a id=__codelineno-13-33 name=__codelineno-13-33 href=#__codelineno-13-33></a>                        <span class=s1>&#39;email&#39;</span>    <span class=o>=&gt;</span> <span class=nv>$email</span><span class=p>,</span>
<a id=__codelineno-13-34 name=__codelineno-13-34 href=#__codelineno-13-34></a>                        <span class=s1>&#39;password&#39;</span> <span class=o>=&gt;</span> <span class=nb>sha1</span><span class=p>(</span><span class=nv>$password</span><span class=p>),</span>
<a id=__codelineno-13-35 name=__codelineno-13-35 href=#__codelineno-13-35></a>                    <span class=p>]</span>
<a id=__codelineno-13-36 name=__codelineno-13-36 href=#__codelineno-13-36></a>                <span class=p>]</span>
<a id=__codelineno-13-37 name=__codelineno-13-37 href=#__codelineno-13-37></a>            <span class=p>);</span>
<a id=__codelineno-13-38 name=__codelineno-13-38 href=#__codelineno-13-38></a>
<a id=__codelineno-13-39 name=__codelineno-13-39 href=#__codelineno-13-39></a>            <span class=k>if</span> <span class=p>(</span><span class=nv>$user</span> <span class=o>!==</span> <span class=k>false</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-13-40 name=__codelineno-13-40 href=#__codelineno-13-40></a>                <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>_registerSession</span><span class=p>(</span><span class=nv>$user</span><span class=p>);</span>
<a id=__codelineno-13-41 name=__codelineno-13-41 href=#__codelineno-13-41></a>
<a id=__codelineno-13-42 name=__codelineno-13-42 href=#__codelineno-13-42></a>                <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>flash</span><span class=o>-&gt;</span><span class=na>success</span><span class=p>(</span>
<a id=__codelineno-13-43 name=__codelineno-13-43 href=#__codelineno-13-43></a>                    <span class=s1>&#39;Welcome &#39;</span> <span class=o>.</span> <span class=nv>$user</span><span class=o>-&gt;</span><span class=na>name</span>
<a id=__codelineno-13-44 name=__codelineno-13-44 href=#__codelineno-13-44></a>                <span class=p>);</span>
<a id=__codelineno-13-45 name=__codelineno-13-45 href=#__codelineno-13-45></a>
<a id=__codelineno-13-46 name=__codelineno-13-46 href=#__codelineno-13-46></a>                <span class=c1>// Forward to the &#39;invoices&#39; controller if the user is valid</span>
<a id=__codelineno-13-47 name=__codelineno-13-47 href=#__codelineno-13-47></a>                <span class=k>return</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>dispatcher</span><span class=o>-&gt;</span><span class=na>forward</span><span class=p>(</span>
<a id=__codelineno-13-48 name=__codelineno-13-48 href=#__codelineno-13-48></a>                    <span class=p>[</span>
<a id=__codelineno-13-49 name=__codelineno-13-49 href=#__codelineno-13-49></a>                        <span class=s1>&#39;controller&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;invoices&#39;</span><span class=p>,</span>
<a id=__codelineno-13-50 name=__codelineno-13-50 href=#__codelineno-13-50></a>                        <span class=s1>&#39;action&#39;</span>     <span class=o>=&gt;</span> <span class=s1>&#39;index&#39;</span><span class=p>,</span>
<a id=__codelineno-13-51 name=__codelineno-13-51 href=#__codelineno-13-51></a>                    <span class=p>]</span>
<a id=__codelineno-13-52 name=__codelineno-13-52 href=#__codelineno-13-52></a>                <span class=p>);</span>
<a id=__codelineno-13-53 name=__codelineno-13-53 href=#__codelineno-13-53></a>            <span class=p>}</span>
<a id=__codelineno-13-54 name=__codelineno-13-54 href=#__codelineno-13-54></a>
<a id=__codelineno-13-55 name=__codelineno-13-55 href=#__codelineno-13-55></a>            <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>flash</span><span class=o>-&gt;</span><span class=na>error</span><span class=p>(</span>
<a id=__codelineno-13-56 name=__codelineno-13-56 href=#__codelineno-13-56></a>                <span class=s1>&#39;Wrong email/password&#39;</span>
<a id=__codelineno-13-57 name=__codelineno-13-57 href=#__codelineno-13-57></a>            <span class=p>);</span>
<a id=__codelineno-13-58 name=__codelineno-13-58 href=#__codelineno-13-58></a>        <span class=p>}</span>
<a id=__codelineno-13-59 name=__codelineno-13-59 href=#__codelineno-13-59></a>
<a id=__codelineno-13-60 name=__codelineno-13-60 href=#__codelineno-13-60></a>        <span class=c1>// Forward to the login form again</span>
<a id=__codelineno-13-61 name=__codelineno-13-61 href=#__codelineno-13-61></a>        <span class=k>return</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>dispatcher</span><span class=o>-&gt;</span><span class=na>forward</span><span class=p>(</span>
<a id=__codelineno-13-62 name=__codelineno-13-62 href=#__codelineno-13-62></a>            <span class=p>[</span>
<a id=__codelineno-13-63 name=__codelineno-13-63 href=#__codelineno-13-63></a>                <span class=s1>&#39;controller&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;session&#39;</span><span class=p>,</span>
<a id=__codelineno-13-64 name=__codelineno-13-64 href=#__codelineno-13-64></a>                <span class=s1>&#39;action&#39;</span>     <span class=o>=&gt;</span> <span class=s1>&#39;index&#39;</span><span class=p>,</span>
<a id=__codelineno-13-65 name=__codelineno-13-65 href=#__codelineno-13-65></a>            <span class=p>]</span>
<a id=__codelineno-13-66 name=__codelineno-13-66 href=#__codelineno-13-66></a>        <span class=p>);</span>
<a id=__codelineno-13-67 name=__codelineno-13-67 href=#__codelineno-13-67></a>    <span class=p>}</span>
<a id=__codelineno-13-68 name=__codelineno-13-68 href=#__codelineno-13-68></a><span class=p>}</span>
</code></pre></div> <p>For the sake of simplicity, we have used <a href=https://php.net/manual/en/function.sha1.php>sha1</a> to store the password hashes in the database, however, this algorithm is not recommended in real applications, use <a href=../security/ >bcrypt</a> instead.</p> <p>Note that multiple public attributes are accessed in the controller like: <code>$this-&gt;flash</code>, <code>$this-&gt;request</code> or <code>$this-&gt;session</code>. These are services defined in the services container from earlier (<code>app/config/services.php</code>). When they're accessed the first time, they are injected as part of the controller. These services are <code>shared</code>, which means that we are always accessing the same instance regardless of the place where we invoke them. For instance, here we invoke the <code>session</code> service and then we store the user identity in the variable <code>auth</code>:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a>
<a id=__codelineno-14-3 name=__codelineno-14-3 href=#__codelineno-14-3></a><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>session</span><span class=o>-&gt;</span><span class=na>set</span><span class=p>(</span>
<a id=__codelineno-14-4 name=__codelineno-14-4 href=#__codelineno-14-4></a>    <span class=s1>&#39;auth&#39;</span><span class=p>,</span>
<a id=__codelineno-14-5 name=__codelineno-14-5 href=#__codelineno-14-5></a>    <span class=p>[</span>
<a id=__codelineno-14-6 name=__codelineno-14-6 href=#__codelineno-14-6></a>        <span class=s1>&#39;id&#39;</span>   <span class=o>=&gt;</span> <span class=nv>$user</span><span class=o>-&gt;</span><span class=na>id</span><span class=p>,</span>
<a id=__codelineno-14-7 name=__codelineno-14-7 href=#__codelineno-14-7></a>        <span class=s1>&#39;name&#39;</span> <span class=o>=&gt;</span> <span class=nv>$user</span><span class=o>-&gt;</span><span class=na>name</span><span class=p>,</span>
<a id=__codelineno-14-8 name=__codelineno-14-8 href=#__codelineno-14-8></a>    <span class=p>]</span>
<a id=__codelineno-14-9 name=__codelineno-14-9 href=#__codelineno-14-9></a><span class=p>);</span>
</code></pre></div> <p>Another important aspect of this section is how the user is validated as a valid one, first we validate whether the request has been made using method <code>POST</code>:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-15-2 name=__codelineno-15-2 href=#__codelineno-15-2></a>
<a id=__codelineno-15-3 name=__codelineno-15-3 href=#__codelineno-15-3></a><span class=k>if</span> <span class=p>(</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>request</span><span class=o>-&gt;</span><span class=na>isPost</span><span class=p>())</span> <span class=p>{</span>
<a id=__codelineno-15-4 name=__codelineno-15-4 href=#__codelineno-15-4></a>    <span class=c1>// ...</span>
<a id=__codelineno-15-5 name=__codelineno-15-5 href=#__codelineno-15-5></a><span class=p>}</span>
</code></pre></div> <p>Then, we receive the parameters from the form:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-16-2 name=__codelineno-16-2 href=#__codelineno-16-2></a>
<a id=__codelineno-16-3 name=__codelineno-16-3 href=#__codelineno-16-3></a><span class=nv>$email</span>    <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>request</span><span class=o>-&gt;</span><span class=na>getPost</span><span class=p>(</span><span class=s1>&#39;email&#39;</span><span class=p>);</span>
<a id=__codelineno-16-4 name=__codelineno-16-4 href=#__codelineno-16-4></a><span class=nv>$password</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>request</span><span class=o>-&gt;</span><span class=na>getPost</span><span class=p>(</span><span class=s1>&#39;password&#39;</span><span class=p>);</span>
</code></pre></div> <p>Now, we have to check if there is one user with the same username or email and password:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-17-2 name=__codelineno-17-2 href=#__codelineno-17-2></a>
<a id=__codelineno-17-3 name=__codelineno-17-3 href=#__codelineno-17-3></a><span class=nv>$user</span> <span class=o>=</span> <span class=nx>Users</span><span class=o>::</span><span class=na>findFirst</span><span class=p>(</span>
<a id=__codelineno-17-4 name=__codelineno-17-4 href=#__codelineno-17-4></a>    <span class=p>[</span>
<a id=__codelineno-17-5 name=__codelineno-17-5 href=#__codelineno-17-5></a>        <span class=s2>&quot;(email = :email: OR username = :email:) AND password = :password: AND active = &#39;Y&#39;&quot;</span><span class=p>,</span>
<a id=__codelineno-17-6 name=__codelineno-17-6 href=#__codelineno-17-6></a>        <span class=s1>&#39;bind&#39;</span> <span class=o>=&gt;</span> <span class=p>[</span>
<a id=__codelineno-17-7 name=__codelineno-17-7 href=#__codelineno-17-7></a>            <span class=s1>&#39;email&#39;</span>    <span class=o>=&gt;</span> <span class=nv>$email</span><span class=p>,</span>
<a id=__codelineno-17-8 name=__codelineno-17-8 href=#__codelineno-17-8></a>            <span class=s1>&#39;password&#39;</span> <span class=o>=&gt;</span> <span class=nb>sha1</span><span class=p>(</span><span class=nv>$password</span><span class=p>),</span>
<a id=__codelineno-17-9 name=__codelineno-17-9 href=#__codelineno-17-9></a>        <span class=p>]</span>
<a id=__codelineno-17-10 name=__codelineno-17-10 href=#__codelineno-17-10></a>    <span class=p>]</span>
<a id=__codelineno-17-11 name=__codelineno-17-11 href=#__codelineno-17-11></a><span class=p>);</span>
</code></pre></div> <p>Note, the use of 'bound parameters', placeholders <code>:email:</code> and <code>:password:</code> are placed where values should be, then the values are 'bound' using the parameter <code>bind</code>. This safely replaces the values for those columns without having the risk of a SQL injection.</p> <p>If the user is valid we register it in session and forwards him/her to the dashboard:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-18-2 name=__codelineno-18-2 href=#__codelineno-18-2></a>
<a id=__codelineno-18-3 name=__codelineno-18-3 href=#__codelineno-18-3></a><span class=k>if</span> <span class=p>(</span><span class=nv>$user</span> <span class=o>!==</span> <span class=k>false</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-18-4 name=__codelineno-18-4 href=#__codelineno-18-4></a>    <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>_registerSession</span><span class=p>(</span><span class=nv>$user</span><span class=p>);</span>
<a id=__codelineno-18-5 name=__codelineno-18-5 href=#__codelineno-18-5></a>
<a id=__codelineno-18-6 name=__codelineno-18-6 href=#__codelineno-18-6></a>    <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>flash</span><span class=o>-&gt;</span><span class=na>success</span><span class=p>(</span>
<a id=__codelineno-18-7 name=__codelineno-18-7 href=#__codelineno-18-7></a>        <span class=s1>&#39;Welcome &#39;</span> <span class=o>.</span> <span class=nv>$user</span><span class=o>-&gt;</span><span class=na>name</span>
<a id=__codelineno-18-8 name=__codelineno-18-8 href=#__codelineno-18-8></a>    <span class=p>);</span>
<a id=__codelineno-18-9 name=__codelineno-18-9 href=#__codelineno-18-9></a>
<a id=__codelineno-18-10 name=__codelineno-18-10 href=#__codelineno-18-10></a>    <span class=k>return</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>dispatcher</span><span class=o>-&gt;</span><span class=na>forward</span><span class=p>(</span>
<a id=__codelineno-18-11 name=__codelineno-18-11 href=#__codelineno-18-11></a>        <span class=p>[</span>
<a id=__codelineno-18-12 name=__codelineno-18-12 href=#__codelineno-18-12></a>            <span class=s1>&#39;controller&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;invoices&#39;</span><span class=p>,</span>
<a id=__codelineno-18-13 name=__codelineno-18-13 href=#__codelineno-18-13></a>            <span class=s1>&#39;action&#39;</span>     <span class=o>=&gt;</span> <span class=s1>&#39;index&#39;</span><span class=p>,</span>
<a id=__codelineno-18-14 name=__codelineno-18-14 href=#__codelineno-18-14></a>        <span class=p>]</span>
<a id=__codelineno-18-15 name=__codelineno-18-15 href=#__codelineno-18-15></a>    <span class=p>);</span>
<a id=__codelineno-18-16 name=__codelineno-18-16 href=#__codelineno-18-16></a><span class=p>}</span>
</code></pre></div> <p>If the user does not exist we forward the user back again to action where the form is displayed:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-19-2 name=__codelineno-19-2 href=#__codelineno-19-2></a>
<a id=__codelineno-19-3 name=__codelineno-19-3 href=#__codelineno-19-3></a><span class=k>return</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>dispatcher</span><span class=o>-&gt;</span><span class=na>forward</span><span class=p>(</span>
<a id=__codelineno-19-4 name=__codelineno-19-4 href=#__codelineno-19-4></a>    <span class=p>[</span>
<a id=__codelineno-19-5 name=__codelineno-19-5 href=#__codelineno-19-5></a>        <span class=s1>&#39;controller&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;session&#39;</span><span class=p>,</span>
<a id=__codelineno-19-6 name=__codelineno-19-6 href=#__codelineno-19-6></a>        <span class=s1>&#39;action&#39;</span>     <span class=o>=&gt;</span> <span class=s1>&#39;index&#39;</span><span class=p>,</span>
<a id=__codelineno-19-7 name=__codelineno-19-7 href=#__codelineno-19-7></a>    <span class=p>]</span>
<a id=__codelineno-19-8 name=__codelineno-19-8 href=#__codelineno-19-8></a><span class=p>);</span>
</code></pre></div> <h2 id=securing-the-backend>Securing the Backend<a class=headerlink href=#securing-the-backend title="Permanent link">&para;</a></h2> <p>The backend is a private area where only registered users have access. Therefore, it is necessary to check that only registered users have access to these controllers. If you aren't logged into the application and you try to access, for example, the products controller (which is private) you will see a screen like this:</p> <p><img alt src=../assets/images/content/tutorial-invo-2.png></p> <p>Every time someone attempts to access any controller/action, the application verifies that the current role (in session) has access to it, otherwise it displays a message like the above and forwards the flow to the home page.</p> <p>Now let's find out how the application accomplishes this. The first thing to know is that there is a component called <a href=../dispatcher/ >Dispatcher</a>. It is informed about the route found by the <a href=../routing/ >Routing</a> component. Then, it is responsible for loading the appropriate controller and execute the corresponding action method.</p> <p>Normally, the framework creates the Dispatcher automatically. In our case, we want to perform a verification before executing the required action, checking if the user has access to it or not. To achieve this, we have replaced the component by creating a function in the bootstrap:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-20-1 name=__codelineno-20-1 href=#__codelineno-20-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-20-2 name=__codelineno-20-2 href=#__codelineno-20-2></a>
<a id=__codelineno-20-3 name=__codelineno-20-3 href=#__codelineno-20-3></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Dispatcher</span><span class=p>;</span>
<a id=__codelineno-20-4 name=__codelineno-20-4 href=#__codelineno-20-4></a>
<a id=__codelineno-20-5 name=__codelineno-20-5 href=#__codelineno-20-5></a><span class=c1>// ...</span>
<a id=__codelineno-20-6 name=__codelineno-20-6 href=#__codelineno-20-6></a>
<a id=__codelineno-20-7 name=__codelineno-20-7 href=#__codelineno-20-7></a><span class=sd>/**</span>
<a id=__codelineno-20-8 name=__codelineno-20-8 href=#__codelineno-20-8></a><span class=sd> * MVC dispatcher</span>
<a id=__codelineno-20-9 name=__codelineno-20-9 href=#__codelineno-20-9></a><span class=sd> */</span>
<a id=__codelineno-20-10 name=__codelineno-20-10 href=#__codelineno-20-10></a><span class=nv>$di</span><span class=o>-&gt;</span><span class=na>set</span><span class=p>(</span>
<a id=__codelineno-20-11 name=__codelineno-20-11 href=#__codelineno-20-11></a>    <span class=s1>&#39;dispatcher&#39;</span><span class=p>,</span>
<a id=__codelineno-20-12 name=__codelineno-20-12 href=#__codelineno-20-12></a>    <span class=k>function</span> <span class=p>()</span> <span class=p>{</span>
<a id=__codelineno-20-13 name=__codelineno-20-13 href=#__codelineno-20-13></a>        <span class=c1>// ...</span>
<a id=__codelineno-20-14 name=__codelineno-20-14 href=#__codelineno-20-14></a>
<a id=__codelineno-20-15 name=__codelineno-20-15 href=#__codelineno-20-15></a>        <span class=nv>$dispatcher</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Dispatcher</span><span class=p>();</span>
<a id=__codelineno-20-16 name=__codelineno-20-16 href=#__codelineno-20-16></a>
<a id=__codelineno-20-17 name=__codelineno-20-17 href=#__codelineno-20-17></a>        <span class=k>return</span> <span class=nv>$dispatcher</span><span class=p>;</span>
<a id=__codelineno-20-18 name=__codelineno-20-18 href=#__codelineno-20-18></a>    <span class=p>}</span>
<a id=__codelineno-20-19 name=__codelineno-20-19 href=#__codelineno-20-19></a><span class=p>);</span>
</code></pre></div> <p>We now have total control over the Dispatcher used in the application. Many components in the framework trigger events that allow us to modify their internal flow of operation. As the Dependency Injector component acts as glue for components, a new component called <a href=../events/ >EventsManager</a> allows us to intercept the events produced by a component, routing the events to listeners.</p> <h3 id=events-management>Events Management<a class=headerlink href=#events-management title="Permanent link">&para;</a></h3> <p>The <a href=../events/ >EventsManager</a> allows us to attach listeners to a particular type of event. The type that interests us now is 'dispatch'. The following code filters all events produced by the Dispatcher:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-21-1 name=__codelineno-21-1 href=#__codelineno-21-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-21-2 name=__codelineno-21-2 href=#__codelineno-21-2></a>
<a id=__codelineno-21-3 name=__codelineno-21-3 href=#__codelineno-21-3></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Dispatcher</span><span class=p>;</span>
<a id=__codelineno-21-4 name=__codelineno-21-4 href=#__codelineno-21-4></a><span class=k>use</span> <span class=nx>Phalcon\Events\Manager</span> <span class=k>as</span> <span class=nx>EventsManager</span><span class=p>;</span>
<a id=__codelineno-21-5 name=__codelineno-21-5 href=#__codelineno-21-5></a>
<a id=__codelineno-21-6 name=__codelineno-21-6 href=#__codelineno-21-6></a><span class=nv>$di</span><span class=o>-&gt;</span><span class=na>set</span><span class=p>(</span>
<a id=__codelineno-21-7 name=__codelineno-21-7 href=#__codelineno-21-7></a>    <span class=s1>&#39;dispatcher&#39;</span><span class=p>,</span>
<a id=__codelineno-21-8 name=__codelineno-21-8 href=#__codelineno-21-8></a>    <span class=k>function</span> <span class=p>()</span> <span class=p>{</span>
<a id=__codelineno-21-9 name=__codelineno-21-9 href=#__codelineno-21-9></a>        <span class=c1>// Create an events manager</span>
<a id=__codelineno-21-10 name=__codelineno-21-10 href=#__codelineno-21-10></a>        <span class=nv>$eventsManager</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>EventsManager</span><span class=p>();</span>
<a id=__codelineno-21-11 name=__codelineno-21-11 href=#__codelineno-21-11></a>
<a id=__codelineno-21-12 name=__codelineno-21-12 href=#__codelineno-21-12></a>        <span class=c1>// Listen for events produced in the dispatcher using the Security plugin</span>
<a id=__codelineno-21-13 name=__codelineno-21-13 href=#__codelineno-21-13></a>        <span class=nv>$eventsManager</span><span class=o>-&gt;</span><span class=na>attach</span><span class=p>(</span>
<a id=__codelineno-21-14 name=__codelineno-21-14 href=#__codelineno-21-14></a>            <span class=s1>&#39;dispatch:beforeExecuteRoute&#39;</span><span class=p>,</span>
<a id=__codelineno-21-15 name=__codelineno-21-15 href=#__codelineno-21-15></a>            <span class=k>new</span> <span class=nx>SecurityPlugin</span><span class=p>()</span>
<a id=__codelineno-21-16 name=__codelineno-21-16 href=#__codelineno-21-16></a>        <span class=p>);</span>
<a id=__codelineno-21-17 name=__codelineno-21-17 href=#__codelineno-21-17></a>
<a id=__codelineno-21-18 name=__codelineno-21-18 href=#__codelineno-21-18></a>        <span class=c1>// Handle exceptions and not-found exceptions using NotFoundPlugin</span>
<a id=__codelineno-21-19 name=__codelineno-21-19 href=#__codelineno-21-19></a>        <span class=nv>$eventsManager</span><span class=o>-&gt;</span><span class=na>attach</span><span class=p>(</span>
<a id=__codelineno-21-20 name=__codelineno-21-20 href=#__codelineno-21-20></a>            <span class=s1>&#39;dispatch:beforeException&#39;</span><span class=p>,</span>
<a id=__codelineno-21-21 name=__codelineno-21-21 href=#__codelineno-21-21></a>            <span class=k>new</span> <span class=nx>NotFoundPlugin</span><span class=p>()</span>
<a id=__codelineno-21-22 name=__codelineno-21-22 href=#__codelineno-21-22></a>        <span class=p>);</span>
<a id=__codelineno-21-23 name=__codelineno-21-23 href=#__codelineno-21-23></a>
<a id=__codelineno-21-24 name=__codelineno-21-24 href=#__codelineno-21-24></a>        <span class=nv>$dispatcher</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Dispatcher</span><span class=p>();</span>
<a id=__codelineno-21-25 name=__codelineno-21-25 href=#__codelineno-21-25></a>
<a id=__codelineno-21-26 name=__codelineno-21-26 href=#__codelineno-21-26></a>        <span class=c1>// Assign the events manager to the dispatcher</span>
<a id=__codelineno-21-27 name=__codelineno-21-27 href=#__codelineno-21-27></a>        <span class=nv>$dispatcher</span><span class=o>-&gt;</span><span class=na>setEventsManager</span><span class=p>(</span><span class=nv>$eventsManager</span><span class=p>);</span>
<a id=__codelineno-21-28 name=__codelineno-21-28 href=#__codelineno-21-28></a>
<a id=__codelineno-21-29 name=__codelineno-21-29 href=#__codelineno-21-29></a>        <span class=k>return</span> <span class=nv>$dispatcher</span><span class=p>;</span>
<a id=__codelineno-21-30 name=__codelineno-21-30 href=#__codelineno-21-30></a>    <span class=p>}</span>
<a id=__codelineno-21-31 name=__codelineno-21-31 href=#__codelineno-21-31></a><span class=p>);</span>
</code></pre></div> <p>When an event called <code>beforeExecuteRoute</code> is triggered the following plugin will be notified:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-22-1 name=__codelineno-22-1 href=#__codelineno-22-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-22-2 name=__codelineno-22-2 href=#__codelineno-22-2></a>
<a id=__codelineno-22-3 name=__codelineno-22-3 href=#__codelineno-22-3></a><span class=sd>/**</span>
<a id=__codelineno-22-4 name=__codelineno-22-4 href=#__codelineno-22-4></a><span class=sd> * Check if the user is allowed to access certain action using the SecurityPlugin</span>
<a id=__codelineno-22-5 name=__codelineno-22-5 href=#__codelineno-22-5></a><span class=sd> */</span>
<a id=__codelineno-22-6 name=__codelineno-22-6 href=#__codelineno-22-6></a><span class=nv>$eventsManager</span><span class=o>-&gt;</span><span class=na>attach</span><span class=p>(</span>
<a id=__codelineno-22-7 name=__codelineno-22-7 href=#__codelineno-22-7></a>    <span class=s1>&#39;dispatch:beforeExecuteRoute&#39;</span><span class=p>,</span>
<a id=__codelineno-22-8 name=__codelineno-22-8 href=#__codelineno-22-8></a>    <span class=k>new</span> <span class=nx>SecurityPlugin</span><span class=p>()</span>
<a id=__codelineno-22-9 name=__codelineno-22-9 href=#__codelineno-22-9></a><span class=p>);</span>
</code></pre></div> <p>When a <code>beforeException</code> is triggered then other plugin is notified:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-23-1 name=__codelineno-23-1 href=#__codelineno-23-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-23-2 name=__codelineno-23-2 href=#__codelineno-23-2></a>
<a id=__codelineno-23-3 name=__codelineno-23-3 href=#__codelineno-23-3></a><span class=sd>/**</span>
<a id=__codelineno-23-4 name=__codelineno-23-4 href=#__codelineno-23-4></a><span class=sd> * Handle exceptions and not-found exceptions using NotFoundPlugin</span>
<a id=__codelineno-23-5 name=__codelineno-23-5 href=#__codelineno-23-5></a><span class=sd> */</span>
<a id=__codelineno-23-6 name=__codelineno-23-6 href=#__codelineno-23-6></a><span class=nv>$eventsManager</span><span class=o>-&gt;</span><span class=na>attach</span><span class=p>(</span>
<a id=__codelineno-23-7 name=__codelineno-23-7 href=#__codelineno-23-7></a>    <span class=s1>&#39;dispatch:beforeException&#39;</span><span class=p>,</span>
<a id=__codelineno-23-8 name=__codelineno-23-8 href=#__codelineno-23-8></a>    <span class=k>new</span> <span class=nx>NotFoundPlugin</span><span class=p>()</span>
<a id=__codelineno-23-9 name=__codelineno-23-9 href=#__codelineno-23-9></a><span class=p>);</span>
</code></pre></div> <p>SecurityPlugin is a class located at (<code>app/plugins/SecurityPlugin.php</code>). This class implements the method <code>beforeExecuteRoute</code>. This is the same name as one of the events produced in the Dispatcher:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-24-1 name=__codelineno-24-1 href=#__codelineno-24-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-24-2 name=__codelineno-24-2 href=#__codelineno-24-2></a>
<a id=__codelineno-24-3 name=__codelineno-24-3 href=#__codelineno-24-3></a><span class=k>use</span> <span class=nx>Phalcon\Events\Event</span><span class=p>;</span>
<a id=__codelineno-24-4 name=__codelineno-24-4 href=#__codelineno-24-4></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\User\Plugin</span><span class=p>;</span>
<a id=__codelineno-24-5 name=__codelineno-24-5 href=#__codelineno-24-5></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Dispatcher</span><span class=p>;</span>
<a id=__codelineno-24-6 name=__codelineno-24-6 href=#__codelineno-24-6></a>
<a id=__codelineno-24-7 name=__codelineno-24-7 href=#__codelineno-24-7></a><span class=k>class</span> <span class=nc>SecurityPlugin</span> <span class=k>extends</span> <span class=nx>Plugin</span>
<a id=__codelineno-24-8 name=__codelineno-24-8 href=#__codelineno-24-8></a><span class=p>{</span>
<a id=__codelineno-24-9 name=__codelineno-24-9 href=#__codelineno-24-9></a>    <span class=c1>// ...</span>
<a id=__codelineno-24-10 name=__codelineno-24-10 href=#__codelineno-24-10></a>
<a id=__codelineno-24-11 name=__codelineno-24-11 href=#__codelineno-24-11></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>beforeExecuteRoute</span><span class=p>(</span><span class=nx>Event</span> <span class=nv>$event</span><span class=p>,</span> <span class=nx>Dispatcher</span> <span class=nv>$dispatcher</span><span class=p>)</span>
<a id=__codelineno-24-12 name=__codelineno-24-12 href=#__codelineno-24-12></a>    <span class=p>{</span>
<a id=__codelineno-24-13 name=__codelineno-24-13 href=#__codelineno-24-13></a>        <span class=c1>// ...</span>
<a id=__codelineno-24-14 name=__codelineno-24-14 href=#__codelineno-24-14></a>    <span class=p>}</span>
<a id=__codelineno-24-15 name=__codelineno-24-15 href=#__codelineno-24-15></a><span class=p>}</span>
</code></pre></div> <p>The hook events always receive a first parameter that contains contextual information of the event produced (<code>$event</code>) and a second one that is the object that produced the event itself (<code>$dispatcher</code>). It is not mandatory that plugins extend the class <a href=../api/Phalcon_Mvc_User/ >Phalcon\Mvc\User\Plugin</a>, but by doing this they gain easier access to the services available in the application.</p> <p>Now, we're verifying the role in the current session, checking if the user has access using the ACL list. If the user does not have access we redirect to the home screen as explained before:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-25-1 name=__codelineno-25-1 href=#__codelineno-25-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-25-2 name=__codelineno-25-2 href=#__codelineno-25-2></a>
<a id=__codelineno-25-3 name=__codelineno-25-3 href=#__codelineno-25-3></a><span class=k>use</span> <span class=nx>Phalcon\Acl</span><span class=p>;</span>
<a id=__codelineno-25-4 name=__codelineno-25-4 href=#__codelineno-25-4></a><span class=k>use</span> <span class=nx>Phalcon\Events\Event</span><span class=p>;</span>
<a id=__codelineno-25-5 name=__codelineno-25-5 href=#__codelineno-25-5></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\User\Plugin</span><span class=p>;</span>
<a id=__codelineno-25-6 name=__codelineno-25-6 href=#__codelineno-25-6></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Dispatcher</span><span class=p>;</span>
<a id=__codelineno-25-7 name=__codelineno-25-7 href=#__codelineno-25-7></a>
<a id=__codelineno-25-8 name=__codelineno-25-8 href=#__codelineno-25-8></a><span class=k>class</span> <span class=nc>SecurityPlugin</span> <span class=k>extends</span> <span class=nx>Plugin</span>
<a id=__codelineno-25-9 name=__codelineno-25-9 href=#__codelineno-25-9></a><span class=p>{</span>
<a id=__codelineno-25-10 name=__codelineno-25-10 href=#__codelineno-25-10></a>    <span class=c1>// ...</span>
<a id=__codelineno-25-11 name=__codelineno-25-11 href=#__codelineno-25-11></a>
<a id=__codelineno-25-12 name=__codelineno-25-12 href=#__codelineno-25-12></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>beforeExecuteRoute</span><span class=p>(</span><span class=nx>Event</span> <span class=nv>$event</span><span class=p>,</span> <span class=nx>Dispatcher</span> <span class=nv>$dispatcher</span><span class=p>)</span>
<a id=__codelineno-25-13 name=__codelineno-25-13 href=#__codelineno-25-13></a>    <span class=p>{</span>
<a id=__codelineno-25-14 name=__codelineno-25-14 href=#__codelineno-25-14></a>        <span class=c1>// Check whether the &#39;auth&#39; variable exists in session to define the active role</span>
<a id=__codelineno-25-15 name=__codelineno-25-15 href=#__codelineno-25-15></a>        <span class=nv>$auth</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>session</span><span class=o>-&gt;</span><span class=na>get</span><span class=p>(</span><span class=s1>&#39;auth&#39;</span><span class=p>);</span>
<a id=__codelineno-25-16 name=__codelineno-25-16 href=#__codelineno-25-16></a>
<a id=__codelineno-25-17 name=__codelineno-25-17 href=#__codelineno-25-17></a>        <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nv>$auth</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-25-18 name=__codelineno-25-18 href=#__codelineno-25-18></a>            <span class=nv>$role</span> <span class=o>=</span> <span class=s1>&#39;Guests&#39;</span><span class=p>;</span>
<a id=__codelineno-25-19 name=__codelineno-25-19 href=#__codelineno-25-19></a>        <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
<a id=__codelineno-25-20 name=__codelineno-25-20 href=#__codelineno-25-20></a>            <span class=nv>$role</span> <span class=o>=</span> <span class=s1>&#39;Users&#39;</span><span class=p>;</span>
<a id=__codelineno-25-21 name=__codelineno-25-21 href=#__codelineno-25-21></a>        <span class=p>}</span>
<a id=__codelineno-25-22 name=__codelineno-25-22 href=#__codelineno-25-22></a>
<a id=__codelineno-25-23 name=__codelineno-25-23 href=#__codelineno-25-23></a>        <span class=c1>// Take the active controller/action from the dispatcher</span>
<a id=__codelineno-25-24 name=__codelineno-25-24 href=#__codelineno-25-24></a>        <span class=nv>$controller</span> <span class=o>=</span> <span class=nv>$dispatcher</span><span class=o>-&gt;</span><span class=na>getControllerName</span><span class=p>();</span>
<a id=__codelineno-25-25 name=__codelineno-25-25 href=#__codelineno-25-25></a>        <span class=nv>$action</span>     <span class=o>=</span> <span class=nv>$dispatcher</span><span class=o>-&gt;</span><span class=na>getActionName</span><span class=p>();</span>
<a id=__codelineno-25-26 name=__codelineno-25-26 href=#__codelineno-25-26></a>
<a id=__codelineno-25-27 name=__codelineno-25-27 href=#__codelineno-25-27></a>        <span class=c1>// Obtain the ACL list</span>
<a id=__codelineno-25-28 name=__codelineno-25-28 href=#__codelineno-25-28></a>        <span class=nv>$acl</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>getAcl</span><span class=p>();</span>
<a id=__codelineno-25-29 name=__codelineno-25-29 href=#__codelineno-25-29></a>
<a id=__codelineno-25-30 name=__codelineno-25-30 href=#__codelineno-25-30></a>        <span class=c1>// Check if the Role have access to the controller (resource)</span>
<a id=__codelineno-25-31 name=__codelineno-25-31 href=#__codelineno-25-31></a>        <span class=nv>$allowed</span> <span class=o>=</span> <span class=nv>$acl</span><span class=o>-&gt;</span><span class=na>isAllowed</span><span class=p>(</span><span class=nv>$role</span><span class=p>,</span> <span class=nv>$controller</span><span class=p>,</span> <span class=nv>$action</span><span class=p>);</span>
<a id=__codelineno-25-32 name=__codelineno-25-32 href=#__codelineno-25-32></a>
<a id=__codelineno-25-33 name=__codelineno-25-33 href=#__codelineno-25-33></a>        <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nv>$allowed</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-25-34 name=__codelineno-25-34 href=#__codelineno-25-34></a>            <span class=c1>// If he doesn&#39;t have access forward him to the index controller</span>
<a id=__codelineno-25-35 name=__codelineno-25-35 href=#__codelineno-25-35></a>            <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>flash</span><span class=o>-&gt;</span><span class=na>error</span><span class=p>(</span>
<a id=__codelineno-25-36 name=__codelineno-25-36 href=#__codelineno-25-36></a>                <span class=s2>&quot;You don&#39;t have access to this module&quot;</span>
<a id=__codelineno-25-37 name=__codelineno-25-37 href=#__codelineno-25-37></a>            <span class=p>);</span>
<a id=__codelineno-25-38 name=__codelineno-25-38 href=#__codelineno-25-38></a>
<a id=__codelineno-25-39 name=__codelineno-25-39 href=#__codelineno-25-39></a>            <span class=nv>$dispatcher</span><span class=o>-&gt;</span><span class=na>forward</span><span class=p>(</span>
<a id=__codelineno-25-40 name=__codelineno-25-40 href=#__codelineno-25-40></a>                <span class=p>[</span>
<a id=__codelineno-25-41 name=__codelineno-25-41 href=#__codelineno-25-41></a>                    <span class=s1>&#39;controller&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;index&#39;</span><span class=p>,</span>
<a id=__codelineno-25-42 name=__codelineno-25-42 href=#__codelineno-25-42></a>                    <span class=s1>&#39;action&#39;</span>     <span class=o>=&gt;</span> <span class=s1>&#39;index&#39;</span><span class=p>,</span>
<a id=__codelineno-25-43 name=__codelineno-25-43 href=#__codelineno-25-43></a>                <span class=p>]</span>
<a id=__codelineno-25-44 name=__codelineno-25-44 href=#__codelineno-25-44></a>            <span class=p>);</span>
<a id=__codelineno-25-45 name=__codelineno-25-45 href=#__codelineno-25-45></a>
<a id=__codelineno-25-46 name=__codelineno-25-46 href=#__codelineno-25-46></a>            <span class=c1>// Returning &#39;false&#39; we tell to the dispatcher to stop the current operation</span>
<a id=__codelineno-25-47 name=__codelineno-25-47 href=#__codelineno-25-47></a>            <span class=k>return</span> <span class=k>false</span><span class=p>;</span>
<a id=__codelineno-25-48 name=__codelineno-25-48 href=#__codelineno-25-48></a>        <span class=p>}</span>
<a id=__codelineno-25-49 name=__codelineno-25-49 href=#__codelineno-25-49></a>    <span class=p>}</span>
<a id=__codelineno-25-50 name=__codelineno-25-50 href=#__codelineno-25-50></a><span class=p>}</span>
</code></pre></div> <h3 id=getting-the-acl-list>Getting the ACL list<a class=headerlink href=#getting-the-acl-list title="Permanent link">&para;</a></h3> <p>In the above example we have obtained the ACL using the method <code>$this-&gt;getAcl()</code>. This method is also implemented in the Plugin. Now we are going to explain step-by-step how we built the access control list (ACL):</p> <div class=highlight><pre><span></span><code><a id=__codelineno-26-1 name=__codelineno-26-1 href=#__codelineno-26-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-26-2 name=__codelineno-26-2 href=#__codelineno-26-2></a>
<a id=__codelineno-26-3 name=__codelineno-26-3 href=#__codelineno-26-3></a><span class=k>use</span> <span class=nx>Phalcon\Acl</span><span class=p>;</span>
<a id=__codelineno-26-4 name=__codelineno-26-4 href=#__codelineno-26-4></a><span class=k>use</span> <span class=nx>Phalcon\Acl\Role</span><span class=p>;</span>
<a id=__codelineno-26-5 name=__codelineno-26-5 href=#__codelineno-26-5></a><span class=k>use</span> <span class=nx>Phalcon\Acl\Adapter\Memory</span> <span class=k>as</span> <span class=nx>AclList</span><span class=p>;</span>
<a id=__codelineno-26-6 name=__codelineno-26-6 href=#__codelineno-26-6></a>
<a id=__codelineno-26-7 name=__codelineno-26-7 href=#__codelineno-26-7></a><span class=c1>// Create the ACL</span>
<a id=__codelineno-26-8 name=__codelineno-26-8 href=#__codelineno-26-8></a><span class=nv>$acl</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>AclList</span><span class=p>();</span>
<a id=__codelineno-26-9 name=__codelineno-26-9 href=#__codelineno-26-9></a>
<a id=__codelineno-26-10 name=__codelineno-26-10 href=#__codelineno-26-10></a><span class=c1>// The default action is DENY access</span>
<a id=__codelineno-26-11 name=__codelineno-26-11 href=#__codelineno-26-11></a><span class=nv>$acl</span><span class=o>-&gt;</span><span class=na>setDefaultAction</span><span class=p>(</span>
<a id=__codelineno-26-12 name=__codelineno-26-12 href=#__codelineno-26-12></a>    <span class=nx>Acl</span><span class=o>::</span><span class=na>DENY</span>
<a id=__codelineno-26-13 name=__codelineno-26-13 href=#__codelineno-26-13></a><span class=p>);</span>
<a id=__codelineno-26-14 name=__codelineno-26-14 href=#__codelineno-26-14></a>
<a id=__codelineno-26-15 name=__codelineno-26-15 href=#__codelineno-26-15></a><span class=c1>// Register two roles, Users is registered users</span>
<a id=__codelineno-26-16 name=__codelineno-26-16 href=#__codelineno-26-16></a><span class=c1>// and guests are users without a defined identity</span>
<a id=__codelineno-26-17 name=__codelineno-26-17 href=#__codelineno-26-17></a><span class=nv>$roles</span> <span class=o>=</span> <span class=p>[</span>
<a id=__codelineno-26-18 name=__codelineno-26-18 href=#__codelineno-26-18></a>    <span class=s1>&#39;users&#39;</span>  <span class=o>=&gt;</span> <span class=k>new</span> <span class=nx>Role</span><span class=p>(</span><span class=s1>&#39;Users&#39;</span><span class=p>),</span>
<a id=__codelineno-26-19 name=__codelineno-26-19 href=#__codelineno-26-19></a>    <span class=s1>&#39;guests&#39;</span> <span class=o>=&gt;</span> <span class=k>new</span> <span class=nx>Role</span><span class=p>(</span><span class=s1>&#39;Guests&#39;</span><span class=p>),</span>
<a id=__codelineno-26-20 name=__codelineno-26-20 href=#__codelineno-26-20></a><span class=p>];</span>
<a id=__codelineno-26-21 name=__codelineno-26-21 href=#__codelineno-26-21></a>
<a id=__codelineno-26-22 name=__codelineno-26-22 href=#__codelineno-26-22></a><span class=k>foreach</span> <span class=p>(</span><span class=nv>$roles</span> <span class=k>as</span> <span class=nv>$role</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-26-23 name=__codelineno-26-23 href=#__codelineno-26-23></a>    <span class=nv>$acl</span><span class=o>-&gt;</span><span class=na>addRole</span><span class=p>(</span><span class=nv>$role</span><span class=p>);</span>
<a id=__codelineno-26-24 name=__codelineno-26-24 href=#__codelineno-26-24></a><span class=p>}</span>
</code></pre></div> <p>Now, we define the resources for each area respectively. Controller names are resources and their actions are accesses for the resources:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-27-1 name=__codelineno-27-1 href=#__codelineno-27-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-27-2 name=__codelineno-27-2 href=#__codelineno-27-2></a>
<a id=__codelineno-27-3 name=__codelineno-27-3 href=#__codelineno-27-3></a><span class=k>use</span> <span class=nx>Phalcon\Acl\Resource</span><span class=p>;</span>
<a id=__codelineno-27-4 name=__codelineno-27-4 href=#__codelineno-27-4></a>
<a id=__codelineno-27-5 name=__codelineno-27-5 href=#__codelineno-27-5></a><span class=c1>// ...</span>
<a id=__codelineno-27-6 name=__codelineno-27-6 href=#__codelineno-27-6></a>
<a id=__codelineno-27-7 name=__codelineno-27-7 href=#__codelineno-27-7></a><span class=c1>// Private area resources (backend)</span>
<a id=__codelineno-27-8 name=__codelineno-27-8 href=#__codelineno-27-8></a><span class=nv>$privateResources</span> <span class=o>=</span> <span class=p>[</span>
<a id=__codelineno-27-9 name=__codelineno-27-9 href=#__codelineno-27-9></a>    <span class=s1>&#39;companies&#39;</span>    <span class=o>=&gt;</span> <span class=p>[</span><span class=s1>&#39;index&#39;</span><span class=p>,</span> <span class=s1>&#39;search&#39;</span><span class=p>,</span> <span class=s1>&#39;new&#39;</span><span class=p>,</span> <span class=s1>&#39;edit&#39;</span><span class=p>,</span> <span class=s1>&#39;save&#39;</span><span class=p>,</span> <span class=s1>&#39;create&#39;</span><span class=p>,</span> <span class=s1>&#39;delete&#39;</span><span class=p>],</span>
<a id=__codelineno-27-10 name=__codelineno-27-10 href=#__codelineno-27-10></a>    <span class=s1>&#39;products&#39;</span>     <span class=o>=&gt;</span> <span class=p>[</span><span class=s1>&#39;index&#39;</span><span class=p>,</span> <span class=s1>&#39;search&#39;</span><span class=p>,</span> <span class=s1>&#39;new&#39;</span><span class=p>,</span> <span class=s1>&#39;edit&#39;</span><span class=p>,</span> <span class=s1>&#39;save&#39;</span><span class=p>,</span> <span class=s1>&#39;create&#39;</span><span class=p>,</span> <span class=s1>&#39;delete&#39;</span><span class=p>],</span>
<a id=__codelineno-27-11 name=__codelineno-27-11 href=#__codelineno-27-11></a>    <span class=s1>&#39;producttypes&#39;</span> <span class=o>=&gt;</span> <span class=p>[</span><span class=s1>&#39;index&#39;</span><span class=p>,</span> <span class=s1>&#39;search&#39;</span><span class=p>,</span> <span class=s1>&#39;new&#39;</span><span class=p>,</span> <span class=s1>&#39;edit&#39;</span><span class=p>,</span> <span class=s1>&#39;save&#39;</span><span class=p>,</span> <span class=s1>&#39;create&#39;</span><span class=p>,</span> <span class=s1>&#39;delete&#39;</span><span class=p>],</span>
<a id=__codelineno-27-12 name=__codelineno-27-12 href=#__codelineno-27-12></a>    <span class=s1>&#39;invoices&#39;</span>     <span class=o>=&gt;</span> <span class=p>[</span><span class=s1>&#39;index&#39;</span><span class=p>,</span> <span class=s1>&#39;profile&#39;</span><span class=p>],</span>
<a id=__codelineno-27-13 name=__codelineno-27-13 href=#__codelineno-27-13></a><span class=p>];</span>
<a id=__codelineno-27-14 name=__codelineno-27-14 href=#__codelineno-27-14></a>
<a id=__codelineno-27-15 name=__codelineno-27-15 href=#__codelineno-27-15></a><span class=k>foreach</span> <span class=p>(</span><span class=nv>$privateResources</span> <span class=k>as</span> <span class=nv>$resourceName</span> <span class=o>=&gt;</span> <span class=nv>$actions</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-27-16 name=__codelineno-27-16 href=#__codelineno-27-16></a>    <span class=nv>$acl</span><span class=o>-&gt;</span><span class=na>addResource</span><span class=p>(</span>
<a id=__codelineno-27-17 name=__codelineno-27-17 href=#__codelineno-27-17></a>        <span class=k>new</span> <span class=nx>Resource</span><span class=p>(</span><span class=nv>$resourceName</span><span class=p>),</span>
<a id=__codelineno-27-18 name=__codelineno-27-18 href=#__codelineno-27-18></a>        <span class=nv>$actions</span>
<a id=__codelineno-27-19 name=__codelineno-27-19 href=#__codelineno-27-19></a>    <span class=p>);</span>
<a id=__codelineno-27-20 name=__codelineno-27-20 href=#__codelineno-27-20></a><span class=p>}</span>
<a id=__codelineno-27-21 name=__codelineno-27-21 href=#__codelineno-27-21></a>
<a id=__codelineno-27-22 name=__codelineno-27-22 href=#__codelineno-27-22></a>
<a id=__codelineno-27-23 name=__codelineno-27-23 href=#__codelineno-27-23></a>
<a id=__codelineno-27-24 name=__codelineno-27-24 href=#__codelineno-27-24></a><span class=c1>// Public area resources (frontend)</span>
<a id=__codelineno-27-25 name=__codelineno-27-25 href=#__codelineno-27-25></a><span class=nv>$publicResources</span> <span class=o>=</span> <span class=p>[</span>
<a id=__codelineno-27-26 name=__codelineno-27-26 href=#__codelineno-27-26></a>    <span class=s1>&#39;index&#39;</span>    <span class=o>=&gt;</span> <span class=p>[</span><span class=s1>&#39;index&#39;</span><span class=p>],</span>
<a id=__codelineno-27-27 name=__codelineno-27-27 href=#__codelineno-27-27></a>    <span class=s1>&#39;about&#39;</span>    <span class=o>=&gt;</span> <span class=p>[</span><span class=s1>&#39;index&#39;</span><span class=p>],</span>
<a id=__codelineno-27-28 name=__codelineno-27-28 href=#__codelineno-27-28></a>    <span class=s1>&#39;register&#39;</span> <span class=o>=&gt;</span> <span class=p>[</span><span class=s1>&#39;index&#39;</span><span class=p>],</span>
<a id=__codelineno-27-29 name=__codelineno-27-29 href=#__codelineno-27-29></a>    <span class=s1>&#39;errors&#39;</span>   <span class=o>=&gt;</span> <span class=p>[</span><span class=s1>&#39;show404&#39;</span><span class=p>,</span> <span class=s1>&#39;show500&#39;</span><span class=p>],</span>
<a id=__codelineno-27-30 name=__codelineno-27-30 href=#__codelineno-27-30></a>    <span class=s1>&#39;session&#39;</span>  <span class=o>=&gt;</span> <span class=p>[</span><span class=s1>&#39;index&#39;</span><span class=p>,</span> <span class=s1>&#39;register&#39;</span><span class=p>,</span> <span class=s1>&#39;start&#39;</span><span class=p>,</span> <span class=s1>&#39;end&#39;</span><span class=p>],</span>
<a id=__codelineno-27-31 name=__codelineno-27-31 href=#__codelineno-27-31></a>    <span class=s1>&#39;contact&#39;</span>  <span class=o>=&gt;</span> <span class=p>[</span><span class=s1>&#39;index&#39;</span><span class=p>,</span> <span class=s1>&#39;send&#39;</span><span class=p>],</span>
<a id=__codelineno-27-32 name=__codelineno-27-32 href=#__codelineno-27-32></a><span class=p>];</span>
<a id=__codelineno-27-33 name=__codelineno-27-33 href=#__codelineno-27-33></a>
<a id=__codelineno-27-34 name=__codelineno-27-34 href=#__codelineno-27-34></a><span class=k>foreach</span> <span class=p>(</span><span class=nv>$publicResources</span> <span class=k>as</span> <span class=nv>$resourceName</span> <span class=o>=&gt;</span> <span class=nv>$actions</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-27-35 name=__codelineno-27-35 href=#__codelineno-27-35></a>    <span class=nv>$acl</span><span class=o>-&gt;</span><span class=na>addResource</span><span class=p>(</span>
<a id=__codelineno-27-36 name=__codelineno-27-36 href=#__codelineno-27-36></a>        <span class=k>new</span> <span class=nx>Resource</span><span class=p>(</span><span class=nv>$resourceName</span><span class=p>),</span>
<a id=__codelineno-27-37 name=__codelineno-27-37 href=#__codelineno-27-37></a>        <span class=nv>$actions</span>
<a id=__codelineno-27-38 name=__codelineno-27-38 href=#__codelineno-27-38></a>    <span class=p>);</span>
<a id=__codelineno-27-39 name=__codelineno-27-39 href=#__codelineno-27-39></a><span class=p>}</span>
</code></pre></div> <p>The ACL now knows about the existing controllers and their related actions. Role <code>Users</code> has access to all the resources of both frontend and backend. The role <code>Guests</code> only has access to the public area:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-28-1 name=__codelineno-28-1 href=#__codelineno-28-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-28-2 name=__codelineno-28-2 href=#__codelineno-28-2></a>
<a id=__codelineno-28-3 name=__codelineno-28-3 href=#__codelineno-28-3></a><span class=c1>// Grant access to public areas to both users and guests</span>
<a id=__codelineno-28-4 name=__codelineno-28-4 href=#__codelineno-28-4></a><span class=k>foreach</span> <span class=p>(</span><span class=nv>$roles</span> <span class=k>as</span> <span class=nv>$role</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-28-5 name=__codelineno-28-5 href=#__codelineno-28-5></a>    <span class=k>foreach</span> <span class=p>(</span><span class=nv>$publicResources</span> <span class=k>as</span> <span class=nv>$resource</span> <span class=o>=&gt;</span> <span class=nv>$actions</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-28-6 name=__codelineno-28-6 href=#__codelineno-28-6></a>        <span class=nv>$acl</span><span class=o>-&gt;</span><span class=na>allow</span><span class=p>(</span>
<a id=__codelineno-28-7 name=__codelineno-28-7 href=#__codelineno-28-7></a>            <span class=nv>$role</span><span class=o>-&gt;</span><span class=na>getName</span><span class=p>(),</span>
<a id=__codelineno-28-8 name=__codelineno-28-8 href=#__codelineno-28-8></a>            <span class=nv>$resource</span><span class=p>,</span>
<a id=__codelineno-28-9 name=__codelineno-28-9 href=#__codelineno-28-9></a>            <span class=s1>&#39;*&#39;</span>
<a id=__codelineno-28-10 name=__codelineno-28-10 href=#__codelineno-28-10></a>        <span class=p>);</span>
<a id=__codelineno-28-11 name=__codelineno-28-11 href=#__codelineno-28-11></a>    <span class=p>}</span>
<a id=__codelineno-28-12 name=__codelineno-28-12 href=#__codelineno-28-12></a><span class=p>}</span>
<a id=__codelineno-28-13 name=__codelineno-28-13 href=#__codelineno-28-13></a>
<a id=__codelineno-28-14 name=__codelineno-28-14 href=#__codelineno-28-14></a><span class=c1>// Grant access to private area only to role Users</span>
<a id=__codelineno-28-15 name=__codelineno-28-15 href=#__codelineno-28-15></a><span class=k>foreach</span> <span class=p>(</span><span class=nv>$privateResources</span> <span class=k>as</span> <span class=nv>$resource</span> <span class=o>=&gt;</span> <span class=nv>$actions</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-28-16 name=__codelineno-28-16 href=#__codelineno-28-16></a>    <span class=k>foreach</span> <span class=p>(</span><span class=nv>$actions</span> <span class=k>as</span> <span class=nv>$action</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-28-17 name=__codelineno-28-17 href=#__codelineno-28-17></a>        <span class=nv>$acl</span><span class=o>-&gt;</span><span class=na>allow</span><span class=p>(</span>
<a id=__codelineno-28-18 name=__codelineno-28-18 href=#__codelineno-28-18></a>            <span class=s1>&#39;Users&#39;</span><span class=p>,</span>
<a id=__codelineno-28-19 name=__codelineno-28-19 href=#__codelineno-28-19></a>            <span class=nv>$resource</span><span class=p>,</span>
<a id=__codelineno-28-20 name=__codelineno-28-20 href=#__codelineno-28-20></a>            <span class=nv>$action</span>
<a id=__codelineno-28-21 name=__codelineno-28-21 href=#__codelineno-28-21></a>        <span class=p>);</span>
<a id=__codelineno-28-22 name=__codelineno-28-22 href=#__codelineno-28-22></a>    <span class=p>}</span>
<a id=__codelineno-28-23 name=__codelineno-28-23 href=#__codelineno-28-23></a><span class=p>}</span>
</code></pre></div> <h2 id=working-with-the-crud>Working with the CRUD<a class=headerlink href=#working-with-the-crud title="Permanent link">&para;</a></h2> <p>Backends usually provide forms to allow users to manipulate data. Continuing the explanation of INVO, we now address the creation of CRUDs, a very common task that Phalcon will facilitate you using forms, validations, paginators and more.</p> <p>Most options that manipulate data in INVO (companies, products and types of products) were developed using a basic and common <a href=https://en.wikipedia.org/wiki/Create,_read,_update_and_delete>CRUD</a> (Create, Read, Update and Delete). Each CRUD contains the following files:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-29-1 name=__codelineno-29-1 href=#__codelineno-29-1></a>invo/
<a id=__codelineno-29-2 name=__codelineno-29-2 href=#__codelineno-29-2></a><span class=w>    </span>app/
<a id=__codelineno-29-3 name=__codelineno-29-3 href=#__codelineno-29-3></a><span class=w>        </span>controllers/
<a id=__codelineno-29-4 name=__codelineno-29-4 href=#__codelineno-29-4></a><span class=w>            </span>ProductsController.php
<a id=__codelineno-29-5 name=__codelineno-29-5 href=#__codelineno-29-5></a><span class=w>        </span>models/
<a id=__codelineno-29-6 name=__codelineno-29-6 href=#__codelineno-29-6></a><span class=w>            </span>Products.php
<a id=__codelineno-29-7 name=__codelineno-29-7 href=#__codelineno-29-7></a><span class=w>        </span>forms/
<a id=__codelineno-29-8 name=__codelineno-29-8 href=#__codelineno-29-8></a><span class=w>            </span>ProductsForm.php
<a id=__codelineno-29-9 name=__codelineno-29-9 href=#__codelineno-29-9></a><span class=w>        </span>views/
<a id=__codelineno-29-10 name=__codelineno-29-10 href=#__codelineno-29-10></a><span class=w>            </span>products/
<a id=__codelineno-29-11 name=__codelineno-29-11 href=#__codelineno-29-11></a><span class=w>                </span>edit.volt
<a id=__codelineno-29-12 name=__codelineno-29-12 href=#__codelineno-29-12></a><span class=w>                </span>index.volt
<a id=__codelineno-29-13 name=__codelineno-29-13 href=#__codelineno-29-13></a><span class=w>                </span>new.volt
<a id=__codelineno-29-14 name=__codelineno-29-14 href=#__codelineno-29-14></a><span class=w>                </span>search.volt
</code></pre></div> <p>Each controller has the following actions:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-30-1 name=__codelineno-30-1 href=#__codelineno-30-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-30-2 name=__codelineno-30-2 href=#__codelineno-30-2></a>
<a id=__codelineno-30-3 name=__codelineno-30-3 href=#__codelineno-30-3></a><span class=k>class</span> <span class=nc>ProductsController</span> <span class=k>extends</span> <span class=nx>ControllerBase</span>
<a id=__codelineno-30-4 name=__codelineno-30-4 href=#__codelineno-30-4></a><span class=p>{</span>
<a id=__codelineno-30-5 name=__codelineno-30-5 href=#__codelineno-30-5></a>    <span class=sd>/**</span>
<a id=__codelineno-30-6 name=__codelineno-30-6 href=#__codelineno-30-6></a><span class=sd>     * The start action, it shows the &#39;search&#39; view</span>
<a id=__codelineno-30-7 name=__codelineno-30-7 href=#__codelineno-30-7></a><span class=sd>     */</span>
<a id=__codelineno-30-8 name=__codelineno-30-8 href=#__codelineno-30-8></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>indexAction</span><span class=p>()</span>
<a id=__codelineno-30-9 name=__codelineno-30-9 href=#__codelineno-30-9></a>    <span class=p>{</span>
<a id=__codelineno-30-10 name=__codelineno-30-10 href=#__codelineno-30-10></a>        <span class=c1>// ...</span>
<a id=__codelineno-30-11 name=__codelineno-30-11 href=#__codelineno-30-11></a>    <span class=p>}</span>
<a id=__codelineno-30-12 name=__codelineno-30-12 href=#__codelineno-30-12></a>
<a id=__codelineno-30-13 name=__codelineno-30-13 href=#__codelineno-30-13></a>    <span class=sd>/**</span>
<a id=__codelineno-30-14 name=__codelineno-30-14 href=#__codelineno-30-14></a><span class=sd>     * Execute the &#39;search&#39; based on the criteria sent from the &#39;index&#39;</span>
<a id=__codelineno-30-15 name=__codelineno-30-15 href=#__codelineno-30-15></a><span class=sd>     * Returning a paginator for the results</span>
<a id=__codelineno-30-16 name=__codelineno-30-16 href=#__codelineno-30-16></a><span class=sd>     */</span>
<a id=__codelineno-30-17 name=__codelineno-30-17 href=#__codelineno-30-17></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>searchAction</span><span class=p>()</span>
<a id=__codelineno-30-18 name=__codelineno-30-18 href=#__codelineno-30-18></a>    <span class=p>{</span>
<a id=__codelineno-30-19 name=__codelineno-30-19 href=#__codelineno-30-19></a>        <span class=c1>// ...</span>
<a id=__codelineno-30-20 name=__codelineno-30-20 href=#__codelineno-30-20></a>    <span class=p>}</span>
<a id=__codelineno-30-21 name=__codelineno-30-21 href=#__codelineno-30-21></a>
<a id=__codelineno-30-22 name=__codelineno-30-22 href=#__codelineno-30-22></a>    <span class=sd>/**</span>
<a id=__codelineno-30-23 name=__codelineno-30-23 href=#__codelineno-30-23></a><span class=sd>     * Shows the view to create a &#39;new&#39; product</span>
<a id=__codelineno-30-24 name=__codelineno-30-24 href=#__codelineno-30-24></a><span class=sd>     */</span>
<a id=__codelineno-30-25 name=__codelineno-30-25 href=#__codelineno-30-25></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>newAction</span><span class=p>()</span>
<a id=__codelineno-30-26 name=__codelineno-30-26 href=#__codelineno-30-26></a>    <span class=p>{</span>
<a id=__codelineno-30-27 name=__codelineno-30-27 href=#__codelineno-30-27></a>        <span class=c1>// ...</span>
<a id=__codelineno-30-28 name=__codelineno-30-28 href=#__codelineno-30-28></a>    <span class=p>}</span>
<a id=__codelineno-30-29 name=__codelineno-30-29 href=#__codelineno-30-29></a>
<a id=__codelineno-30-30 name=__codelineno-30-30 href=#__codelineno-30-30></a>    <span class=sd>/**</span>
<a id=__codelineno-30-31 name=__codelineno-30-31 href=#__codelineno-30-31></a><span class=sd>     * Shows the view to &#39;edit&#39; an existing product</span>
<a id=__codelineno-30-32 name=__codelineno-30-32 href=#__codelineno-30-32></a><span class=sd>     */</span>
<a id=__codelineno-30-33 name=__codelineno-30-33 href=#__codelineno-30-33></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>editAction</span><span class=p>()</span>
<a id=__codelineno-30-34 name=__codelineno-30-34 href=#__codelineno-30-34></a>    <span class=p>{</span>
<a id=__codelineno-30-35 name=__codelineno-30-35 href=#__codelineno-30-35></a>        <span class=c1>// ...</span>
<a id=__codelineno-30-36 name=__codelineno-30-36 href=#__codelineno-30-36></a>    <span class=p>}</span>
<a id=__codelineno-30-37 name=__codelineno-30-37 href=#__codelineno-30-37></a>
<a id=__codelineno-30-38 name=__codelineno-30-38 href=#__codelineno-30-38></a>    <span class=sd>/**</span>
<a id=__codelineno-30-39 name=__codelineno-30-39 href=#__codelineno-30-39></a><span class=sd>     * Creates a product based on the data entered in the &#39;new&#39; action</span>
<a id=__codelineno-30-40 name=__codelineno-30-40 href=#__codelineno-30-40></a><span class=sd>     */</span>
<a id=__codelineno-30-41 name=__codelineno-30-41 href=#__codelineno-30-41></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>createAction</span><span class=p>()</span>
<a id=__codelineno-30-42 name=__codelineno-30-42 href=#__codelineno-30-42></a>    <span class=p>{</span>
<a id=__codelineno-30-43 name=__codelineno-30-43 href=#__codelineno-30-43></a>        <span class=c1>// ...</span>
<a id=__codelineno-30-44 name=__codelineno-30-44 href=#__codelineno-30-44></a>    <span class=p>}</span>
<a id=__codelineno-30-45 name=__codelineno-30-45 href=#__codelineno-30-45></a>
<a id=__codelineno-30-46 name=__codelineno-30-46 href=#__codelineno-30-46></a>    <span class=sd>/**</span>
<a id=__codelineno-30-47 name=__codelineno-30-47 href=#__codelineno-30-47></a><span class=sd>     * Updates a product based on the data entered in the &#39;edit&#39; action</span>
<a id=__codelineno-30-48 name=__codelineno-30-48 href=#__codelineno-30-48></a><span class=sd>     */</span>
<a id=__codelineno-30-49 name=__codelineno-30-49 href=#__codelineno-30-49></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>saveAction</span><span class=p>()</span>
<a id=__codelineno-30-50 name=__codelineno-30-50 href=#__codelineno-30-50></a>    <span class=p>{</span>
<a id=__codelineno-30-51 name=__codelineno-30-51 href=#__codelineno-30-51></a>        <span class=c1>// ...</span>
<a id=__codelineno-30-52 name=__codelineno-30-52 href=#__codelineno-30-52></a>    <span class=p>}</span>
<a id=__codelineno-30-53 name=__codelineno-30-53 href=#__codelineno-30-53></a>
<a id=__codelineno-30-54 name=__codelineno-30-54 href=#__codelineno-30-54></a>    <span class=sd>/**</span>
<a id=__codelineno-30-55 name=__codelineno-30-55 href=#__codelineno-30-55></a><span class=sd>     * Deletes an existing product</span>
<a id=__codelineno-30-56 name=__codelineno-30-56 href=#__codelineno-30-56></a><span class=sd>     */</span>
<a id=__codelineno-30-57 name=__codelineno-30-57 href=#__codelineno-30-57></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>deleteAction</span><span class=p>(</span><span class=nv>$id</span><span class=p>)</span>
<a id=__codelineno-30-58 name=__codelineno-30-58 href=#__codelineno-30-58></a>    <span class=p>{</span>
<a id=__codelineno-30-59 name=__codelineno-30-59 href=#__codelineno-30-59></a>        <span class=c1>// ...</span>
<a id=__codelineno-30-60 name=__codelineno-30-60 href=#__codelineno-30-60></a>    <span class=p>}</span>
<a id=__codelineno-30-61 name=__codelineno-30-61 href=#__codelineno-30-61></a><span class=p>}</span>
</code></pre></div> <h2 id=the-search-form>The Search Form<a class=headerlink href=#the-search-form title="Permanent link">&para;</a></h2> <p>Every CRUD starts with a search form. This form shows each field that the table has (products), allowing the user to create a search criteria for any field. The <code>products</code> table has a relationship with the table <code>products_types</code>. In this case, we previously queried the records in this table in order to facilitate the search by that field:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-31-1 name=__codelineno-31-1 href=#__codelineno-31-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-31-2 name=__codelineno-31-2 href=#__codelineno-31-2></a>
<a id=__codelineno-31-3 name=__codelineno-31-3 href=#__codelineno-31-3></a><span class=sd>/**</span>
<a id=__codelineno-31-4 name=__codelineno-31-4 href=#__codelineno-31-4></a><span class=sd> * The start action, it shows the &#39;search&#39; view</span>
<a id=__codelineno-31-5 name=__codelineno-31-5 href=#__codelineno-31-5></a><span class=sd> */</span>
<a id=__codelineno-31-6 name=__codelineno-31-6 href=#__codelineno-31-6></a><span class=k>public</span> <span class=k>function</span> <span class=nf>indexAction</span><span class=p>()</span>
<a id=__codelineno-31-7 name=__codelineno-31-7 href=#__codelineno-31-7></a><span class=p>{</span>
<a id=__codelineno-31-8 name=__codelineno-31-8 href=#__codelineno-31-8></a>    <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>persistent</span><span class=o>-&gt;</span><span class=na>searchParams</span> <span class=o>=</span> <span class=k>null</span><span class=p>;</span>
<a id=__codelineno-31-9 name=__codelineno-31-9 href=#__codelineno-31-9></a>
<a id=__codelineno-31-10 name=__codelineno-31-10 href=#__codelineno-31-10></a>    <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>view</span><span class=o>-&gt;</span><span class=na>form</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>ProductsForm</span><span class=p>();</span>
<a id=__codelineno-31-11 name=__codelineno-31-11 href=#__codelineno-31-11></a><span class=p>}</span>
</code></pre></div> <p>An instance of the <code>ProductsForm</code> form (<code>app/forms/ProductsForm.php</code>) is passed to the view. This form defines the fields that are visible to the user:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-32-1 name=__codelineno-32-1 href=#__codelineno-32-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-32-2 name=__codelineno-32-2 href=#__codelineno-32-2></a>
<a id=__codelineno-32-3 name=__codelineno-32-3 href=#__codelineno-32-3></a><span class=k>use</span> <span class=nx>Phalcon\Forms\Form</span><span class=p>;</span>
<a id=__codelineno-32-4 name=__codelineno-32-4 href=#__codelineno-32-4></a><span class=k>use</span> <span class=nx>Phalcon\Forms\Element\Text</span><span class=p>;</span>
<a id=__codelineno-32-5 name=__codelineno-32-5 href=#__codelineno-32-5></a><span class=k>use</span> <span class=nx>Phalcon\Forms\Element\Hidden</span><span class=p>;</span>
<a id=__codelineno-32-6 name=__codelineno-32-6 href=#__codelineno-32-6></a><span class=k>use</span> <span class=nx>Phalcon\Forms\Element\Select</span><span class=p>;</span>
<a id=__codelineno-32-7 name=__codelineno-32-7 href=#__codelineno-32-7></a><span class=k>use</span> <span class=nx>Phalcon\Validation\Validator\Email</span><span class=p>;</span>
<a id=__codelineno-32-8 name=__codelineno-32-8 href=#__codelineno-32-8></a><span class=k>use</span> <span class=nx>Phalcon\Validation\Validator\PresenceOf</span><span class=p>;</span>
<a id=__codelineno-32-9 name=__codelineno-32-9 href=#__codelineno-32-9></a><span class=k>use</span> <span class=nx>Phalcon\Validation\Validator\Numericality</span><span class=p>;</span>
<a id=__codelineno-32-10 name=__codelineno-32-10 href=#__codelineno-32-10></a>
<a id=__codelineno-32-11 name=__codelineno-32-11 href=#__codelineno-32-11></a><span class=k>class</span> <span class=nc>ProductsForm</span> <span class=k>extends</span> <span class=nx>Form</span>
<a id=__codelineno-32-12 name=__codelineno-32-12 href=#__codelineno-32-12></a><span class=p>{</span>
<a id=__codelineno-32-13 name=__codelineno-32-13 href=#__codelineno-32-13></a>    <span class=sd>/**</span>
<a id=__codelineno-32-14 name=__codelineno-32-14 href=#__codelineno-32-14></a><span class=sd>     * Initialize the products form</span>
<a id=__codelineno-32-15 name=__codelineno-32-15 href=#__codelineno-32-15></a><span class=sd>     */</span>
<a id=__codelineno-32-16 name=__codelineno-32-16 href=#__codelineno-32-16></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>initialize</span><span class=p>(</span><span class=nv>$entity</span> <span class=o>=</span> <span class=k>null</span><span class=p>,</span> <span class=nv>$options</span> <span class=o>=</span> <span class=p>[])</span>
<a id=__codelineno-32-17 name=__codelineno-32-17 href=#__codelineno-32-17></a>    <span class=p>{</span>
<a id=__codelineno-32-18 name=__codelineno-32-18 href=#__codelineno-32-18></a>        <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nb>isset</span><span class=p>(</span><span class=nv>$options</span><span class=p>[</span><span class=s1>&#39;edit&#39;</span><span class=p>]))</span> <span class=p>{</span>
<a id=__codelineno-32-19 name=__codelineno-32-19 href=#__codelineno-32-19></a>            <span class=nv>$element</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Text</span><span class=p>(</span><span class=s1>&#39;id&#39;</span><span class=p>);</span>
<a id=__codelineno-32-20 name=__codelineno-32-20 href=#__codelineno-32-20></a>            <span class=nv>$element</span><span class=o>-&gt;</span><span class=na>setLabel</span><span class=p>(</span><span class=s1>&#39;Id&#39;</span><span class=p>);</span>
<a id=__codelineno-32-21 name=__codelineno-32-21 href=#__codelineno-32-21></a>            <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>add</span><span class=p>(</span><span class=nv>$element</span><span class=p>);</span>
<a id=__codelineno-32-22 name=__codelineno-32-22 href=#__codelineno-32-22></a>        <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
<a id=__codelineno-32-23 name=__codelineno-32-23 href=#__codelineno-32-23></a>            <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>add</span><span class=p>(</span><span class=k>new</span> <span class=nx>Hidden</span><span class=p>(</span><span class=s1>&#39;id&#39;</span><span class=p>));</span>
<a id=__codelineno-32-24 name=__codelineno-32-24 href=#__codelineno-32-24></a>        <span class=p>}</span>
<a id=__codelineno-32-25 name=__codelineno-32-25 href=#__codelineno-32-25></a>
<a id=__codelineno-32-26 name=__codelineno-32-26 href=#__codelineno-32-26></a>        <span class=nv>$name</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Text</span><span class=p>(</span><span class=s1>&#39;name&#39;</span><span class=p>);</span>
<a id=__codelineno-32-27 name=__codelineno-32-27 href=#__codelineno-32-27></a>        <span class=nv>$name</span><span class=o>-&gt;</span><span class=na>setLabel</span><span class=p>(</span><span class=s1>&#39;Name&#39;</span><span class=p>);</span>
<a id=__codelineno-32-28 name=__codelineno-32-28 href=#__codelineno-32-28></a>        <span class=nv>$name</span><span class=o>-&gt;</span><span class=na>setFilters</span><span class=p>(</span>
<a id=__codelineno-32-29 name=__codelineno-32-29 href=#__codelineno-32-29></a>            <span class=p>[</span>
<a id=__codelineno-32-30 name=__codelineno-32-30 href=#__codelineno-32-30></a>                <span class=s1>&#39;striptags&#39;</span><span class=p>,</span>
<a id=__codelineno-32-31 name=__codelineno-32-31 href=#__codelineno-32-31></a>                <span class=s1>&#39;string&#39;</span><span class=p>,</span>
<a id=__codelineno-32-32 name=__codelineno-32-32 href=#__codelineno-32-32></a>            <span class=p>]</span>
<a id=__codelineno-32-33 name=__codelineno-32-33 href=#__codelineno-32-33></a>        <span class=p>);</span>
<a id=__codelineno-32-34 name=__codelineno-32-34 href=#__codelineno-32-34></a>        <span class=nv>$name</span><span class=o>-&gt;</span><span class=na>addValidators</span><span class=p>(</span>
<a id=__codelineno-32-35 name=__codelineno-32-35 href=#__codelineno-32-35></a>            <span class=p>[</span>
<a id=__codelineno-32-36 name=__codelineno-32-36 href=#__codelineno-32-36></a>                <span class=k>new</span> <span class=nx>PresenceOf</span><span class=p>(</span>
<a id=__codelineno-32-37 name=__codelineno-32-37 href=#__codelineno-32-37></a>                    <span class=p>[</span>
<a id=__codelineno-32-38 name=__codelineno-32-38 href=#__codelineno-32-38></a>                        <span class=s1>&#39;message&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;Name is required&#39;</span><span class=p>,</span>
<a id=__codelineno-32-39 name=__codelineno-32-39 href=#__codelineno-32-39></a>                    <span class=p>]</span>
<a id=__codelineno-32-40 name=__codelineno-32-40 href=#__codelineno-32-40></a>                <span class=p>)</span>
<a id=__codelineno-32-41 name=__codelineno-32-41 href=#__codelineno-32-41></a>            <span class=p>]</span>
<a id=__codelineno-32-42 name=__codelineno-32-42 href=#__codelineno-32-42></a>        <span class=p>);</span>
<a id=__codelineno-32-43 name=__codelineno-32-43 href=#__codelineno-32-43></a>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>add</span><span class=p>(</span><span class=nv>$name</span><span class=p>);</span>
<a id=__codelineno-32-44 name=__codelineno-32-44 href=#__codelineno-32-44></a>
<a id=__codelineno-32-45 name=__codelineno-32-45 href=#__codelineno-32-45></a>        <span class=nv>$type</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Select</span><span class=p>(</span>
<a id=__codelineno-32-46 name=__codelineno-32-46 href=#__codelineno-32-46></a>            <span class=s1>&#39;profilesId&#39;</span><span class=p>,</span>
<a id=__codelineno-32-47 name=__codelineno-32-47 href=#__codelineno-32-47></a>            <span class=nx>ProductTypes</span><span class=o>::</span><span class=na>find</span><span class=p>(),</span>
<a id=__codelineno-32-48 name=__codelineno-32-48 href=#__codelineno-32-48></a>            <span class=p>[</span>
<a id=__codelineno-32-49 name=__codelineno-32-49 href=#__codelineno-32-49></a>                <span class=s1>&#39;using&#39;</span>      <span class=o>=&gt;</span> <span class=p>[</span>
<a id=__codelineno-32-50 name=__codelineno-32-50 href=#__codelineno-32-50></a>                    <span class=s1>&#39;id&#39;</span><span class=p>,</span>
<a id=__codelineno-32-51 name=__codelineno-32-51 href=#__codelineno-32-51></a>                    <span class=s1>&#39;name&#39;</span><span class=p>,</span>
<a id=__codelineno-32-52 name=__codelineno-32-52 href=#__codelineno-32-52></a>                <span class=p>],</span>
<a id=__codelineno-32-53 name=__codelineno-32-53 href=#__codelineno-32-53></a>                <span class=s1>&#39;useEmpty&#39;</span>   <span class=o>=&gt;</span> <span class=k>true</span><span class=p>,</span>
<a id=__codelineno-32-54 name=__codelineno-32-54 href=#__codelineno-32-54></a>                <span class=s1>&#39;emptyText&#39;</span>  <span class=o>=&gt;</span> <span class=s1>&#39;...&#39;</span><span class=p>,</span>
<a id=__codelineno-32-55 name=__codelineno-32-55 href=#__codelineno-32-55></a>                <span class=s1>&#39;emptyValue&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;&#39;</span><span class=p>,</span>
<a id=__codelineno-32-56 name=__codelineno-32-56 href=#__codelineno-32-56></a>            <span class=p>]</span>
<a id=__codelineno-32-57 name=__codelineno-32-57 href=#__codelineno-32-57></a>        <span class=p>);</span>
<a id=__codelineno-32-58 name=__codelineno-32-58 href=#__codelineno-32-58></a>
<a id=__codelineno-32-59 name=__codelineno-32-59 href=#__codelineno-32-59></a>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>add</span><span class=p>(</span><span class=nv>$type</span><span class=p>);</span>
<a id=__codelineno-32-60 name=__codelineno-32-60 href=#__codelineno-32-60></a>
<a id=__codelineno-32-61 name=__codelineno-32-61 href=#__codelineno-32-61></a>        <span class=nv>$price</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Text</span><span class=p>(</span><span class=s1>&#39;price&#39;</span><span class=p>);</span>
<a id=__codelineno-32-62 name=__codelineno-32-62 href=#__codelineno-32-62></a>        <span class=nv>$price</span><span class=o>-&gt;</span><span class=na>setLabel</span><span class=p>(</span><span class=s1>&#39;Price&#39;</span><span class=p>);</span>
<a id=__codelineno-32-63 name=__codelineno-32-63 href=#__codelineno-32-63></a>        <span class=nv>$price</span><span class=o>-&gt;</span><span class=na>setFilters</span><span class=p>(</span>
<a id=__codelineno-32-64 name=__codelineno-32-64 href=#__codelineno-32-64></a>            <span class=p>[</span>
<a id=__codelineno-32-65 name=__codelineno-32-65 href=#__codelineno-32-65></a>                <span class=s1>&#39;float&#39;</span><span class=p>,</span>
<a id=__codelineno-32-66 name=__codelineno-32-66 href=#__codelineno-32-66></a>            <span class=p>]</span>
<a id=__codelineno-32-67 name=__codelineno-32-67 href=#__codelineno-32-67></a>        <span class=p>);</span>
<a id=__codelineno-32-68 name=__codelineno-32-68 href=#__codelineno-32-68></a>        <span class=nv>$price</span><span class=o>-&gt;</span><span class=na>addValidators</span><span class=p>(</span>
<a id=__codelineno-32-69 name=__codelineno-32-69 href=#__codelineno-32-69></a>            <span class=p>[</span>
<a id=__codelineno-32-70 name=__codelineno-32-70 href=#__codelineno-32-70></a>                <span class=k>new</span> <span class=nx>PresenceOf</span><span class=p>(</span>
<a id=__codelineno-32-71 name=__codelineno-32-71 href=#__codelineno-32-71></a>                    <span class=p>[</span>
<a id=__codelineno-32-72 name=__codelineno-32-72 href=#__codelineno-32-72></a>                        <span class=s1>&#39;message&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;Price is required&#39;</span><span class=p>,</span>
<a id=__codelineno-32-73 name=__codelineno-32-73 href=#__codelineno-32-73></a>                    <span class=p>]</span>
<a id=__codelineno-32-74 name=__codelineno-32-74 href=#__codelineno-32-74></a>                <span class=p>),</span>
<a id=__codelineno-32-75 name=__codelineno-32-75 href=#__codelineno-32-75></a>                <span class=k>new</span> <span class=nx>Numericality</span><span class=p>(</span>
<a id=__codelineno-32-76 name=__codelineno-32-76 href=#__codelineno-32-76></a>                    <span class=p>[</span>
<a id=__codelineno-32-77 name=__codelineno-32-77 href=#__codelineno-32-77></a>                        <span class=s1>&#39;message&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;Price is required&#39;</span><span class=p>,</span>
<a id=__codelineno-32-78 name=__codelineno-32-78 href=#__codelineno-32-78></a>                    <span class=p>]</span>
<a id=__codelineno-32-79 name=__codelineno-32-79 href=#__codelineno-32-79></a>                <span class=p>),</span>
<a id=__codelineno-32-80 name=__codelineno-32-80 href=#__codelineno-32-80></a>            <span class=p>]</span>
<a id=__codelineno-32-81 name=__codelineno-32-81 href=#__codelineno-32-81></a>        <span class=p>);</span>
<a id=__codelineno-32-82 name=__codelineno-32-82 href=#__codelineno-32-82></a>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>add</span><span class=p>(</span><span class=nv>$price</span><span class=p>);</span>
<a id=__codelineno-32-83 name=__codelineno-32-83 href=#__codelineno-32-83></a>    <span class=p>}</span>
<a id=__codelineno-32-84 name=__codelineno-32-84 href=#__codelineno-32-84></a><span class=p>}</span>
</code></pre></div> <p>The form is declared using an object-oriented scheme based on the elements provided by the <a href=../forms/ >forms</a> component. Every element follows almost the same structure:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-33-1 name=__codelineno-33-1 href=#__codelineno-33-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-33-2 name=__codelineno-33-2 href=#__codelineno-33-2></a>
<a id=__codelineno-33-3 name=__codelineno-33-3 href=#__codelineno-33-3></a><span class=c1>// Create the element</span>
<a id=__codelineno-33-4 name=__codelineno-33-4 href=#__codelineno-33-4></a><span class=nv>$name</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Text</span><span class=p>(</span><span class=s1>&#39;name&#39;</span><span class=p>);</span>
<a id=__codelineno-33-5 name=__codelineno-33-5 href=#__codelineno-33-5></a>
<a id=__codelineno-33-6 name=__codelineno-33-6 href=#__codelineno-33-6></a><span class=c1>// Set its label</span>
<a id=__codelineno-33-7 name=__codelineno-33-7 href=#__codelineno-33-7></a><span class=nv>$name</span><span class=o>-&gt;</span><span class=na>setLabel</span><span class=p>(</span><span class=s1>&#39;Name&#39;</span><span class=p>);</span>
<a id=__codelineno-33-8 name=__codelineno-33-8 href=#__codelineno-33-8></a>
<a id=__codelineno-33-9 name=__codelineno-33-9 href=#__codelineno-33-9></a><span class=c1>// Before validating the element apply these filters</span>
<a id=__codelineno-33-10 name=__codelineno-33-10 href=#__codelineno-33-10></a><span class=nv>$name</span><span class=o>-&gt;</span><span class=na>setFilters</span><span class=p>(</span>
<a id=__codelineno-33-11 name=__codelineno-33-11 href=#__codelineno-33-11></a>    <span class=p>[</span>
<a id=__codelineno-33-12 name=__codelineno-33-12 href=#__codelineno-33-12></a>        <span class=s1>&#39;striptags&#39;</span><span class=p>,</span>
<a id=__codelineno-33-13 name=__codelineno-33-13 href=#__codelineno-33-13></a>        <span class=s1>&#39;string&#39;</span><span class=p>,</span>
<a id=__codelineno-33-14 name=__codelineno-33-14 href=#__codelineno-33-14></a>    <span class=p>]</span>
<a id=__codelineno-33-15 name=__codelineno-33-15 href=#__codelineno-33-15></a><span class=p>);</span>
<a id=__codelineno-33-16 name=__codelineno-33-16 href=#__codelineno-33-16></a>
<a id=__codelineno-33-17 name=__codelineno-33-17 href=#__codelineno-33-17></a><span class=c1>// Apply this validators</span>
<a id=__codelineno-33-18 name=__codelineno-33-18 href=#__codelineno-33-18></a><span class=nv>$name</span><span class=o>-&gt;</span><span class=na>addValidators</span><span class=p>(</span>
<a id=__codelineno-33-19 name=__codelineno-33-19 href=#__codelineno-33-19></a>    <span class=p>[</span>
<a id=__codelineno-33-20 name=__codelineno-33-20 href=#__codelineno-33-20></a>        <span class=k>new</span> <span class=nx>PresenceOf</span><span class=p>(</span>
<a id=__codelineno-33-21 name=__codelineno-33-21 href=#__codelineno-33-21></a>            <span class=p>[</span>
<a id=__codelineno-33-22 name=__codelineno-33-22 href=#__codelineno-33-22></a>                <span class=s1>&#39;message&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;Name is required&#39;</span><span class=p>,</span>
<a id=__codelineno-33-23 name=__codelineno-33-23 href=#__codelineno-33-23></a>            <span class=p>]</span>
<a id=__codelineno-33-24 name=__codelineno-33-24 href=#__codelineno-33-24></a>        <span class=p>)</span>
<a id=__codelineno-33-25 name=__codelineno-33-25 href=#__codelineno-33-25></a>    <span class=p>]</span>
<a id=__codelineno-33-26 name=__codelineno-33-26 href=#__codelineno-33-26></a><span class=p>);</span>
<a id=__codelineno-33-27 name=__codelineno-33-27 href=#__codelineno-33-27></a>
<a id=__codelineno-33-28 name=__codelineno-33-28 href=#__codelineno-33-28></a><span class=c1>// Add the element to the form</span>
<a id=__codelineno-33-29 name=__codelineno-33-29 href=#__codelineno-33-29></a><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>add</span><span class=p>(</span><span class=nv>$name</span><span class=p>);</span>
</code></pre></div> <p>Other elements are also used in this form:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-34-1 name=__codelineno-34-1 href=#__codelineno-34-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-34-2 name=__codelineno-34-2 href=#__codelineno-34-2></a>
<a id=__codelineno-34-3 name=__codelineno-34-3 href=#__codelineno-34-3></a><span class=c1>// Add a hidden input to the form</span>
<a id=__codelineno-34-4 name=__codelineno-34-4 href=#__codelineno-34-4></a><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>add</span><span class=p>(</span>
<a id=__codelineno-34-5 name=__codelineno-34-5 href=#__codelineno-34-5></a>    <span class=k>new</span> <span class=nx>Hidden</span><span class=p>(</span><span class=s1>&#39;id&#39;</span><span class=p>)</span>
<a id=__codelineno-34-6 name=__codelineno-34-6 href=#__codelineno-34-6></a><span class=p>);</span>
<a id=__codelineno-34-7 name=__codelineno-34-7 href=#__codelineno-34-7></a>
<a id=__codelineno-34-8 name=__codelineno-34-8 href=#__codelineno-34-8></a><span class=c1>// ...</span>
<a id=__codelineno-34-9 name=__codelineno-34-9 href=#__codelineno-34-9></a>
<a id=__codelineno-34-10 name=__codelineno-34-10 href=#__codelineno-34-10></a><span class=nv>$productTypes</span> <span class=o>=</span> <span class=nx>ProductTypes</span><span class=o>::</span><span class=na>find</span><span class=p>();</span>
<a id=__codelineno-34-11 name=__codelineno-34-11 href=#__codelineno-34-11></a>
<a id=__codelineno-34-12 name=__codelineno-34-12 href=#__codelineno-34-12></a><span class=c1>// Add a HTML Select (list) to the form</span>
<a id=__codelineno-34-13 name=__codelineno-34-13 href=#__codelineno-34-13></a><span class=c1>// and fill it with data from &#39;product_types&#39;</span>
<a id=__codelineno-34-14 name=__codelineno-34-14 href=#__codelineno-34-14></a><span class=nv>$type</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Select</span><span class=p>(</span>
<a id=__codelineno-34-15 name=__codelineno-34-15 href=#__codelineno-34-15></a>    <span class=s1>&#39;profilesId&#39;</span><span class=p>,</span>
<a id=__codelineno-34-16 name=__codelineno-34-16 href=#__codelineno-34-16></a>    <span class=nv>$productTypes</span><span class=p>,</span>
<a id=__codelineno-34-17 name=__codelineno-34-17 href=#__codelineno-34-17></a>    <span class=p>[</span>
<a id=__codelineno-34-18 name=__codelineno-34-18 href=#__codelineno-34-18></a>        <span class=s1>&#39;using&#39;</span>      <span class=o>=&gt;</span> <span class=p>[</span>
<a id=__codelineno-34-19 name=__codelineno-34-19 href=#__codelineno-34-19></a>            <span class=s1>&#39;id&#39;</span><span class=p>,</span>
<a id=__codelineno-34-20 name=__codelineno-34-20 href=#__codelineno-34-20></a>            <span class=s1>&#39;name&#39;</span><span class=p>,</span>
<a id=__codelineno-34-21 name=__codelineno-34-21 href=#__codelineno-34-21></a>        <span class=p>],</span>
<a id=__codelineno-34-22 name=__codelineno-34-22 href=#__codelineno-34-22></a>        <span class=s1>&#39;useEmpty&#39;</span>   <span class=o>=&gt;</span> <span class=k>true</span><span class=p>,</span>
<a id=__codelineno-34-23 name=__codelineno-34-23 href=#__codelineno-34-23></a>        <span class=s1>&#39;emptyText&#39;</span>  <span class=o>=&gt;</span> <span class=s1>&#39;...&#39;</span><span class=p>,</span>
<a id=__codelineno-34-24 name=__codelineno-34-24 href=#__codelineno-34-24></a>        <span class=s1>&#39;emptyValue&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;&#39;</span><span class=p>,</span>
<a id=__codelineno-34-25 name=__codelineno-34-25 href=#__codelineno-34-25></a>    <span class=p>]</span>
<a id=__codelineno-34-26 name=__codelineno-34-26 href=#__codelineno-34-26></a><span class=p>);</span>
</code></pre></div> <p>Note that <code>ProductTypes::find()</code> contains the data necessary to fill the SELECT tag using <code>Phalcon\Tag::select()</code>. Once the form is passed to the view, it can be rendered and presented to the user:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-35-1 name=__codelineno-35-1 href=#__codelineno-35-1></a><span class=cp>{%</span> <span class=k>raw</span> <span class=cp>%}</span>
<a id=__codelineno-35-2 name=__codelineno-35-2 href=#__codelineno-35-2></a><span class=x>{{ form(&#39;products/search&#39;) }}</span>
<a id=__codelineno-35-3 name=__codelineno-35-3 href=#__codelineno-35-3></a>
<a id=__codelineno-35-4 name=__codelineno-35-4 href=#__codelineno-35-4></a><span class=x>    &lt;h2&gt;</span>
<a id=__codelineno-35-5 name=__codelineno-35-5 href=#__codelineno-35-5></a><span class=x>        Search products</span>
<a id=__codelineno-35-6 name=__codelineno-35-6 href=#__codelineno-35-6></a><span class=x>    &lt;/h2&gt;</span>
<a id=__codelineno-35-7 name=__codelineno-35-7 href=#__codelineno-35-7></a>
<a id=__codelineno-35-8 name=__codelineno-35-8 href=#__codelineno-35-8></a><span class=x>    &lt;fieldset&gt;</span>
<a id=__codelineno-35-9 name=__codelineno-35-9 href=#__codelineno-35-9></a>
<a id=__codelineno-35-10 name=__codelineno-35-10 href=#__codelineno-35-10></a><span class=x>        {% for element in form %}</span>
<a id=__codelineno-35-11 name=__codelineno-35-11 href=#__codelineno-35-11></a><span class=x>            &lt;div class=&#39;control-group&#39;&gt;</span>
<a id=__codelineno-35-12 name=__codelineno-35-12 href=#__codelineno-35-12></a><span class=x>                {{ element.label([&#39;class&#39;: &#39;control-label&#39;]) }}</span>
<a id=__codelineno-35-13 name=__codelineno-35-13 href=#__codelineno-35-13></a>
<a id=__codelineno-35-14 name=__codelineno-35-14 href=#__codelineno-35-14></a><span class=x>                &lt;div class=&#39;controls&#39;&gt;</span>
<a id=__codelineno-35-15 name=__codelineno-35-15 href=#__codelineno-35-15></a><span class=x>                    {{ element }}</span>
<a id=__codelineno-35-16 name=__codelineno-35-16 href=#__codelineno-35-16></a><span class=x>                &lt;/div&gt;</span>
<a id=__codelineno-35-17 name=__codelineno-35-17 href=#__codelineno-35-17></a><span class=x>            &lt;/div&gt;</span>
<a id=__codelineno-35-18 name=__codelineno-35-18 href=#__codelineno-35-18></a><span class=x>        {% endfor %}</span>
<a id=__codelineno-35-19 name=__codelineno-35-19 href=#__codelineno-35-19></a>
<a id=__codelineno-35-20 name=__codelineno-35-20 href=#__codelineno-35-20></a>
<a id=__codelineno-35-21 name=__codelineno-35-21 href=#__codelineno-35-21></a>
<a id=__codelineno-35-22 name=__codelineno-35-22 href=#__codelineno-35-22></a><span class=x>        &lt;div class=&#39;control-group&#39;&gt;</span>
<a id=__codelineno-35-23 name=__codelineno-35-23 href=#__codelineno-35-23></a><span class=x>            {{ submit_button(&#39;Search&#39;, &#39;class&#39;: &#39;btn btn-primary&#39;) }}</span>
<a id=__codelineno-35-24 name=__codelineno-35-24 href=#__codelineno-35-24></a><span class=x>        &lt;/div&gt;</span>
<a id=__codelineno-35-25 name=__codelineno-35-25 href=#__codelineno-35-25></a>
<a id=__codelineno-35-26 name=__codelineno-35-26 href=#__codelineno-35-26></a><span class=x>    &lt;/fieldset&gt;</span>
<a id=__codelineno-35-27 name=__codelineno-35-27 href=#__codelineno-35-27></a>
<a id=__codelineno-35-28 name=__codelineno-35-28 href=#__codelineno-35-28></a><span class=x>{{ endForm() }}</span>
<a id=__codelineno-35-29 name=__codelineno-35-29 href=#__codelineno-35-29></a><span class=cp>{%</span> <span class=k>endraw</span> <span class=cp>%}</span>
</code></pre></div> <p>This produces the following HTML:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-36-1 name=__codelineno-36-1 href=#__codelineno-36-1></a><span class=p>&lt;</span><span class=nt>form</span> <span class=na>action</span><span class=o>=</span><span class=s>&#39;/invo/products/search&#39;</span> <span class=na>method</span><span class=o>=</span><span class=s>&#39;post&#39;</span><span class=p>&gt;</span>
<a id=__codelineno-36-2 name=__codelineno-36-2 href=#__codelineno-36-2></a>
<a id=__codelineno-36-3 name=__codelineno-36-3 href=#__codelineno-36-3></a>    <span class=p>&lt;</span><span class=nt>h2</span><span class=p>&gt;</span>
<a id=__codelineno-36-4 name=__codelineno-36-4 href=#__codelineno-36-4></a>        Search products
<a id=__codelineno-36-5 name=__codelineno-36-5 href=#__codelineno-36-5></a>    <span class=p>&lt;/</span><span class=nt>h2</span><span class=p>&gt;</span>
<a id=__codelineno-36-6 name=__codelineno-36-6 href=#__codelineno-36-6></a>
<a id=__codelineno-36-7 name=__codelineno-36-7 href=#__codelineno-36-7></a>    <span class=p>&lt;</span><span class=nt>fieldset</span><span class=p>&gt;</span>
<a id=__codelineno-36-8 name=__codelineno-36-8 href=#__codelineno-36-8></a>
<a id=__codelineno-36-9 name=__codelineno-36-9 href=#__codelineno-36-9></a>        <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#39;control-group&#39;</span><span class=p>&gt;</span>
<a id=__codelineno-36-10 name=__codelineno-36-10 href=#__codelineno-36-10></a>            <span class=p>&lt;</span><span class=nt>label</span> <span class=na>for</span><span class=o>=</span><span class=s>&#39;id&#39;</span> <span class=na>class</span><span class=o>=</span><span class=s>&#39;control-label&#39;</span><span class=p>&gt;</span>Id<span class=p>&lt;/</span><span class=nt>label</span><span class=p>&gt;</span>
<a id=__codelineno-36-11 name=__codelineno-36-11 href=#__codelineno-36-11></a>
<a id=__codelineno-36-12 name=__codelineno-36-12 href=#__codelineno-36-12></a>            <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#39;controls&#39;</span><span class=p>&gt;</span>
<a id=__codelineno-36-13 name=__codelineno-36-13 href=#__codelineno-36-13></a>                <span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#39;text&#39;</span> <span class=na>id</span><span class=o>=</span><span class=s>&#39;id&#39;</span> <span class=na>name</span><span class=o>=</span><span class=s>&#39;id&#39;</span> <span class=p>/&gt;</span>
<a id=__codelineno-36-14 name=__codelineno-36-14 href=#__codelineno-36-14></a>            <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
<a id=__codelineno-36-15 name=__codelineno-36-15 href=#__codelineno-36-15></a>        <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
<a id=__codelineno-36-16 name=__codelineno-36-16 href=#__codelineno-36-16></a>
<a id=__codelineno-36-17 name=__codelineno-36-17 href=#__codelineno-36-17></a>        <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#39;control-group&#39;</span><span class=p>&gt;</span>
<a id=__codelineno-36-18 name=__codelineno-36-18 href=#__codelineno-36-18></a>            <span class=p>&lt;</span><span class=nt>label</span> <span class=na>for</span><span class=o>=</span><span class=s>&#39;name&#39;</span> <span class=na>class</span><span class=o>=</span><span class=s>&#39;control-label&#39;</span><span class=p>&gt;</span>Name<span class=p>&lt;/</span><span class=nt>label</span><span class=p>&gt;</span>
<a id=__codelineno-36-19 name=__codelineno-36-19 href=#__codelineno-36-19></a>
<a id=__codelineno-36-20 name=__codelineno-36-20 href=#__codelineno-36-20></a>            <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#39;controls&#39;</span><span class=p>&gt;</span>
<a id=__codelineno-36-21 name=__codelineno-36-21 href=#__codelineno-36-21></a>                <span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#39;text&#39;</span> <span class=na>id</span><span class=o>=</span><span class=s>&#39;name&#39;</span> <span class=na>name</span><span class=o>=</span><span class=s>&#39;name&#39;</span> <span class=p>/&gt;</span>
<a id=__codelineno-36-22 name=__codelineno-36-22 href=#__codelineno-36-22></a>            <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
<a id=__codelineno-36-23 name=__codelineno-36-23 href=#__codelineno-36-23></a>        <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
<a id=__codelineno-36-24 name=__codelineno-36-24 href=#__codelineno-36-24></a>
<a id=__codelineno-36-25 name=__codelineno-36-25 href=#__codelineno-36-25></a>        <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#39;control-group&#39;</span><span class=p>&gt;</span>
<a id=__codelineno-36-26 name=__codelineno-36-26 href=#__codelineno-36-26></a>            <span class=p>&lt;</span><span class=nt>label</span> <span class=na>for</span><span class=o>=</span><span class=s>&#39;profilesId&#39;</span> <span class=na>class</span><span class=o>=</span><span class=s>&#39;control-label&#39;</span><span class=p>&gt;</span>profilesId<span class=p>&lt;/</span><span class=nt>label</span><span class=p>&gt;</span>
<a id=__codelineno-36-27 name=__codelineno-36-27 href=#__codelineno-36-27></a>
<a id=__codelineno-36-28 name=__codelineno-36-28 href=#__codelineno-36-28></a>            <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#39;controls&#39;</span><span class=p>&gt;</span>
<a id=__codelineno-36-29 name=__codelineno-36-29 href=#__codelineno-36-29></a>                <span class=p>&lt;</span><span class=nt>select</span> <span class=na>id</span><span class=o>=</span><span class=s>&#39;profilesId&#39;</span> <span class=na>name</span><span class=o>=</span><span class=s>&#39;profilesId&#39;</span><span class=p>&gt;</span>
<a id=__codelineno-36-30 name=__codelineno-36-30 href=#__codelineno-36-30></a>                    <span class=p>&lt;</span><span class=nt>option</span> <span class=na>value</span><span class=o>=</span><span class=s>&#39;&#39;</span><span class=p>&gt;</span>...<span class=p>&lt;/</span><span class=nt>option</span><span class=p>&gt;</span>
<a id=__codelineno-36-31 name=__codelineno-36-31 href=#__codelineno-36-31></a>                    <span class=p>&lt;</span><span class=nt>option</span> <span class=na>value</span><span class=o>=</span><span class=s>&#39;1&#39;</span><span class=p>&gt;</span>Vegetables<span class=p>&lt;/</span><span class=nt>option</span><span class=p>&gt;</span>
<a id=__codelineno-36-32 name=__codelineno-36-32 href=#__codelineno-36-32></a>                    <span class=p>&lt;</span><span class=nt>option</span> <span class=na>value</span><span class=o>=</span><span class=s>&#39;2&#39;</span><span class=p>&gt;</span>Fruits<span class=p>&lt;/</span><span class=nt>option</span><span class=p>&gt;</span>
<a id=__codelineno-36-33 name=__codelineno-36-33 href=#__codelineno-36-33></a>                <span class=p>&lt;/</span><span class=nt>select</span><span class=p>&gt;</span>
<a id=__codelineno-36-34 name=__codelineno-36-34 href=#__codelineno-36-34></a>            <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
<a id=__codelineno-36-35 name=__codelineno-36-35 href=#__codelineno-36-35></a>        <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
<a id=__codelineno-36-36 name=__codelineno-36-36 href=#__codelineno-36-36></a>
<a id=__codelineno-36-37 name=__codelineno-36-37 href=#__codelineno-36-37></a>        <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#39;control-group&#39;</span><span class=p>&gt;</span>
<a id=__codelineno-36-38 name=__codelineno-36-38 href=#__codelineno-36-38></a>            <span class=p>&lt;</span><span class=nt>label</span> <span class=na>for</span><span class=o>=</span><span class=s>&#39;price&#39;</span> <span class=na>class</span><span class=o>=</span><span class=s>&#39;control-label&#39;</span><span class=p>&gt;</span>Price<span class=p>&lt;/</span><span class=nt>label</span><span class=p>&gt;</span>
<a id=__codelineno-36-39 name=__codelineno-36-39 href=#__codelineno-36-39></a>
<a id=__codelineno-36-40 name=__codelineno-36-40 href=#__codelineno-36-40></a>            <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#39;controls&#39;</span><span class=p>&gt;</span>
<a id=__codelineno-36-41 name=__codelineno-36-41 href=#__codelineno-36-41></a>                <span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#39;text&#39;</span> <span class=na>id</span><span class=o>=</span><span class=s>&#39;price&#39;</span> <span class=na>name</span><span class=o>=</span><span class=s>&#39;price&#39;</span> <span class=p>/&gt;</span>
<a id=__codelineno-36-42 name=__codelineno-36-42 href=#__codelineno-36-42></a>            <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
<a id=__codelineno-36-43 name=__codelineno-36-43 href=#__codelineno-36-43></a>        <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
<a id=__codelineno-36-44 name=__codelineno-36-44 href=#__codelineno-36-44></a>
<a id=__codelineno-36-45 name=__codelineno-36-45 href=#__codelineno-36-45></a>        <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#39;control-group&#39;</span><span class=p>&gt;</span>
<a id=__codelineno-36-46 name=__codelineno-36-46 href=#__codelineno-36-46></a>            <span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#39;submit&#39;</span> <span class=na>value</span><span class=o>=</span><span class=s>&#39;Search&#39;</span> <span class=na>class</span><span class=o>=</span><span class=s>&#39;btn btn-primary&#39;</span> <span class=p>/&gt;</span>
<a id=__codelineno-36-47 name=__codelineno-36-47 href=#__codelineno-36-47></a>        <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
<a id=__codelineno-36-48 name=__codelineno-36-48 href=#__codelineno-36-48></a>
<a id=__codelineno-36-49 name=__codelineno-36-49 href=#__codelineno-36-49></a>    <span class=p>&lt;/</span><span class=nt>fieldset</span><span class=p>&gt;</span>
<a id=__codelineno-36-50 name=__codelineno-36-50 href=#__codelineno-36-50></a>
<a id=__codelineno-36-51 name=__codelineno-36-51 href=#__codelineno-36-51></a><span class=p>&lt;/</span><span class=nt>form</span><span class=p>&gt;</span>
</code></pre></div> <p>When the form is submitted, the <code>search</code> action is executed in the controller performing the search based on the data entered by the user.</p> <h2 id=performing-a-search>Performing a Search<a class=headerlink href=#performing-a-search title="Permanent link">&para;</a></h2> <p>The <code>search</code> action has two behaviors. When accessed via POST, it performs a search based on the data sent from the form but when accessed via GET it moves the current page in the paginator. To differentiate HTTP methods, we check it using the <a href=../request/ >Request</a> component:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-37-1 name=__codelineno-37-1 href=#__codelineno-37-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-37-2 name=__codelineno-37-2 href=#__codelineno-37-2></a>
<a id=__codelineno-37-3 name=__codelineno-37-3 href=#__codelineno-37-3></a><span class=sd>/**</span>
<a id=__codelineno-37-4 name=__codelineno-37-4 href=#__codelineno-37-4></a><span class=sd> * Execute the &#39;search&#39; based on the criteria sent from the &#39;index&#39;</span>
<a id=__codelineno-37-5 name=__codelineno-37-5 href=#__codelineno-37-5></a><span class=sd> * Returning a paginator for the results</span>
<a id=__codelineno-37-6 name=__codelineno-37-6 href=#__codelineno-37-6></a><span class=sd> */</span>
<a id=__codelineno-37-7 name=__codelineno-37-7 href=#__codelineno-37-7></a><span class=k>public</span> <span class=k>function</span> <span class=nf>searchAction</span><span class=p>()</span>
<a id=__codelineno-37-8 name=__codelineno-37-8 href=#__codelineno-37-8></a><span class=p>{</span>
<a id=__codelineno-37-9 name=__codelineno-37-9 href=#__codelineno-37-9></a>    <span class=k>if</span> <span class=p>(</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>request</span><span class=o>-&gt;</span><span class=na>isPost</span><span class=p>())</span> <span class=p>{</span>
<a id=__codelineno-37-10 name=__codelineno-37-10 href=#__codelineno-37-10></a>        <span class=c1>// Create the query conditions</span>
<a id=__codelineno-37-11 name=__codelineno-37-11 href=#__codelineno-37-11></a>    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
<a id=__codelineno-37-12 name=__codelineno-37-12 href=#__codelineno-37-12></a>        <span class=c1>// Paginate using the existing conditions</span>
<a id=__codelineno-37-13 name=__codelineno-37-13 href=#__codelineno-37-13></a>    <span class=p>}</span>
<a id=__codelineno-37-14 name=__codelineno-37-14 href=#__codelineno-37-14></a>
<a id=__codelineno-37-15 name=__codelineno-37-15 href=#__codelineno-37-15></a>    <span class=c1>// ...</span>
<a id=__codelineno-37-16 name=__codelineno-37-16 href=#__codelineno-37-16></a><span class=p>}</span>
</code></pre></div> <p>With the help of <a href=../api/Phalcon_Mvc_Model_Criteria/ >Phalcon\Mvc\Model\Criteria</a>, we can create the search conditions intelligently based on the data types and values sent from the form:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-38-1 name=__codelineno-38-1 href=#__codelineno-38-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-38-2 name=__codelineno-38-2 href=#__codelineno-38-2></a>
<a id=__codelineno-38-3 name=__codelineno-38-3 href=#__codelineno-38-3></a><span class=nv>$query</span> <span class=o>=</span> <span class=nx>Criteria</span><span class=o>::</span><span class=na>fromInput</span><span class=p>(</span>
<a id=__codelineno-38-4 name=__codelineno-38-4 href=#__codelineno-38-4></a>    <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>di</span><span class=p>,</span>
<a id=__codelineno-38-5 name=__codelineno-38-5 href=#__codelineno-38-5></a>    <span class=s1>&#39;Products&#39;</span><span class=p>,</span>
<a id=__codelineno-38-6 name=__codelineno-38-6 href=#__codelineno-38-6></a>    <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>request</span><span class=o>-&gt;</span><span class=na>getPost</span><span class=p>()</span>
<a id=__codelineno-38-7 name=__codelineno-38-7 href=#__codelineno-38-7></a><span class=p>);</span>
</code></pre></div> <p>This method verifies which values are different from '' (empty string) and null and takes them into account to create the search criteria:</p> <ul> <li>If the field data type is text or similar (char, varchar, text, etc.) It uses an SQL <code>like</code> operator to filter the results.</li> <li>If the data type is not text or similar, it'll use the operator <code>=</code>.</li> </ul> <p>Additionally, <code>Criteria</code> ignores all the <code>$_POST</code> variables that do not match any field in the table. Values are automatically escaped using <code>bound parameters</code>.</p> <p>Now, we store the produced parameters in the controller's session bag:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-39-1 name=__codelineno-39-1 href=#__codelineno-39-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-39-2 name=__codelineno-39-2 href=#__codelineno-39-2></a>
<a id=__codelineno-39-3 name=__codelineno-39-3 href=#__codelineno-39-3></a><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>persistent</span><span class=o>-&gt;</span><span class=na>searchParams</span> <span class=o>=</span> <span class=nv>$query</span><span class=o>-&gt;</span><span class=na>getParams</span><span class=p>();</span>
</code></pre></div> <p>A session bag, is a special attribute in a controller that persists between requests using the session service. When accessed, this attribute injects a <a href=../api/Phalcon_Session/ >Phalcon\Session\Bag</a> instance that is independent in each controller.</p> <p>Then, based on the built params we perform the query:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-40-1 name=__codelineno-40-1 href=#__codelineno-40-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-40-2 name=__codelineno-40-2 href=#__codelineno-40-2></a>
<a id=__codelineno-40-3 name=__codelineno-40-3 href=#__codelineno-40-3></a><span class=nv>$products</span> <span class=o>=</span> <span class=nx>Products</span><span class=o>::</span><span class=na>find</span><span class=p>(</span><span class=nv>$parameters</span><span class=p>);</span>
<a id=__codelineno-40-4 name=__codelineno-40-4 href=#__codelineno-40-4></a>
<a id=__codelineno-40-5 name=__codelineno-40-5 href=#__codelineno-40-5></a><span class=k>if</span> <span class=p>(</span><span class=nb>count</span><span class=p>(</span><span class=nv>$products</span><span class=p>)</span> <span class=o>===</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-40-6 name=__codelineno-40-6 href=#__codelineno-40-6></a>    <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>flash</span><span class=o>-&gt;</span><span class=na>notice</span><span class=p>(</span>
<a id=__codelineno-40-7 name=__codelineno-40-7 href=#__codelineno-40-7></a>        <span class=s1>&#39;The search did not found any products&#39;</span>
<a id=__codelineno-40-8 name=__codelineno-40-8 href=#__codelineno-40-8></a>    <span class=p>);</span>
<a id=__codelineno-40-9 name=__codelineno-40-9 href=#__codelineno-40-9></a>
<a id=__codelineno-40-10 name=__codelineno-40-10 href=#__codelineno-40-10></a>    <span class=k>return</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>dispatcher</span><span class=o>-&gt;</span><span class=na>forward</span><span class=p>(</span>
<a id=__codelineno-40-11 name=__codelineno-40-11 href=#__codelineno-40-11></a>        <span class=p>[</span>
<a id=__codelineno-40-12 name=__codelineno-40-12 href=#__codelineno-40-12></a>            <span class=s1>&#39;controller&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;products&#39;</span><span class=p>,</span>
<a id=__codelineno-40-13 name=__codelineno-40-13 href=#__codelineno-40-13></a>            <span class=s1>&#39;action&#39;</span>     <span class=o>=&gt;</span> <span class=s1>&#39;index&#39;</span><span class=p>,</span>
<a id=__codelineno-40-14 name=__codelineno-40-14 href=#__codelineno-40-14></a>        <span class=p>]</span>
<a id=__codelineno-40-15 name=__codelineno-40-15 href=#__codelineno-40-15></a>    <span class=p>);</span>
<a id=__codelineno-40-16 name=__codelineno-40-16 href=#__codelineno-40-16></a><span class=p>}</span>
</code></pre></div> <p>If the search doesn't return any product, we forward the user to the index action again. Let's pretend the search returned results, then we create a paginator to navigate easily through them:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-41-1 name=__codelineno-41-1 href=#__codelineno-41-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-41-2 name=__codelineno-41-2 href=#__codelineno-41-2></a>
<a id=__codelineno-41-3 name=__codelineno-41-3 href=#__codelineno-41-3></a><span class=k>use</span> <span class=nx>Phalcon\Paginator\Adapter\Model</span> <span class=k>as</span> <span class=nx>Paginator</span><span class=p>;</span>
<a id=__codelineno-41-4 name=__codelineno-41-4 href=#__codelineno-41-4></a>
<a id=__codelineno-41-5 name=__codelineno-41-5 href=#__codelineno-41-5></a><span class=c1>// ...</span>
<a id=__codelineno-41-6 name=__codelineno-41-6 href=#__codelineno-41-6></a>
<a id=__codelineno-41-7 name=__codelineno-41-7 href=#__codelineno-41-7></a><span class=nv>$paginator</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Paginator</span><span class=p>(</span>
<a id=__codelineno-41-8 name=__codelineno-41-8 href=#__codelineno-41-8></a>    <span class=p>[</span>
<a id=__codelineno-41-9 name=__codelineno-41-9 href=#__codelineno-41-9></a>        <span class=s1>&#39;data&#39;</span>  <span class=o>=&gt;</span> <span class=nv>$products</span><span class=p>,</span>   <span class=c1>// Data to paginate</span>
<a id=__codelineno-41-10 name=__codelineno-41-10 href=#__codelineno-41-10></a>        <span class=s1>&#39;limit&#39;</span> <span class=o>=&gt;</span> <span class=mi>5</span><span class=p>,</span>           <span class=c1>// Rows per page</span>
<a id=__codelineno-41-11 name=__codelineno-41-11 href=#__codelineno-41-11></a>        <span class=s1>&#39;page&#39;</span>  <span class=o>=&gt;</span> <span class=nv>$numberPage</span><span class=p>,</span> <span class=c1>// Active page</span>
<a id=__codelineno-41-12 name=__codelineno-41-12 href=#__codelineno-41-12></a>    <span class=p>]</span>
<a id=__codelineno-41-13 name=__codelineno-41-13 href=#__codelineno-41-13></a><span class=p>);</span>
<a id=__codelineno-41-14 name=__codelineno-41-14 href=#__codelineno-41-14></a>
<a id=__codelineno-41-15 name=__codelineno-41-15 href=#__codelineno-41-15></a><span class=c1>// Get active page in the paginator</span>
<a id=__codelineno-41-16 name=__codelineno-41-16 href=#__codelineno-41-16></a><span class=nv>$page</span> <span class=o>=</span> <span class=nv>$paginator</span><span class=o>-&gt;</span><span class=na>getPaginate</span><span class=p>();</span>
</code></pre></div> <p>Finally we pass the returned page to view:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-42-1 name=__codelineno-42-1 href=#__codelineno-42-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-42-2 name=__codelineno-42-2 href=#__codelineno-42-2></a>
<a id=__codelineno-42-3 name=__codelineno-42-3 href=#__codelineno-42-3></a><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>view</span><span class=o>-&gt;</span><span class=na>page</span> <span class=o>=</span> <span class=nv>$page</span><span class=p>;</span>
</code></pre></div> <p>In the view (<code>app/views/products/search.volt</code>), we traverse the results corresponding to the current page, showing every row in the current page to the user:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-43-1 name=__codelineno-43-1 href=#__codelineno-43-1></a><span class=cp>{%</span> <span class=k>raw</span> <span class=cp>%}</span>
<a id=__codelineno-43-2 name=__codelineno-43-2 href=#__codelineno-43-2></a><span class=x>{% for product in page.items %}</span>
<a id=__codelineno-43-3 name=__codelineno-43-3 href=#__codelineno-43-3></a><span class=x>    {% if loop.first %}</span>
<a id=__codelineno-43-4 name=__codelineno-43-4 href=#__codelineno-43-4></a><span class=x>        &lt;table&gt;</span>
<a id=__codelineno-43-5 name=__codelineno-43-5 href=#__codelineno-43-5></a><span class=x>            &lt;thead&gt;</span>
<a id=__codelineno-43-6 name=__codelineno-43-6 href=#__codelineno-43-6></a><span class=x>                &lt;tr&gt;</span>
<a id=__codelineno-43-7 name=__codelineno-43-7 href=#__codelineno-43-7></a><span class=x>                    &lt;th&gt;Id&lt;/th&gt;</span>
<a id=__codelineno-43-8 name=__codelineno-43-8 href=#__codelineno-43-8></a><span class=x>                    &lt;th&gt;Product Type&lt;/th&gt;</span>
<a id=__codelineno-43-9 name=__codelineno-43-9 href=#__codelineno-43-9></a><span class=x>                    &lt;th&gt;Name&lt;/th&gt;</span>
<a id=__codelineno-43-10 name=__codelineno-43-10 href=#__codelineno-43-10></a><span class=x>                    &lt;th&gt;Price&lt;/th&gt;</span>
<a id=__codelineno-43-11 name=__codelineno-43-11 href=#__codelineno-43-11></a><span class=x>                    &lt;th&gt;Active&lt;/th&gt;</span>
<a id=__codelineno-43-12 name=__codelineno-43-12 href=#__codelineno-43-12></a><span class=x>                &lt;/tr&gt;</span>
<a id=__codelineno-43-13 name=__codelineno-43-13 href=#__codelineno-43-13></a><span class=x>            &lt;/thead&gt;</span>
<a id=__codelineno-43-14 name=__codelineno-43-14 href=#__codelineno-43-14></a><span class=x>            &lt;tbody&gt;</span>
<a id=__codelineno-43-15 name=__codelineno-43-15 href=#__codelineno-43-15></a><span class=x>    {% endif %}</span>
<a id=__codelineno-43-16 name=__codelineno-43-16 href=#__codelineno-43-16></a>
<a id=__codelineno-43-17 name=__codelineno-43-17 href=#__codelineno-43-17></a><span class=x>    &lt;tr&gt;</span>
<a id=__codelineno-43-18 name=__codelineno-43-18 href=#__codelineno-43-18></a><span class=x>        &lt;td&gt;</span>
<a id=__codelineno-43-19 name=__codelineno-43-19 href=#__codelineno-43-19></a><span class=x>            {{ product.id }}</span>
<a id=__codelineno-43-20 name=__codelineno-43-20 href=#__codelineno-43-20></a><span class=x>        &lt;/td&gt;</span>
<a id=__codelineno-43-21 name=__codelineno-43-21 href=#__codelineno-43-21></a>
<a id=__codelineno-43-22 name=__codelineno-43-22 href=#__codelineno-43-22></a><span class=x>        &lt;td&gt;</span>
<a id=__codelineno-43-23 name=__codelineno-43-23 href=#__codelineno-43-23></a><span class=x>            {{ product.getProductTypes().name }}</span>
<a id=__codelineno-43-24 name=__codelineno-43-24 href=#__codelineno-43-24></a><span class=x>        &lt;/td&gt;</span>
<a id=__codelineno-43-25 name=__codelineno-43-25 href=#__codelineno-43-25></a>
<a id=__codelineno-43-26 name=__codelineno-43-26 href=#__codelineno-43-26></a><span class=x>        &lt;td&gt;</span>
<a id=__codelineno-43-27 name=__codelineno-43-27 href=#__codelineno-43-27></a><span class=x>            {{ product.name }}</span>
<a id=__codelineno-43-28 name=__codelineno-43-28 href=#__codelineno-43-28></a><span class=x>        &lt;/td&gt;</span>
<a id=__codelineno-43-29 name=__codelineno-43-29 href=#__codelineno-43-29></a>
<a id=__codelineno-43-30 name=__codelineno-43-30 href=#__codelineno-43-30></a><span class=x>        &lt;td&gt;</span>
<a id=__codelineno-43-31 name=__codelineno-43-31 href=#__codelineno-43-31></a><span class=x>            {{ &#39;%.2f&#39;|format(product.price) }}</span>
<a id=__codelineno-43-32 name=__codelineno-43-32 href=#__codelineno-43-32></a><span class=x>        &lt;/td&gt;</span>
<a id=__codelineno-43-33 name=__codelineno-43-33 href=#__codelineno-43-33></a>
<a id=__codelineno-43-34 name=__codelineno-43-34 href=#__codelineno-43-34></a><span class=x>        &lt;td&gt;</span>
<a id=__codelineno-43-35 name=__codelineno-43-35 href=#__codelineno-43-35></a><span class=x>            {{ product.getActiveDetail() }}</span>
<a id=__codelineno-43-36 name=__codelineno-43-36 href=#__codelineno-43-36></a><span class=x>        &lt;/td&gt;</span>
<a id=__codelineno-43-37 name=__codelineno-43-37 href=#__codelineno-43-37></a>
<a id=__codelineno-43-38 name=__codelineno-43-38 href=#__codelineno-43-38></a><span class=x>        &lt;td width=&#39;7%&#39;&gt;</span>
<a id=__codelineno-43-39 name=__codelineno-43-39 href=#__codelineno-43-39></a><span class=x>            {{ link_to(&#39;products/edit/&#39; ~ product.id, &#39;Edit&#39;) }}</span>
<a id=__codelineno-43-40 name=__codelineno-43-40 href=#__codelineno-43-40></a><span class=x>        &lt;/td&gt;</span>
<a id=__codelineno-43-41 name=__codelineno-43-41 href=#__codelineno-43-41></a>
<a id=__codelineno-43-42 name=__codelineno-43-42 href=#__codelineno-43-42></a><span class=x>        &lt;td width=&#39;7%&#39;&gt;</span>
<a id=__codelineno-43-43 name=__codelineno-43-43 href=#__codelineno-43-43></a><span class=x>            {{ link_to(&#39;products/delete/&#39; ~ product.id, &#39;Delete&#39;) }}</span>
<a id=__codelineno-43-44 name=__codelineno-43-44 href=#__codelineno-43-44></a><span class=x>        &lt;/td&gt;</span>
<a id=__codelineno-43-45 name=__codelineno-43-45 href=#__codelineno-43-45></a><span class=x>    &lt;/tr&gt;</span>
<a id=__codelineno-43-46 name=__codelineno-43-46 href=#__codelineno-43-46></a>
<a id=__codelineno-43-47 name=__codelineno-43-47 href=#__codelineno-43-47></a><span class=x>    {% if loop.last %}</span>
<a id=__codelineno-43-48 name=__codelineno-43-48 href=#__codelineno-43-48></a><span class=x>            &lt;/tbody&gt;</span>
<a id=__codelineno-43-49 name=__codelineno-43-49 href=#__codelineno-43-49></a><span class=x>            &lt;tbody&gt;</span>
<a id=__codelineno-43-50 name=__codelineno-43-50 href=#__codelineno-43-50></a><span class=x>                &lt;tr&gt;</span>
<a id=__codelineno-43-51 name=__codelineno-43-51 href=#__codelineno-43-51></a><span class=x>                    &lt;td colspan=&#39;7&#39;&gt;</span>
<a id=__codelineno-43-52 name=__codelineno-43-52 href=#__codelineno-43-52></a><span class=x>                        &lt;div&gt;</span>
<a id=__codelineno-43-53 name=__codelineno-43-53 href=#__codelineno-43-53></a><span class=x>                            {{ link_to(&#39;products/search&#39;, &#39;First&#39;) }}</span>
<a id=__codelineno-43-54 name=__codelineno-43-54 href=#__codelineno-43-54></a><span class=x>                            {{ link_to(&#39;products/search?page=&#39; ~ page.before, &#39;Previous&#39;) }}</span>
<a id=__codelineno-43-55 name=__codelineno-43-55 href=#__codelineno-43-55></a><span class=x>                            {{ link_to(&#39;products/search?page=&#39; ~ page.next, &#39;Next&#39;) }}</span>
<a id=__codelineno-43-56 name=__codelineno-43-56 href=#__codelineno-43-56></a><span class=x>                            {{ link_to(&#39;products/search?page=&#39; ~ page.last, &#39;Last&#39;) }}</span>
<a id=__codelineno-43-57 name=__codelineno-43-57 href=#__codelineno-43-57></a><span class=x>                            &lt;span class=&#39;help-inline&#39;&gt;{{ page.current }} of {{ page.total_pages }}&lt;/span&gt;</span>
<a id=__codelineno-43-58 name=__codelineno-43-58 href=#__codelineno-43-58></a><span class=x>                        &lt;/div&gt;</span>
<a id=__codelineno-43-59 name=__codelineno-43-59 href=#__codelineno-43-59></a><span class=x>                    &lt;/td&gt;</span>
<a id=__codelineno-43-60 name=__codelineno-43-60 href=#__codelineno-43-60></a><span class=x>                &lt;/tr&gt;</span>
<a id=__codelineno-43-61 name=__codelineno-43-61 href=#__codelineno-43-61></a><span class=x>            &lt;/tbody&gt;</span>
<a id=__codelineno-43-62 name=__codelineno-43-62 href=#__codelineno-43-62></a><span class=x>        &lt;/table&gt;</span>
<a id=__codelineno-43-63 name=__codelineno-43-63 href=#__codelineno-43-63></a><span class=x>    {% endif %}</span>
<a id=__codelineno-43-64 name=__codelineno-43-64 href=#__codelineno-43-64></a><span class=x>{% else %}</span>
<a id=__codelineno-43-65 name=__codelineno-43-65 href=#__codelineno-43-65></a><span class=x>    No products are recorded</span>
<a id=__codelineno-43-66 name=__codelineno-43-66 href=#__codelineno-43-66></a><span class=x>{% endfor %}</span>
<a id=__codelineno-43-67 name=__codelineno-43-67 href=#__codelineno-43-67></a><span class=cp>{%</span> <span class=k>endraw</span> <span class=cp>%}</span>
</code></pre></div> <p>There are many things in the above example that worth detailing. First of all, active items in the current page are traversed using a Volt's <code>for</code>. Volt provides a simpler syntax for a PHP <code>foreach</code>.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-44-1 name=__codelineno-44-1 href=#__codelineno-44-1></a><span class=cp>{%</span> <span class=k>raw</span> <span class=cp>%}</span>
<a id=__codelineno-44-2 name=__codelineno-44-2 href=#__codelineno-44-2></a><span class=x>{% for product in page.items %}</span>
<a id=__codelineno-44-3 name=__codelineno-44-3 href=#__codelineno-44-3></a><span class=cp>{%</span> <span class=k>endraw</span> <span class=cp>%}</span>
</code></pre></div> <p>Which in PHP is the same as:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-45-1 name=__codelineno-45-1 href=#__codelineno-45-1></a><span class=o>&lt;?</span><span class=nx>php</span> <span class=k>foreach</span> <span class=p>(</span><span class=nv>$page</span><span class=o>-&gt;</span><span class=na>items</span> <span class=k>as</span> <span class=nv>$product</span><span class=p>)</span> <span class=p>{</span> <span class=cp>?&gt;</span>
</code></pre></div> <p>The whole <code>for</code> block provides the following:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-46-1 name=__codelineno-46-1 href=#__codelineno-46-1></a><span class=cp>{%</span> <span class=k>raw</span> <span class=cp>%}</span>
<a id=__codelineno-46-2 name=__codelineno-46-2 href=#__codelineno-46-2></a><span class=x>{% for product in page.items %}</span>
<a id=__codelineno-46-3 name=__codelineno-46-3 href=#__codelineno-46-3></a><span class=x>    {% if loop.first %}</span>
<a id=__codelineno-46-4 name=__codelineno-46-4 href=#__codelineno-46-4></a><span class=x>        Executed before the first product in the loop</span>
<a id=__codelineno-46-5 name=__codelineno-46-5 href=#__codelineno-46-5></a><span class=x>    {% endif %}</span>
<a id=__codelineno-46-6 name=__codelineno-46-6 href=#__codelineno-46-6></a>
<a id=__codelineno-46-7 name=__codelineno-46-7 href=#__codelineno-46-7></a><span class=x>    Executed for every product of page.items</span>
<a id=__codelineno-46-8 name=__codelineno-46-8 href=#__codelineno-46-8></a>
<a id=__codelineno-46-9 name=__codelineno-46-9 href=#__codelineno-46-9></a><span class=x>    {% if loop.last %}</span>
<a id=__codelineno-46-10 name=__codelineno-46-10 href=#__codelineno-46-10></a><span class=x>        Executed after the last product is loop</span>
<a id=__codelineno-46-11 name=__codelineno-46-11 href=#__codelineno-46-11></a><span class=x>    {% endif %}</span>
<a id=__codelineno-46-12 name=__codelineno-46-12 href=#__codelineno-46-12></a><span class=x>{% else %}</span>
<a id=__codelineno-46-13 name=__codelineno-46-13 href=#__codelineno-46-13></a><span class=x>    Executed if page.items does not have any products</span>
<a id=__codelineno-46-14 name=__codelineno-46-14 href=#__codelineno-46-14></a><span class=x>{% endfor %}</span>
<a id=__codelineno-46-15 name=__codelineno-46-15 href=#__codelineno-46-15></a><span class=cp>{%</span> <span class=k>endraw</span> <span class=cp>%}</span>
</code></pre></div> <p>Now you can go back to the view and find out what every block is doing. Every field in <code>product</code> is printed accordingly:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-47-1 name=__codelineno-47-1 href=#__codelineno-47-1></a><span class=cp>{%</span> <span class=k>raw</span> <span class=cp>%}</span>
<a id=__codelineno-47-2 name=__codelineno-47-2 href=#__codelineno-47-2></a><span class=x>&lt;tr&gt;</span>
<a id=__codelineno-47-3 name=__codelineno-47-3 href=#__codelineno-47-3></a><span class=x>    &lt;td&gt;</span>
<a id=__codelineno-47-4 name=__codelineno-47-4 href=#__codelineno-47-4></a><span class=x>        {{ product.id }}</span>
<a id=__codelineno-47-5 name=__codelineno-47-5 href=#__codelineno-47-5></a><span class=x>    &lt;/td&gt;</span>
<a id=__codelineno-47-6 name=__codelineno-47-6 href=#__codelineno-47-6></a>
<a id=__codelineno-47-7 name=__codelineno-47-7 href=#__codelineno-47-7></a><span class=x>    &lt;td&gt;</span>
<a id=__codelineno-47-8 name=__codelineno-47-8 href=#__codelineno-47-8></a><span class=x>        {{ product.productTypes.name }}</span>
<a id=__codelineno-47-9 name=__codelineno-47-9 href=#__codelineno-47-9></a><span class=x>    &lt;/td&gt;</span>
<a id=__codelineno-47-10 name=__codelineno-47-10 href=#__codelineno-47-10></a>
<a id=__codelineno-47-11 name=__codelineno-47-11 href=#__codelineno-47-11></a><span class=x>    &lt;td&gt;</span>
<a id=__codelineno-47-12 name=__codelineno-47-12 href=#__codelineno-47-12></a><span class=x>        {{ product.name }}</span>
<a id=__codelineno-47-13 name=__codelineno-47-13 href=#__codelineno-47-13></a><span class=x>    &lt;/td&gt;</span>
<a id=__codelineno-47-14 name=__codelineno-47-14 href=#__codelineno-47-14></a>
<a id=__codelineno-47-15 name=__codelineno-47-15 href=#__codelineno-47-15></a><span class=x>    &lt;td&gt;</span>
<a id=__codelineno-47-16 name=__codelineno-47-16 href=#__codelineno-47-16></a><span class=x>        {{ &#39;%.2f&#39;|format(product.price) }}</span>
<a id=__codelineno-47-17 name=__codelineno-47-17 href=#__codelineno-47-17></a><span class=x>    &lt;/td&gt;</span>
<a id=__codelineno-47-18 name=__codelineno-47-18 href=#__codelineno-47-18></a>
<a id=__codelineno-47-19 name=__codelineno-47-19 href=#__codelineno-47-19></a><span class=x>    &lt;td&gt;</span>
<a id=__codelineno-47-20 name=__codelineno-47-20 href=#__codelineno-47-20></a><span class=x>        {{ product.getActiveDetail() }}</span>
<a id=__codelineno-47-21 name=__codelineno-47-21 href=#__codelineno-47-21></a><span class=x>    &lt;/td&gt;</span>
<a id=__codelineno-47-22 name=__codelineno-47-22 href=#__codelineno-47-22></a>
<a id=__codelineno-47-23 name=__codelineno-47-23 href=#__codelineno-47-23></a><span class=x>    &lt;td width=&#39;7%&#39;&gt;</span>
<a id=__codelineno-47-24 name=__codelineno-47-24 href=#__codelineno-47-24></a><span class=x>        {{ link_to(&#39;products/edit/&#39; ~ product.id, &#39;Edit&#39;) }}</span>
<a id=__codelineno-47-25 name=__codelineno-47-25 href=#__codelineno-47-25></a><span class=x>    &lt;/td&gt;</span>
<a id=__codelineno-47-26 name=__codelineno-47-26 href=#__codelineno-47-26></a>
<a id=__codelineno-47-27 name=__codelineno-47-27 href=#__codelineno-47-27></a><span class=x>    &lt;td width=&#39;7%&#39;&gt;</span>
<a id=__codelineno-47-28 name=__codelineno-47-28 href=#__codelineno-47-28></a><span class=x>        {{ link_to(&#39;products/delete/&#39; ~ product.id, &#39;Delete&#39;) }}</span>
<a id=__codelineno-47-29 name=__codelineno-47-29 href=#__codelineno-47-29></a><span class=x>    &lt;/td&gt;</span>
<a id=__codelineno-47-30 name=__codelineno-47-30 href=#__codelineno-47-30></a><span class=x>&lt;/tr&gt;</span>
<a id=__codelineno-47-31 name=__codelineno-47-31 href=#__codelineno-47-31></a><span class=cp>{%</span> <span class=k>endraw</span> <span class=cp>%}</span>
</code></pre></div> <p>As we seen before using <code>product.id</code> is the same as in PHP as doing: <code>$product-&gt;id</code>, we made the same with <code>product.name</code> and so on. Other fields are rendered differently, for instance, let's focus in <code>product.productTypes.name</code>. To understand this part, we have to check the Products model (<code>app/models/Products.php</code>):</p> <div class=highlight><pre><span></span><code><a id=__codelineno-48-1 name=__codelineno-48-1 href=#__codelineno-48-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-48-2 name=__codelineno-48-2 href=#__codelineno-48-2></a>
<a id=__codelineno-48-3 name=__codelineno-48-3 href=#__codelineno-48-3></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Model</span><span class=p>;</span>
<a id=__codelineno-48-4 name=__codelineno-48-4 href=#__codelineno-48-4></a>
<a id=__codelineno-48-5 name=__codelineno-48-5 href=#__codelineno-48-5></a><span class=sd>/**</span>
<a id=__codelineno-48-6 name=__codelineno-48-6 href=#__codelineno-48-6></a><span class=sd> * Products</span>
<a id=__codelineno-48-7 name=__codelineno-48-7 href=#__codelineno-48-7></a><span class=sd> */</span>
<a id=__codelineno-48-8 name=__codelineno-48-8 href=#__codelineno-48-8></a><span class=k>class</span> <span class=nc>Products</span> <span class=k>extends</span> <span class=nx>Model</span>
<a id=__codelineno-48-9 name=__codelineno-48-9 href=#__codelineno-48-9></a><span class=p>{</span>
<a id=__codelineno-48-10 name=__codelineno-48-10 href=#__codelineno-48-10></a>    <span class=c1>// ...</span>
<a id=__codelineno-48-11 name=__codelineno-48-11 href=#__codelineno-48-11></a>
<a id=__codelineno-48-12 name=__codelineno-48-12 href=#__codelineno-48-12></a>    <span class=sd>/**</span>
<a id=__codelineno-48-13 name=__codelineno-48-13 href=#__codelineno-48-13></a><span class=sd>     * Products initializer</span>
<a id=__codelineno-48-14 name=__codelineno-48-14 href=#__codelineno-48-14></a><span class=sd>     */</span>
<a id=__codelineno-48-15 name=__codelineno-48-15 href=#__codelineno-48-15></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>initialize</span><span class=p>()</span>
<a id=__codelineno-48-16 name=__codelineno-48-16 href=#__codelineno-48-16></a>    <span class=p>{</span>
<a id=__codelineno-48-17 name=__codelineno-48-17 href=#__codelineno-48-17></a>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>belongsTo</span><span class=p>(</span>
<a id=__codelineno-48-18 name=__codelineno-48-18 href=#__codelineno-48-18></a>            <span class=s1>&#39;product_types_id&#39;</span><span class=p>,</span>
<a id=__codelineno-48-19 name=__codelineno-48-19 href=#__codelineno-48-19></a>            <span class=s1>&#39;ProductTypes&#39;</span><span class=p>,</span>
<a id=__codelineno-48-20 name=__codelineno-48-20 href=#__codelineno-48-20></a>            <span class=s1>&#39;id&#39;</span><span class=p>,</span>
<a id=__codelineno-48-21 name=__codelineno-48-21 href=#__codelineno-48-21></a>            <span class=p>[</span>
<a id=__codelineno-48-22 name=__codelineno-48-22 href=#__codelineno-48-22></a>                <span class=s1>&#39;reusable&#39;</span> <span class=o>=&gt;</span> <span class=k>true</span><span class=p>,</span>
<a id=__codelineno-48-23 name=__codelineno-48-23 href=#__codelineno-48-23></a>            <span class=p>]</span>
<a id=__codelineno-48-24 name=__codelineno-48-24 href=#__codelineno-48-24></a>        <span class=p>);</span>
<a id=__codelineno-48-25 name=__codelineno-48-25 href=#__codelineno-48-25></a>    <span class=p>}</span>
<a id=__codelineno-48-26 name=__codelineno-48-26 href=#__codelineno-48-26></a>
<a id=__codelineno-48-27 name=__codelineno-48-27 href=#__codelineno-48-27></a>    <span class=c1>// ...</span>
<a id=__codelineno-48-28 name=__codelineno-48-28 href=#__codelineno-48-28></a><span class=p>}</span>
</code></pre></div> <p>A model can have a method called <code>initialize()</code>, this method is called once per request and it serves the ORM to initialize a model. In this case, 'Products' is initialized by defining that this model has a one-to-many relationship to another model called 'ProductTypes'.</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-49-1 name=__codelineno-49-1 href=#__codelineno-49-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-49-2 name=__codelineno-49-2 href=#__codelineno-49-2></a>
<a id=__codelineno-49-3 name=__codelineno-49-3 href=#__codelineno-49-3></a><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>belongsTo</span><span class=p>(</span>
<a id=__codelineno-49-4 name=__codelineno-49-4 href=#__codelineno-49-4></a>    <span class=s1>&#39;product_types_id&#39;</span><span class=p>,</span>
<a id=__codelineno-49-5 name=__codelineno-49-5 href=#__codelineno-49-5></a>    <span class=s1>&#39;ProductTypes&#39;</span><span class=p>,</span>
<a id=__codelineno-49-6 name=__codelineno-49-6 href=#__codelineno-49-6></a>    <span class=s1>&#39;id&#39;</span><span class=p>,</span>
<a id=__codelineno-49-7 name=__codelineno-49-7 href=#__codelineno-49-7></a>    <span class=p>[</span>
<a id=__codelineno-49-8 name=__codelineno-49-8 href=#__codelineno-49-8></a>        <span class=s1>&#39;reusable&#39;</span> <span class=o>=&gt;</span> <span class=k>true</span><span class=p>,</span>
<a id=__codelineno-49-9 name=__codelineno-49-9 href=#__codelineno-49-9></a>    <span class=p>]</span>
<a id=__codelineno-49-10 name=__codelineno-49-10 href=#__codelineno-49-10></a><span class=p>);</span>
</code></pre></div> Which means, the local attribute <code>product_types_id</code> in <code>Products</code> has an one-to-many relation to the <code>ProductTypes</code> model in its attribute <code>id</code>. By defining this relationship we can access the name of the product type by using:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-50-1 name=__codelineno-50-1 href=#__codelineno-50-1></a><span class=cp>{%</span> <span class=k>raw</span> <span class=cp>%}</span>
<a id=__codelineno-50-2 name=__codelineno-50-2 href=#__codelineno-50-2></a><span class=x>&lt;td&gt;{{ product.productTypes.name }}&lt;/td&gt;</span>
<a id=__codelineno-50-3 name=__codelineno-50-3 href=#__codelineno-50-3></a><span class=cp>{%</span> <span class=k>endraw</span> <span class=cp>%}</span>
</code></pre></div> <p>The field <code>price</code> is printed by its formatted using a Volt filter:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-51-1 name=__codelineno-51-1 href=#__codelineno-51-1></a><span class=cp>{%</span> <span class=k>raw</span> <span class=cp>%}</span>
<a id=__codelineno-51-2 name=__codelineno-51-2 href=#__codelineno-51-2></a><span class=x>&lt;td&gt;{{ &#39;%.2f&#39;|format(product.price) }}&lt;/td&gt;</span>
<a id=__codelineno-51-3 name=__codelineno-51-3 href=#__codelineno-51-3></a><span class=cp>{%</span> <span class=k>endraw</span> <span class=cp>%}</span>
</code></pre></div> <p>In plain PHP, this would be:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-52-1 name=__codelineno-52-1 href=#__codelineno-52-1></a><span class=o>&lt;?</span><span class=nx>php</span> <span class=k>echo</span> <span class=nb>sprintf</span><span class=p>(</span><span class=s1>&#39;%.2f&#39;</span><span class=p>,</span> <span class=nv>$product</span><span class=o>-&gt;</span><span class=na>price</span><span class=p>)</span> <span class=cp>?&gt;</span>
</code></pre></div> <p>Printing whether the product is active or not uses a helper implemented in the model:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-53-1 name=__codelineno-53-1 href=#__codelineno-53-1></a><span class=p>{</span><span class=o>%</span> <span class=nx>raw</span> <span class=o>%</span><span class=p>}</span>
<a id=__codelineno-53-2 name=__codelineno-53-2 href=#__codelineno-53-2></a><span class=o>&lt;</span><span class=nx>td</span><span class=o>&gt;</span><span class=p>{{</span> <span class=nx>product</span><span class=o>.</span><span class=nx>getActiveDetail</span><span class=p>()</span> <span class=p>}}</span><span class=o>&lt;/</span><span class=nx>td</span><span class=o>&gt;</span>
<a id=__codelineno-53-3 name=__codelineno-53-3 href=#__codelineno-53-3></a><span class=p>{</span><span class=o>%</span> <span class=nx>endraw</span> <span class=o>%</span><span class=p>}</span>
</code></pre></div> <p>This method is defined in the model.</p> <h2 id=creating-and-updating-records>Creating and Updating Records<a class=headerlink href=#creating-and-updating-records title="Permanent link">&para;</a></h2> <p>Now let's see how the CRUD creates and updates records. From the <code>new</code> and <code>edit</code> views, the data entered by the user is sent to the <code>create</code> and <code>save</code> actions that perform actions of <code>creating</code> and <code>updating</code> products, respectively.</p> <p>In the creation case, we recover the data submitted and assign them to a new <code>Products</code> instance:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-54-1 name=__codelineno-54-1 href=#__codelineno-54-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-54-2 name=__codelineno-54-2 href=#__codelineno-54-2></a>
<a id=__codelineno-54-3 name=__codelineno-54-3 href=#__codelineno-54-3></a><span class=sd>/**</span>
<a id=__codelineno-54-4 name=__codelineno-54-4 href=#__codelineno-54-4></a><span class=sd> * Creates a product based on the data entered in the &#39;new&#39; action</span>
<a id=__codelineno-54-5 name=__codelineno-54-5 href=#__codelineno-54-5></a><span class=sd> */</span>
<a id=__codelineno-54-6 name=__codelineno-54-6 href=#__codelineno-54-6></a><span class=k>public</span> <span class=k>function</span> <span class=nf>createAction</span><span class=p>()</span>
<a id=__codelineno-54-7 name=__codelineno-54-7 href=#__codelineno-54-7></a><span class=p>{</span>
<a id=__codelineno-54-8 name=__codelineno-54-8 href=#__codelineno-54-8></a>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>request</span><span class=o>-&gt;</span><span class=na>isPost</span><span class=p>())</span> <span class=p>{</span>
<a id=__codelineno-54-9 name=__codelineno-54-9 href=#__codelineno-54-9></a>        <span class=k>return</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>dispatcher</span><span class=o>-&gt;</span><span class=na>forward</span><span class=p>(</span>
<a id=__codelineno-54-10 name=__codelineno-54-10 href=#__codelineno-54-10></a>            <span class=p>[</span>
<a id=__codelineno-54-11 name=__codelineno-54-11 href=#__codelineno-54-11></a>                <span class=s1>&#39;controller&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;products&#39;</span><span class=p>,</span>
<a id=__codelineno-54-12 name=__codelineno-54-12 href=#__codelineno-54-12></a>                <span class=s1>&#39;action&#39;</span>     <span class=o>=&gt;</span> <span class=s1>&#39;index&#39;</span><span class=p>,</span>
<a id=__codelineno-54-13 name=__codelineno-54-13 href=#__codelineno-54-13></a>            <span class=p>]</span>
<a id=__codelineno-54-14 name=__codelineno-54-14 href=#__codelineno-54-14></a>        <span class=p>);</span>
<a id=__codelineno-54-15 name=__codelineno-54-15 href=#__codelineno-54-15></a>    <span class=p>}</span>
<a id=__codelineno-54-16 name=__codelineno-54-16 href=#__codelineno-54-16></a>
<a id=__codelineno-54-17 name=__codelineno-54-17 href=#__codelineno-54-17></a>    <span class=nv>$form</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>ProductsForm</span><span class=p>();</span>
<a id=__codelineno-54-18 name=__codelineno-54-18 href=#__codelineno-54-18></a>
<a id=__codelineno-54-19 name=__codelineno-54-19 href=#__codelineno-54-19></a>    <span class=nv>$product</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Products</span><span class=p>();</span>
<a id=__codelineno-54-20 name=__codelineno-54-20 href=#__codelineno-54-20></a>
<a id=__codelineno-54-21 name=__codelineno-54-21 href=#__codelineno-54-21></a>    <span class=nv>$product</span><span class=o>-&gt;</span><span class=na>id</span>               <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>request</span><span class=o>-&gt;</span><span class=na>getPost</span><span class=p>(</span><span class=s1>&#39;id&#39;</span><span class=p>,</span> <span class=s1>&#39;int&#39;</span><span class=p>);</span>
<a id=__codelineno-54-22 name=__codelineno-54-22 href=#__codelineno-54-22></a>    <span class=nv>$product</span><span class=o>-&gt;</span><span class=na>product_types_id</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>request</span><span class=o>-&gt;</span><span class=na>getPost</span><span class=p>(</span><span class=s1>&#39;product_types_id&#39;</span><span class=p>,</span> <span class=s1>&#39;int&#39;</span><span class=p>);</span>
<a id=__codelineno-54-23 name=__codelineno-54-23 href=#__codelineno-54-23></a>    <span class=nv>$product</span><span class=o>-&gt;</span><span class=na>name</span>             <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>request</span><span class=o>-&gt;</span><span class=na>getPost</span><span class=p>(</span><span class=s1>&#39;name&#39;</span><span class=p>,</span> <span class=s1>&#39;striptags&#39;</span><span class=p>);</span>
<a id=__codelineno-54-24 name=__codelineno-54-24 href=#__codelineno-54-24></a>    <span class=nv>$product</span><span class=o>-&gt;</span><span class=na>price</span>            <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>request</span><span class=o>-&gt;</span><span class=na>getPost</span><span class=p>(</span><span class=s1>&#39;price&#39;</span><span class=p>,</span> <span class=s1>&#39;double&#39;</span><span class=p>);</span>
<a id=__codelineno-54-25 name=__codelineno-54-25 href=#__codelineno-54-25></a>    <span class=nv>$product</span><span class=o>-&gt;</span><span class=na>active</span>           <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>request</span><span class=o>-&gt;</span><span class=na>getPost</span><span class=p>(</span><span class=s1>&#39;active&#39;</span><span class=p>);</span>
<a id=__codelineno-54-26 name=__codelineno-54-26 href=#__codelineno-54-26></a>
<a id=__codelineno-54-27 name=__codelineno-54-27 href=#__codelineno-54-27></a>    <span class=c1>// ...</span>
<a id=__codelineno-54-28 name=__codelineno-54-28 href=#__codelineno-54-28></a><span class=p>}</span>
</code></pre></div> <p>Remember the filters we defined in the Products form? Data is filtered before being assigned to the object <code>$product</code>. This filtering is optional; the ORM also escapes the input data and performs additional casting according to the column types:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-55-1 name=__codelineno-55-1 href=#__codelineno-55-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-55-2 name=__codelineno-55-2 href=#__codelineno-55-2></a>
<a id=__codelineno-55-3 name=__codelineno-55-3 href=#__codelineno-55-3></a><span class=c1>// ...</span>
<a id=__codelineno-55-4 name=__codelineno-55-4 href=#__codelineno-55-4></a>
<a id=__codelineno-55-5 name=__codelineno-55-5 href=#__codelineno-55-5></a><span class=nv>$name</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Text</span><span class=p>(</span><span class=s1>&#39;name&#39;</span><span class=p>);</span>
<a id=__codelineno-55-6 name=__codelineno-55-6 href=#__codelineno-55-6></a>
<a id=__codelineno-55-7 name=__codelineno-55-7 href=#__codelineno-55-7></a><span class=nv>$name</span><span class=o>-&gt;</span><span class=na>setLabel</span><span class=p>(</span><span class=s1>&#39;Name&#39;</span><span class=p>);</span>
<a id=__codelineno-55-8 name=__codelineno-55-8 href=#__codelineno-55-8></a>
<a id=__codelineno-55-9 name=__codelineno-55-9 href=#__codelineno-55-9></a><span class=c1>// Filters for name</span>
<a id=__codelineno-55-10 name=__codelineno-55-10 href=#__codelineno-55-10></a><span class=nv>$name</span><span class=o>-&gt;</span><span class=na>setFilters</span><span class=p>(</span>
<a id=__codelineno-55-11 name=__codelineno-55-11 href=#__codelineno-55-11></a>    <span class=p>[</span>
<a id=__codelineno-55-12 name=__codelineno-55-12 href=#__codelineno-55-12></a>        <span class=s1>&#39;striptags&#39;</span><span class=p>,</span>
<a id=__codelineno-55-13 name=__codelineno-55-13 href=#__codelineno-55-13></a>        <span class=s1>&#39;string&#39;</span><span class=p>,</span>
<a id=__codelineno-55-14 name=__codelineno-55-14 href=#__codelineno-55-14></a>    <span class=p>]</span>
<a id=__codelineno-55-15 name=__codelineno-55-15 href=#__codelineno-55-15></a><span class=p>);</span>
<a id=__codelineno-55-16 name=__codelineno-55-16 href=#__codelineno-55-16></a>
<a id=__codelineno-55-17 name=__codelineno-55-17 href=#__codelineno-55-17></a><span class=c1>// Validators for name</span>
<a id=__codelineno-55-18 name=__codelineno-55-18 href=#__codelineno-55-18></a><span class=nv>$name</span><span class=o>-&gt;</span><span class=na>addValidators</span><span class=p>(</span>
<a id=__codelineno-55-19 name=__codelineno-55-19 href=#__codelineno-55-19></a>    <span class=p>[</span>
<a id=__codelineno-55-20 name=__codelineno-55-20 href=#__codelineno-55-20></a>        <span class=k>new</span> <span class=nx>PresenceOf</span><span class=p>(</span>
<a id=__codelineno-55-21 name=__codelineno-55-21 href=#__codelineno-55-21></a>            <span class=p>[</span>
<a id=__codelineno-55-22 name=__codelineno-55-22 href=#__codelineno-55-22></a>                <span class=s1>&#39;message&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;Name is required&#39;</span><span class=p>,</span>
<a id=__codelineno-55-23 name=__codelineno-55-23 href=#__codelineno-55-23></a>            <span class=p>]</span>
<a id=__codelineno-55-24 name=__codelineno-55-24 href=#__codelineno-55-24></a>        <span class=p>)</span>
<a id=__codelineno-55-25 name=__codelineno-55-25 href=#__codelineno-55-25></a>    <span class=p>]</span>
<a id=__codelineno-55-26 name=__codelineno-55-26 href=#__codelineno-55-26></a><span class=p>);</span>
<a id=__codelineno-55-27 name=__codelineno-55-27 href=#__codelineno-55-27></a>
<a id=__codelineno-55-28 name=__codelineno-55-28 href=#__codelineno-55-28></a><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>add</span><span class=p>(</span><span class=nv>$name</span><span class=p>);</span>
</code></pre></div> <p>When saving, we'll know whether the data conforms to the business rules and validations implemented in the form <code>ProductsForm</code> form (<code>app/forms/ProductsForm.php</code>):</p> <div class=highlight><pre><span></span><code><a id=__codelineno-56-1 name=__codelineno-56-1 href=#__codelineno-56-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-56-2 name=__codelineno-56-2 href=#__codelineno-56-2></a>
<a id=__codelineno-56-3 name=__codelineno-56-3 href=#__codelineno-56-3></a><span class=c1>// ...</span>
<a id=__codelineno-56-4 name=__codelineno-56-4 href=#__codelineno-56-4></a>
<a id=__codelineno-56-5 name=__codelineno-56-5 href=#__codelineno-56-5></a><span class=nv>$form</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>ProductsForm</span><span class=p>();</span>
<a id=__codelineno-56-6 name=__codelineno-56-6 href=#__codelineno-56-6></a>
<a id=__codelineno-56-7 name=__codelineno-56-7 href=#__codelineno-56-7></a><span class=nv>$product</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Products</span><span class=p>();</span>
<a id=__codelineno-56-8 name=__codelineno-56-8 href=#__codelineno-56-8></a>
<a id=__codelineno-56-9 name=__codelineno-56-9 href=#__codelineno-56-9></a><span class=c1>// Validate the input</span>
<a id=__codelineno-56-10 name=__codelineno-56-10 href=#__codelineno-56-10></a><span class=nv>$data</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>request</span><span class=o>-&gt;</span><span class=na>getPost</span><span class=p>();</span>
<a id=__codelineno-56-11 name=__codelineno-56-11 href=#__codelineno-56-11></a>
<a id=__codelineno-56-12 name=__codelineno-56-12 href=#__codelineno-56-12></a><span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nv>$form</span><span class=o>-&gt;</span><span class=na>isValid</span><span class=p>(</span><span class=nv>$data</span><span class=p>,</span> <span class=nv>$product</span><span class=p>))</span> <span class=p>{</span>
<a id=__codelineno-56-13 name=__codelineno-56-13 href=#__codelineno-56-13></a>    <span class=nv>$messages</span> <span class=o>=</span> <span class=nv>$form</span><span class=o>-&gt;</span><span class=na>getMessages</span><span class=p>();</span>
<a id=__codelineno-56-14 name=__codelineno-56-14 href=#__codelineno-56-14></a>
<a id=__codelineno-56-15 name=__codelineno-56-15 href=#__codelineno-56-15></a>    <span class=k>foreach</span> <span class=p>(</span><span class=nv>$messages</span> <span class=k>as</span> <span class=nv>$message</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-56-16 name=__codelineno-56-16 href=#__codelineno-56-16></a>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>flash</span><span class=o>-&gt;</span><span class=na>error</span><span class=p>(</span><span class=nv>$message</span><span class=p>);</span>
<a id=__codelineno-56-17 name=__codelineno-56-17 href=#__codelineno-56-17></a>    <span class=p>}</span>
<a id=__codelineno-56-18 name=__codelineno-56-18 href=#__codelineno-56-18></a>
<a id=__codelineno-56-19 name=__codelineno-56-19 href=#__codelineno-56-19></a>    <span class=k>return</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>dispatcher</span><span class=o>-&gt;</span><span class=na>forward</span><span class=p>(</span>
<a id=__codelineno-56-20 name=__codelineno-56-20 href=#__codelineno-56-20></a>        <span class=p>[</span>
<a id=__codelineno-56-21 name=__codelineno-56-21 href=#__codelineno-56-21></a>            <span class=s1>&#39;controller&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;products&#39;</span><span class=p>,</span>
<a id=__codelineno-56-22 name=__codelineno-56-22 href=#__codelineno-56-22></a>            <span class=s1>&#39;action&#39;</span>     <span class=o>=&gt;</span> <span class=s1>&#39;new&#39;</span><span class=p>,</span>
<a id=__codelineno-56-23 name=__codelineno-56-23 href=#__codelineno-56-23></a>        <span class=p>]</span>
<a id=__codelineno-56-24 name=__codelineno-56-24 href=#__codelineno-56-24></a>    <span class=p>);</span>
<a id=__codelineno-56-25 name=__codelineno-56-25 href=#__codelineno-56-25></a><span class=p>}</span>
</code></pre></div> <p>Finally, if the form does not return any validation message we can save the product instance:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-57-1 name=__codelineno-57-1 href=#__codelineno-57-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-57-2 name=__codelineno-57-2 href=#__codelineno-57-2></a>
<a id=__codelineno-57-3 name=__codelineno-57-3 href=#__codelineno-57-3></a><span class=c1>// ...</span>
<a id=__codelineno-57-4 name=__codelineno-57-4 href=#__codelineno-57-4></a>
<a id=__codelineno-57-5 name=__codelineno-57-5 href=#__codelineno-57-5></a><span class=k>if</span> <span class=p>(</span><span class=nv>$product</span><span class=o>-&gt;</span><span class=na>save</span><span class=p>()</span> <span class=o>===</span> <span class=k>false</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-57-6 name=__codelineno-57-6 href=#__codelineno-57-6></a>    <span class=nv>$messages</span> <span class=o>=</span> <span class=nv>$product</span><span class=o>-&gt;</span><span class=na>getMessages</span><span class=p>();</span>
<a id=__codelineno-57-7 name=__codelineno-57-7 href=#__codelineno-57-7></a>
<a id=__codelineno-57-8 name=__codelineno-57-8 href=#__codelineno-57-8></a>    <span class=k>foreach</span> <span class=p>(</span><span class=nv>$messages</span> <span class=k>as</span> <span class=nv>$message</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-57-9 name=__codelineno-57-9 href=#__codelineno-57-9></a>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>flash</span><span class=o>-&gt;</span><span class=na>error</span><span class=p>(</span><span class=nv>$message</span><span class=p>);</span>
<a id=__codelineno-57-10 name=__codelineno-57-10 href=#__codelineno-57-10></a>    <span class=p>}</span>
<a id=__codelineno-57-11 name=__codelineno-57-11 href=#__codelineno-57-11></a>
<a id=__codelineno-57-12 name=__codelineno-57-12 href=#__codelineno-57-12></a>    <span class=k>return</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>dispatcher</span><span class=o>-&gt;</span><span class=na>forward</span><span class=p>(</span>
<a id=__codelineno-57-13 name=__codelineno-57-13 href=#__codelineno-57-13></a>        <span class=p>[</span>
<a id=__codelineno-57-14 name=__codelineno-57-14 href=#__codelineno-57-14></a>            <span class=s1>&#39;controller&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;products&#39;</span><span class=p>,</span>
<a id=__codelineno-57-15 name=__codelineno-57-15 href=#__codelineno-57-15></a>            <span class=s1>&#39;action&#39;</span>     <span class=o>=&gt;</span> <span class=s1>&#39;new&#39;</span><span class=p>,</span>
<a id=__codelineno-57-16 name=__codelineno-57-16 href=#__codelineno-57-16></a>        <span class=p>]</span>
<a id=__codelineno-57-17 name=__codelineno-57-17 href=#__codelineno-57-17></a>    <span class=p>);</span>
<a id=__codelineno-57-18 name=__codelineno-57-18 href=#__codelineno-57-18></a><span class=p>}</span>
<a id=__codelineno-57-19 name=__codelineno-57-19 href=#__codelineno-57-19></a>
<a id=__codelineno-57-20 name=__codelineno-57-20 href=#__codelineno-57-20></a><span class=nv>$form</span><span class=o>-&gt;</span><span class=na>clear</span><span class=p>();</span>
<a id=__codelineno-57-21 name=__codelineno-57-21 href=#__codelineno-57-21></a>
<a id=__codelineno-57-22 name=__codelineno-57-22 href=#__codelineno-57-22></a><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>flash</span><span class=o>-&gt;</span><span class=na>success</span><span class=p>(</span>
<a id=__codelineno-57-23 name=__codelineno-57-23 href=#__codelineno-57-23></a>    <span class=s1>&#39;Product was created successfully&#39;</span>
<a id=__codelineno-57-24 name=__codelineno-57-24 href=#__codelineno-57-24></a><span class=p>);</span>
<a id=__codelineno-57-25 name=__codelineno-57-25 href=#__codelineno-57-25></a>
<a id=__codelineno-57-26 name=__codelineno-57-26 href=#__codelineno-57-26></a><span class=k>return</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>dispatcher</span><span class=o>-&gt;</span><span class=na>forward</span><span class=p>(</span>
<a id=__codelineno-57-27 name=__codelineno-57-27 href=#__codelineno-57-27></a>    <span class=p>[</span>
<a id=__codelineno-57-28 name=__codelineno-57-28 href=#__codelineno-57-28></a>        <span class=s1>&#39;controller&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;products&#39;</span><span class=p>,</span>
<a id=__codelineno-57-29 name=__codelineno-57-29 href=#__codelineno-57-29></a>        <span class=s1>&#39;action&#39;</span>     <span class=o>=&gt;</span> <span class=s1>&#39;index&#39;</span><span class=p>,</span>
<a id=__codelineno-57-30 name=__codelineno-57-30 href=#__codelineno-57-30></a>    <span class=p>]</span>
<a id=__codelineno-57-31 name=__codelineno-57-31 href=#__codelineno-57-31></a><span class=p>);</span>
</code></pre></div> <p>Now, in the case of updating a product, we must first present the user with the data that is currently in the edited record:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-58-1 name=__codelineno-58-1 href=#__codelineno-58-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-58-2 name=__codelineno-58-2 href=#__codelineno-58-2></a>
<a id=__codelineno-58-3 name=__codelineno-58-3 href=#__codelineno-58-3></a><span class=sd>/**</span>
<a id=__codelineno-58-4 name=__codelineno-58-4 href=#__codelineno-58-4></a><span class=sd> * Edits a product based on its id</span>
<a id=__codelineno-58-5 name=__codelineno-58-5 href=#__codelineno-58-5></a><span class=sd> */</span>
<a id=__codelineno-58-6 name=__codelineno-58-6 href=#__codelineno-58-6></a><span class=k>public</span> <span class=k>function</span> <span class=nf>editAction</span><span class=p>(</span><span class=nv>$id</span><span class=p>)</span>
<a id=__codelineno-58-7 name=__codelineno-58-7 href=#__codelineno-58-7></a><span class=p>{</span>
<a id=__codelineno-58-8 name=__codelineno-58-8 href=#__codelineno-58-8></a>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>request</span><span class=o>-&gt;</span><span class=na>isPost</span><span class=p>())</span> <span class=p>{</span>
<a id=__codelineno-58-9 name=__codelineno-58-9 href=#__codelineno-58-9></a>        <span class=nv>$product</span> <span class=o>=</span> <span class=nx>Products</span><span class=o>::</span><span class=na>findFirstById</span><span class=p>(</span><span class=nv>$id</span><span class=p>);</span>
<a id=__codelineno-58-10 name=__codelineno-58-10 href=#__codelineno-58-10></a>
<a id=__codelineno-58-11 name=__codelineno-58-11 href=#__codelineno-58-11></a>        <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nv>$product</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-58-12 name=__codelineno-58-12 href=#__codelineno-58-12></a>            <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>flash</span><span class=o>-&gt;</span><span class=na>error</span><span class=p>(</span>
<a id=__codelineno-58-13 name=__codelineno-58-13 href=#__codelineno-58-13></a>                <span class=s1>&#39;Product was not found&#39;</span>
<a id=__codelineno-58-14 name=__codelineno-58-14 href=#__codelineno-58-14></a>            <span class=p>);</span>
<a id=__codelineno-58-15 name=__codelineno-58-15 href=#__codelineno-58-15></a>
<a id=__codelineno-58-16 name=__codelineno-58-16 href=#__codelineno-58-16></a>            <span class=k>return</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>dispatcher</span><span class=o>-&gt;</span><span class=na>forward</span><span class=p>(</span>
<a id=__codelineno-58-17 name=__codelineno-58-17 href=#__codelineno-58-17></a>                <span class=p>[</span>
<a id=__codelineno-58-18 name=__codelineno-58-18 href=#__codelineno-58-18></a>                    <span class=s1>&#39;controller&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;products&#39;</span><span class=p>,</span>
<a id=__codelineno-58-19 name=__codelineno-58-19 href=#__codelineno-58-19></a>                    <span class=s1>&#39;action&#39;</span>     <span class=o>=&gt;</span> <span class=s1>&#39;index&#39;</span><span class=p>,</span>
<a id=__codelineno-58-20 name=__codelineno-58-20 href=#__codelineno-58-20></a>                <span class=p>]</span>
<a id=__codelineno-58-21 name=__codelineno-58-21 href=#__codelineno-58-21></a>            <span class=p>);</span>
<a id=__codelineno-58-22 name=__codelineno-58-22 href=#__codelineno-58-22></a>        <span class=p>}</span>
<a id=__codelineno-58-23 name=__codelineno-58-23 href=#__codelineno-58-23></a>
<a id=__codelineno-58-24 name=__codelineno-58-24 href=#__codelineno-58-24></a>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>view</span><span class=o>-&gt;</span><span class=na>form</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>ProductsForm</span><span class=p>(</span>
<a id=__codelineno-58-25 name=__codelineno-58-25 href=#__codelineno-58-25></a>            <span class=nv>$product</span><span class=p>,</span>
<a id=__codelineno-58-26 name=__codelineno-58-26 href=#__codelineno-58-26></a>            <span class=p>[</span>
<a id=__codelineno-58-27 name=__codelineno-58-27 href=#__codelineno-58-27></a>                <span class=s1>&#39;edit&#39;</span> <span class=o>=&gt;</span> <span class=k>true</span><span class=p>,</span>
<a id=__codelineno-58-28 name=__codelineno-58-28 href=#__codelineno-58-28></a>            <span class=p>]</span>
<a id=__codelineno-58-29 name=__codelineno-58-29 href=#__codelineno-58-29></a>        <span class=p>);</span>
<a id=__codelineno-58-30 name=__codelineno-58-30 href=#__codelineno-58-30></a>    <span class=p>}</span>
<a id=__codelineno-58-31 name=__codelineno-58-31 href=#__codelineno-58-31></a><span class=p>}</span>
</code></pre></div> <p>The data found is bound to the form by passing the model as first parameter. Thanks to this, the user can change any value and then sent it back to the database through to the <code>save</code> action:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-59-1 name=__codelineno-59-1 href=#__codelineno-59-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-59-2 name=__codelineno-59-2 href=#__codelineno-59-2></a>
<a id=__codelineno-59-3 name=__codelineno-59-3 href=#__codelineno-59-3></a><span class=sd>/**</span>
<a id=__codelineno-59-4 name=__codelineno-59-4 href=#__codelineno-59-4></a><span class=sd> * Updates a product based on the data entered in the &#39;edit&#39; action</span>
<a id=__codelineno-59-5 name=__codelineno-59-5 href=#__codelineno-59-5></a><span class=sd> */</span>
<a id=__codelineno-59-6 name=__codelineno-59-6 href=#__codelineno-59-6></a><span class=k>public</span> <span class=k>function</span> <span class=nf>saveAction</span><span class=p>()</span>
<a id=__codelineno-59-7 name=__codelineno-59-7 href=#__codelineno-59-7></a><span class=p>{</span>
<a id=__codelineno-59-8 name=__codelineno-59-8 href=#__codelineno-59-8></a>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>request</span><span class=o>-&gt;</span><span class=na>isPost</span><span class=p>())</span> <span class=p>{</span>
<a id=__codelineno-59-9 name=__codelineno-59-9 href=#__codelineno-59-9></a>        <span class=k>return</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>dispatcher</span><span class=o>-&gt;</span><span class=na>forward</span><span class=p>(</span>
<a id=__codelineno-59-10 name=__codelineno-59-10 href=#__codelineno-59-10></a>            <span class=p>[</span>
<a id=__codelineno-59-11 name=__codelineno-59-11 href=#__codelineno-59-11></a>                <span class=s1>&#39;controller&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;products&#39;</span><span class=p>,</span>
<a id=__codelineno-59-12 name=__codelineno-59-12 href=#__codelineno-59-12></a>                <span class=s1>&#39;action&#39;</span>     <span class=o>=&gt;</span> <span class=s1>&#39;index&#39;</span><span class=p>,</span>
<a id=__codelineno-59-13 name=__codelineno-59-13 href=#__codelineno-59-13></a>            <span class=p>]</span>
<a id=__codelineno-59-14 name=__codelineno-59-14 href=#__codelineno-59-14></a>        <span class=p>);</span>
<a id=__codelineno-59-15 name=__codelineno-59-15 href=#__codelineno-59-15></a>    <span class=p>}</span>
<a id=__codelineno-59-16 name=__codelineno-59-16 href=#__codelineno-59-16></a>
<a id=__codelineno-59-17 name=__codelineno-59-17 href=#__codelineno-59-17></a>    <span class=nv>$id</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>request</span><span class=o>-&gt;</span><span class=na>getPost</span><span class=p>(</span><span class=s1>&#39;id&#39;</span><span class=p>,</span> <span class=s1>&#39;int&#39;</span><span class=p>);</span>
<a id=__codelineno-59-18 name=__codelineno-59-18 href=#__codelineno-59-18></a>
<a id=__codelineno-59-19 name=__codelineno-59-19 href=#__codelineno-59-19></a>    <span class=nv>$product</span> <span class=o>=</span> <span class=nx>Products</span><span class=o>::</span><span class=na>findFirstById</span><span class=p>(</span><span class=nv>$id</span><span class=p>);</span>
<a id=__codelineno-59-20 name=__codelineno-59-20 href=#__codelineno-59-20></a>
<a id=__codelineno-59-21 name=__codelineno-59-21 href=#__codelineno-59-21></a>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nv>$product</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-59-22 name=__codelineno-59-22 href=#__codelineno-59-22></a>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>flash</span><span class=o>-&gt;</span><span class=na>error</span><span class=p>(</span>
<a id=__codelineno-59-23 name=__codelineno-59-23 href=#__codelineno-59-23></a>            <span class=s1>&#39;Product does not exist&#39;</span>
<a id=__codelineno-59-24 name=__codelineno-59-24 href=#__codelineno-59-24></a>        <span class=p>);</span>
<a id=__codelineno-59-25 name=__codelineno-59-25 href=#__codelineno-59-25></a>
<a id=__codelineno-59-26 name=__codelineno-59-26 href=#__codelineno-59-26></a>        <span class=k>return</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>dispatcher</span><span class=o>-&gt;</span><span class=na>forward</span><span class=p>(</span>
<a id=__codelineno-59-27 name=__codelineno-59-27 href=#__codelineno-59-27></a>            <span class=p>[</span>
<a id=__codelineno-59-28 name=__codelineno-59-28 href=#__codelineno-59-28></a>                <span class=s1>&#39;controller&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;products&#39;</span><span class=p>,</span>
<a id=__codelineno-59-29 name=__codelineno-59-29 href=#__codelineno-59-29></a>                <span class=s1>&#39;action&#39;</span>     <span class=o>=&gt;</span> <span class=s1>&#39;index&#39;</span><span class=p>,</span>
<a id=__codelineno-59-30 name=__codelineno-59-30 href=#__codelineno-59-30></a>            <span class=p>]</span>
<a id=__codelineno-59-31 name=__codelineno-59-31 href=#__codelineno-59-31></a>        <span class=p>);</span>
<a id=__codelineno-59-32 name=__codelineno-59-32 href=#__codelineno-59-32></a>    <span class=p>}</span>
<a id=__codelineno-59-33 name=__codelineno-59-33 href=#__codelineno-59-33></a>
<a id=__codelineno-59-34 name=__codelineno-59-34 href=#__codelineno-59-34></a>    <span class=nv>$form</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>ProductsForm</span><span class=p>();</span>
<a id=__codelineno-59-35 name=__codelineno-59-35 href=#__codelineno-59-35></a>
<a id=__codelineno-59-36 name=__codelineno-59-36 href=#__codelineno-59-36></a>    <span class=nv>$data</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>request</span><span class=o>-&gt;</span><span class=na>getPost</span><span class=p>();</span>
<a id=__codelineno-59-37 name=__codelineno-59-37 href=#__codelineno-59-37></a>
<a id=__codelineno-59-38 name=__codelineno-59-38 href=#__codelineno-59-38></a>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nv>$form</span><span class=o>-&gt;</span><span class=na>isValid</span><span class=p>(</span><span class=nv>$data</span><span class=p>,</span> <span class=nv>$product</span><span class=p>))</span> <span class=p>{</span>
<a id=__codelineno-59-39 name=__codelineno-59-39 href=#__codelineno-59-39></a>        <span class=nv>$messages</span> <span class=o>=</span> <span class=nv>$form</span><span class=o>-&gt;</span><span class=na>getMessages</span><span class=p>();</span>
<a id=__codelineno-59-40 name=__codelineno-59-40 href=#__codelineno-59-40></a>
<a id=__codelineno-59-41 name=__codelineno-59-41 href=#__codelineno-59-41></a>        <span class=k>foreach</span> <span class=p>(</span><span class=nv>$messages</span> <span class=k>as</span> <span class=nv>$message</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-59-42 name=__codelineno-59-42 href=#__codelineno-59-42></a>            <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>flash</span><span class=o>-&gt;</span><span class=na>error</span><span class=p>(</span><span class=nv>$message</span><span class=p>);</span>
<a id=__codelineno-59-43 name=__codelineno-59-43 href=#__codelineno-59-43></a>        <span class=p>}</span>
<a id=__codelineno-59-44 name=__codelineno-59-44 href=#__codelineno-59-44></a>
<a id=__codelineno-59-45 name=__codelineno-59-45 href=#__codelineno-59-45></a>        <span class=k>return</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>dispatcher</span><span class=o>-&gt;</span><span class=na>forward</span><span class=p>(</span>
<a id=__codelineno-59-46 name=__codelineno-59-46 href=#__codelineno-59-46></a>            <span class=p>[</span>
<a id=__codelineno-59-47 name=__codelineno-59-47 href=#__codelineno-59-47></a>                <span class=s1>&#39;controller&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;products&#39;</span><span class=p>,</span>
<a id=__codelineno-59-48 name=__codelineno-59-48 href=#__codelineno-59-48></a>                <span class=s1>&#39;action&#39;</span>     <span class=o>=&gt;</span> <span class=s1>&#39;new&#39;</span><span class=p>,</span>
<a id=__codelineno-59-49 name=__codelineno-59-49 href=#__codelineno-59-49></a>            <span class=p>]</span>
<a id=__codelineno-59-50 name=__codelineno-59-50 href=#__codelineno-59-50></a>        <span class=p>);</span>
<a id=__codelineno-59-51 name=__codelineno-59-51 href=#__codelineno-59-51></a>    <span class=p>}</span>
<a id=__codelineno-59-52 name=__codelineno-59-52 href=#__codelineno-59-52></a>
<a id=__codelineno-59-53 name=__codelineno-59-53 href=#__codelineno-59-53></a>    <span class=k>if</span> <span class=p>(</span><span class=nv>$product</span><span class=o>-&gt;</span><span class=na>save</span><span class=p>()</span> <span class=o>===</span> <span class=k>false</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-59-54 name=__codelineno-59-54 href=#__codelineno-59-54></a>        <span class=nv>$messages</span> <span class=o>=</span> <span class=nv>$product</span><span class=o>-&gt;</span><span class=na>getMessages</span><span class=p>();</span>
<a id=__codelineno-59-55 name=__codelineno-59-55 href=#__codelineno-59-55></a>
<a id=__codelineno-59-56 name=__codelineno-59-56 href=#__codelineno-59-56></a>        <span class=k>foreach</span> <span class=p>(</span><span class=nv>$messages</span> <span class=k>as</span> <span class=nv>$message</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-59-57 name=__codelineno-59-57 href=#__codelineno-59-57></a>            <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>flash</span><span class=o>-&gt;</span><span class=na>error</span><span class=p>(</span><span class=nv>$message</span><span class=p>);</span>
<a id=__codelineno-59-58 name=__codelineno-59-58 href=#__codelineno-59-58></a>        <span class=p>}</span>
<a id=__codelineno-59-59 name=__codelineno-59-59 href=#__codelineno-59-59></a>
<a id=__codelineno-59-60 name=__codelineno-59-60 href=#__codelineno-59-60></a>        <span class=k>return</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>dispatcher</span><span class=o>-&gt;</span><span class=na>forward</span><span class=p>(</span>
<a id=__codelineno-59-61 name=__codelineno-59-61 href=#__codelineno-59-61></a>            <span class=p>[</span>
<a id=__codelineno-59-62 name=__codelineno-59-62 href=#__codelineno-59-62></a>                <span class=s1>&#39;controller&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;products&#39;</span><span class=p>,</span>
<a id=__codelineno-59-63 name=__codelineno-59-63 href=#__codelineno-59-63></a>                <span class=s1>&#39;action&#39;</span>     <span class=o>=&gt;</span> <span class=s1>&#39;new&#39;</span><span class=p>,</span>
<a id=__codelineno-59-64 name=__codelineno-59-64 href=#__codelineno-59-64></a>            <span class=p>]</span>
<a id=__codelineno-59-65 name=__codelineno-59-65 href=#__codelineno-59-65></a>        <span class=p>);</span>
<a id=__codelineno-59-66 name=__codelineno-59-66 href=#__codelineno-59-66></a>    <span class=p>}</span>
<a id=__codelineno-59-67 name=__codelineno-59-67 href=#__codelineno-59-67></a>
<a id=__codelineno-59-68 name=__codelineno-59-68 href=#__codelineno-59-68></a>    <span class=nv>$form</span><span class=o>-&gt;</span><span class=na>clear</span><span class=p>();</span>
<a id=__codelineno-59-69 name=__codelineno-59-69 href=#__codelineno-59-69></a>
<a id=__codelineno-59-70 name=__codelineno-59-70 href=#__codelineno-59-70></a>    <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>flash</span><span class=o>-&gt;</span><span class=na>success</span><span class=p>(</span>
<a id=__codelineno-59-71 name=__codelineno-59-71 href=#__codelineno-59-71></a>        <span class=s1>&#39;Product was updated successfully&#39;</span>
<a id=__codelineno-59-72 name=__codelineno-59-72 href=#__codelineno-59-72></a>    <span class=p>);</span>
<a id=__codelineno-59-73 name=__codelineno-59-73 href=#__codelineno-59-73></a>
<a id=__codelineno-59-74 name=__codelineno-59-74 href=#__codelineno-59-74></a>    <span class=k>return</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>dispatcher</span><span class=o>-&gt;</span><span class=na>forward</span><span class=p>(</span>
<a id=__codelineno-59-75 name=__codelineno-59-75 href=#__codelineno-59-75></a>        <span class=p>[</span>
<a id=__codelineno-59-76 name=__codelineno-59-76 href=#__codelineno-59-76></a>            <span class=s1>&#39;controller&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;products&#39;</span><span class=p>,</span>
<a id=__codelineno-59-77 name=__codelineno-59-77 href=#__codelineno-59-77></a>            <span class=s1>&#39;action&#39;</span>     <span class=o>=&gt;</span> <span class=s1>&#39;index&#39;</span><span class=p>,</span>
<a id=__codelineno-59-78 name=__codelineno-59-78 href=#__codelineno-59-78></a>        <span class=p>]</span>
<a id=__codelineno-59-79 name=__codelineno-59-79 href=#__codelineno-59-79></a>    <span class=p>);</span>
<a id=__codelineno-59-80 name=__codelineno-59-80 href=#__codelineno-59-80></a><span class=p>}</span>
</code></pre></div> <h2 id=user-components>User Components<a class=headerlink href=#user-components title="Permanent link">&para;</a></h2> <p>All the UI elements and visual style of the application has been achieved mostly through <a href=https://getbootstrap.com/ >Bootstrap</a>. Some elements, such as the navigation bar changes according to the state of the application. For example, in the upper right corner, the link <code>Log in / Sign Up</code> changes to <code>Log out</code> if a user is logged into the application.</p> <p>This part of the application is implemented in the component <code>Elements</code> (<code>app/library/Elements.php</code>).</p> <div class=highlight><pre><span></span><code><a id=__codelineno-60-1 name=__codelineno-60-1 href=#__codelineno-60-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-60-2 name=__codelineno-60-2 href=#__codelineno-60-2></a>
<a id=__codelineno-60-3 name=__codelineno-60-3 href=#__codelineno-60-3></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\User\Component</span><span class=p>;</span>
<a id=__codelineno-60-4 name=__codelineno-60-4 href=#__codelineno-60-4></a>
<a id=__codelineno-60-5 name=__codelineno-60-5 href=#__codelineno-60-5></a><span class=k>class</span> <span class=nc>Elements</span> <span class=k>extends</span> <span class=nx>Component</span>
<a id=__codelineno-60-6 name=__codelineno-60-6 href=#__codelineno-60-6></a><span class=p>{</span>
<a id=__codelineno-60-7 name=__codelineno-60-7 href=#__codelineno-60-7></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>getMenu</span><span class=p>()</span>
<a id=__codelineno-60-8 name=__codelineno-60-8 href=#__codelineno-60-8></a>    <span class=p>{</span>
<a id=__codelineno-60-9 name=__codelineno-60-9 href=#__codelineno-60-9></a>        <span class=c1>// ...</span>
<a id=__codelineno-60-10 name=__codelineno-60-10 href=#__codelineno-60-10></a>    <span class=p>}</span>
<a id=__codelineno-60-11 name=__codelineno-60-11 href=#__codelineno-60-11></a>
<a id=__codelineno-60-12 name=__codelineno-60-12 href=#__codelineno-60-12></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>getTabs</span><span class=p>()</span>
<a id=__codelineno-60-13 name=__codelineno-60-13 href=#__codelineno-60-13></a>    <span class=p>{</span>
<a id=__codelineno-60-14 name=__codelineno-60-14 href=#__codelineno-60-14></a>        <span class=c1>// ...</span>
<a id=__codelineno-60-15 name=__codelineno-60-15 href=#__codelineno-60-15></a>    <span class=p>}</span>
<a id=__codelineno-60-16 name=__codelineno-60-16 href=#__codelineno-60-16></a><span class=p>}</span>
</code></pre></div> <p>This class extends the <a href=../api/Phalcon_Mvc_User/ >Phalcon\Mvc\User\Component</a>. It is not imposed to extend a component with this class, but it helps to get access more quickly to the application services. Now, we are going to register our first user component in the services container:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-61-1 name=__codelineno-61-1 href=#__codelineno-61-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-61-2 name=__codelineno-61-2 href=#__codelineno-61-2></a>
<a id=__codelineno-61-3 name=__codelineno-61-3 href=#__codelineno-61-3></a><span class=c1>// Register a user component</span>
<a id=__codelineno-61-4 name=__codelineno-61-4 href=#__codelineno-61-4></a><span class=nv>$di</span><span class=o>-&gt;</span><span class=na>set</span><span class=p>(</span>
<a id=__codelineno-61-5 name=__codelineno-61-5 href=#__codelineno-61-5></a>    <span class=s1>&#39;elements&#39;</span><span class=p>,</span>
<a id=__codelineno-61-6 name=__codelineno-61-6 href=#__codelineno-61-6></a>    <span class=k>function</span> <span class=p>()</span> <span class=p>{</span>
<a id=__codelineno-61-7 name=__codelineno-61-7 href=#__codelineno-61-7></a>        <span class=k>return</span> <span class=k>new</span> <span class=nx>Elements</span><span class=p>();</span>
<a id=__codelineno-61-8 name=__codelineno-61-8 href=#__codelineno-61-8></a>    <span class=p>}</span>
<a id=__codelineno-61-9 name=__codelineno-61-9 href=#__codelineno-61-9></a><span class=p>);</span>
</code></pre></div> <p>As controllers, plugins or components within a view, this component also has access to the services registered in the container and by just accessing an attribute with the same name as a previously registered service:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-62-1 name=__codelineno-62-1 href=#__codelineno-62-1></a><span class=cp>{%</span> <span class=k>raw</span> <span class=cp>%}</span>
<a id=__codelineno-62-2 name=__codelineno-62-2 href=#__codelineno-62-2></a><span class=x>&lt;div class=&#39;navbar navbar-fixed-top&#39;&gt;</span>
<a id=__codelineno-62-3 name=__codelineno-62-3 href=#__codelineno-62-3></a><span class=x>    &lt;div class=&#39;navbar-inner&#39;&gt;</span>
<a id=__codelineno-62-4 name=__codelineno-62-4 href=#__codelineno-62-4></a><span class=x>        &lt;div class=&#39;container&#39;&gt;</span>
<a id=__codelineno-62-5 name=__codelineno-62-5 href=#__codelineno-62-5></a><span class=x>            &lt;a class=&#39;btn btn-navbar&#39; data-toggle=&#39;collapse&#39; data-target=&#39;.nav-collapse&#39;&gt;</span>
<a id=__codelineno-62-6 name=__codelineno-62-6 href=#__codelineno-62-6></a><span class=x>                &lt;span class=&#39;icon-bar&#39;&gt;&lt;/span&gt;</span>
<a id=__codelineno-62-7 name=__codelineno-62-7 href=#__codelineno-62-7></a><span class=x>                &lt;span class=&#39;icon-bar&#39;&gt;&lt;/span&gt;</span>
<a id=__codelineno-62-8 name=__codelineno-62-8 href=#__codelineno-62-8></a><span class=x>                &lt;span class=&#39;icon-bar&#39;&gt;&lt;/span&gt;</span>
<a id=__codelineno-62-9 name=__codelineno-62-9 href=#__codelineno-62-9></a><span class=x>            &lt;/a&gt;</span>
<a id=__codelineno-62-10 name=__codelineno-62-10 href=#__codelineno-62-10></a>
<a id=__codelineno-62-11 name=__codelineno-62-11 href=#__codelineno-62-11></a><span class=x>            &lt;a class=&#39;brand&#39; href=&#39;#&#39;&gt;INVO&lt;/a&gt;</span>
<a id=__codelineno-62-12 name=__codelineno-62-12 href=#__codelineno-62-12></a>
<a id=__codelineno-62-13 name=__codelineno-62-13 href=#__codelineno-62-13></a><span class=x>            {{ elements.getMenu() }}</span>
<a id=__codelineno-62-14 name=__codelineno-62-14 href=#__codelineno-62-14></a><span class=x>        &lt;/div&gt;</span>
<a id=__codelineno-62-15 name=__codelineno-62-15 href=#__codelineno-62-15></a><span class=x>    &lt;/div&gt;</span>
<a id=__codelineno-62-16 name=__codelineno-62-16 href=#__codelineno-62-16></a><span class=x>&lt;/div&gt;</span>
<a id=__codelineno-62-17 name=__codelineno-62-17 href=#__codelineno-62-17></a>
<a id=__codelineno-62-18 name=__codelineno-62-18 href=#__codelineno-62-18></a><span class=x>&lt;div class=&#39;container&#39;&gt;</span>
<a id=__codelineno-62-19 name=__codelineno-62-19 href=#__codelineno-62-19></a><span class=x>    {{ content() }}</span>
<a id=__codelineno-62-20 name=__codelineno-62-20 href=#__codelineno-62-20></a>
<a id=__codelineno-62-21 name=__codelineno-62-21 href=#__codelineno-62-21></a><span class=x>    &lt;hr&gt;</span>
<a id=__codelineno-62-22 name=__codelineno-62-22 href=#__codelineno-62-22></a>
<a id=__codelineno-62-23 name=__codelineno-62-23 href=#__codelineno-62-23></a><span class=x>    &lt;footer&gt;</span>
<a id=__codelineno-62-24 name=__codelineno-62-24 href=#__codelineno-62-24></a><span class=x>        &lt;p&gt;&amp;copy; Company 2017&lt;/p&gt;</span>
<a id=__codelineno-62-25 name=__codelineno-62-25 href=#__codelineno-62-25></a><span class=x>    &lt;/footer&gt;</span>
<a id=__codelineno-62-26 name=__codelineno-62-26 href=#__codelineno-62-26></a><span class=x>&lt;/div&gt;</span>
<a id=__codelineno-62-27 name=__codelineno-62-27 href=#__codelineno-62-27></a><span class=cp>{%</span> <span class=k>endraw</span> <span class=cp>%}</span>
</code></pre></div> <p>The important part is:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-63-1 name=__codelineno-63-1 href=#__codelineno-63-1></a><span class=cp>{%</span> <span class=k>raw</span> <span class=cp>%}</span>
<a id=__codelineno-63-2 name=__codelineno-63-2 href=#__codelineno-63-2></a><span class=x>{{ elements.getMenu() }}</span>
<a id=__codelineno-63-3 name=__codelineno-63-3 href=#__codelineno-63-3></a><span class=cp>{%</span> <span class=k>endraw</span> <span class=cp>%}</span>
</code></pre></div> <h2 id=changing-the-title-dynamically>Changing the Title Dynamically<a class=headerlink href=#changing-the-title-dynamically title="Permanent link">&para;</a></h2> <p>When you browse between one option and another will see that the title changes dynamically indicating where we are currently working. This is achieved in each controller initializer:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-64-1 name=__codelineno-64-1 href=#__codelineno-64-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-64-2 name=__codelineno-64-2 href=#__codelineno-64-2></a>
<a id=__codelineno-64-3 name=__codelineno-64-3 href=#__codelineno-64-3></a><span class=k>class</span> <span class=nc>ProductsController</span> <span class=k>extends</span> <span class=nx>ControllerBase</span>
<a id=__codelineno-64-4 name=__codelineno-64-4 href=#__codelineno-64-4></a><span class=p>{</span>
<a id=__codelineno-64-5 name=__codelineno-64-5 href=#__codelineno-64-5></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>initialize</span><span class=p>()</span>
<a id=__codelineno-64-6 name=__codelineno-64-6 href=#__codelineno-64-6></a>    <span class=p>{</span>
<a id=__codelineno-64-7 name=__codelineno-64-7 href=#__codelineno-64-7></a>        <span class=c1>// Set the document title</span>
<a id=__codelineno-64-8 name=__codelineno-64-8 href=#__codelineno-64-8></a>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>tag</span><span class=o>-&gt;</span><span class=na>setTitle</span><span class=p>(</span>
<a id=__codelineno-64-9 name=__codelineno-64-9 href=#__codelineno-64-9></a>            <span class=s1>&#39;Manage your product types&#39;</span>
<a id=__codelineno-64-10 name=__codelineno-64-10 href=#__codelineno-64-10></a>        <span class=p>);</span>
<a id=__codelineno-64-11 name=__codelineno-64-11 href=#__codelineno-64-11></a>
<a id=__codelineno-64-12 name=__codelineno-64-12 href=#__codelineno-64-12></a>        <span class=k>parent</span><span class=o>::</span><span class=na>initialize</span><span class=p>();</span>
<a id=__codelineno-64-13 name=__codelineno-64-13 href=#__codelineno-64-13></a>    <span class=p>}</span>
<a id=__codelineno-64-14 name=__codelineno-64-14 href=#__codelineno-64-14></a>
<a id=__codelineno-64-15 name=__codelineno-64-15 href=#__codelineno-64-15></a>    <span class=c1>// ...</span>
<a id=__codelineno-64-16 name=__codelineno-64-16 href=#__codelineno-64-16></a><span class=p>}</span>
</code></pre></div> <p>Note, that the method <code>parent::initialize()</code> is also called, it adds more data to the title:</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-65-1 name=__codelineno-65-1 href=#__codelineno-65-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-65-2 name=__codelineno-65-2 href=#__codelineno-65-2></a>
<a id=__codelineno-65-3 name=__codelineno-65-3 href=#__codelineno-65-3></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Controller</span><span class=p>;</span>
<a id=__codelineno-65-4 name=__codelineno-65-4 href=#__codelineno-65-4></a>
<a id=__codelineno-65-5 name=__codelineno-65-5 href=#__codelineno-65-5></a><span class=k>class</span> <span class=nc>ControllerBase</span> <span class=k>extends</span> <span class=nx>Controller</span>
<a id=__codelineno-65-6 name=__codelineno-65-6 href=#__codelineno-65-6></a><span class=p>{</span>
<a id=__codelineno-65-7 name=__codelineno-65-7 href=#__codelineno-65-7></a>    <span class=k>protected</span> <span class=k>function</span> <span class=nf>initialize</span><span class=p>()</span>
<a id=__codelineno-65-8 name=__codelineno-65-8 href=#__codelineno-65-8></a>    <span class=p>{</span>
<a id=__codelineno-65-9 name=__codelineno-65-9 href=#__codelineno-65-9></a>        <span class=c1>// Prepend the application name to the title</span>
<a id=__codelineno-65-10 name=__codelineno-65-10 href=#__codelineno-65-10></a>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>tag</span><span class=o>-&gt;</span><span class=na>prependTitle</span><span class=p>(</span><span class=s1>&#39;INVO | &#39;</span><span class=p>);</span>
<a id=__codelineno-65-11 name=__codelineno-65-11 href=#__codelineno-65-11></a>    <span class=p>}</span>
<a id=__codelineno-65-12 name=__codelineno-65-12 href=#__codelineno-65-12></a>
<a id=__codelineno-65-13 name=__codelineno-65-13 href=#__codelineno-65-13></a>    <span class=c1>// ...</span>
<a id=__codelineno-65-14 name=__codelineno-65-14 href=#__codelineno-65-14></a><span class=p>}</span>
</code></pre></div> Finally, the title is printed in the main view (app/views/index.volt):</p> <div class=highlight><pre><span></span><code><a id=__codelineno-66-1 name=__codelineno-66-1 href=#__codelineno-66-1></a><span class=o>&lt;!</span><span class=nx>DOCTYPE</span> <span class=nx>html</span><span class=o>&gt;</span>
<a id=__codelineno-66-2 name=__codelineno-66-2 href=#__codelineno-66-2></a><span class=o>&lt;</span><span class=nx>html</span><span class=o>&gt;</span>
<a id=__codelineno-66-3 name=__codelineno-66-3 href=#__codelineno-66-3></a>    <span class=o>&lt;</span><span class=nx>head</span><span class=o>&gt;</span>
<a id=__codelineno-66-4 name=__codelineno-66-4 href=#__codelineno-66-4></a>        <span class=o>&lt;?</span><span class=nx>php</span> <span class=k>echo</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>tag</span><span class=o>-&gt;</span><span class=na>getTitle</span><span class=p>();</span> <span class=cp>?&gt;</span>
<a id=__codelineno-66-5 name=__codelineno-66-5 href=#__codelineno-66-5></a><span class=x>    &lt;/head&gt;</span>
<a id=__codelineno-66-6 name=__codelineno-66-6 href=#__codelineno-66-6></a>
<a id=__codelineno-66-7 name=__codelineno-66-7 href=#__codelineno-66-7></a><span class=x>    &lt;!-- ... --&gt;</span>
<a id=__codelineno-66-8 name=__codelineno-66-8 href=#__codelineno-66-8></a><span class=x>&lt;/html&gt;</span>
</code></pre></div> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../tutorial-basic/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Basic"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> Basic </div> </div> </a> <a href=../tutorial-rest/ class="md-footer__link md-footer__link--next" aria-label="Next: REST"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> REST </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2012 - present Phalcon Team </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://phalcon.io/discord target=_blank rel=noopener title=Discord class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 640 512"><!-- Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M524.531 69.836a1.5 1.5 0 0 0-.764-.7A485 485 0 0 0 404.081 32.03a1.82 1.82 0 0 0-1.923.91 338 338 0 0 0-14.9 30.6 447.9 447.9 0 0 0-134.426 0 310 310 0 0 0-15.135-30.6 1.89 1.89 0 0 0-1.924-.91 483.7 483.7 0 0 0-119.688 37.107 1.7 1.7 0 0 0-.788.676C39.068 183.651 18.186 294.69 28.43 404.354a2.02 2.02 0 0 0 .765 1.375 487.7 487.7 0 0 0 146.825 74.189 1.9 1.9 0 0 0 2.063-.676A348 348 0 0 0 208.12 430.4a1.86 1.86 0 0 0-1.019-2.588 321 321 0 0 1-45.868-21.853 1.885 1.885 0 0 1-.185-3.126 251 251 0 0 0 9.109-7.137 1.82 1.82 0 0 1 1.9-.256c96.229 43.917 200.41 43.917 295.5 0a1.81 1.81 0 0 1 1.924.233 235 235 0 0 0 9.132 7.16 1.884 1.884 0 0 1-.162 3.126 301.4 301.4 0 0 1-45.89 21.83 1.875 1.875 0 0 0-1 2.611 391 391 0 0 0 30.014 48.815 1.86 1.86 0 0 0 2.063.7A486 486 0 0 0 610.7 405.729a1.88 1.88 0 0 0 .765-1.352c12.264-126.783-20.532-236.912-86.934-334.541M222.491 337.58c-28.972 0-52.844-26.587-52.844-59.239s23.409-59.241 52.844-59.241c29.665 0 53.306 26.82 52.843 59.239 0 32.654-23.41 59.241-52.843 59.241m195.38 0c-28.971 0-52.843-26.587-52.843-59.239s23.409-59.241 52.843-59.241c29.667 0 53.307 26.82 52.844 59.239 0 32.654-23.177 59.241-52.844 59.241"/></svg> </a> <a href=https://phalcon.io/discussions target=_blank rel=noopener title="GitHub Discussions" class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9 22a1 1 0 0 1-1-1v-3H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2h-6.1l-3.7 3.71c-.2.19-.45.29-.7.29z"/></svg> </a> <a href=https://phalcon.io/github target=_blank rel=noopener title="GitHub Project" class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> <a href=https://phalcon.io/telegram target=_blank rel=noopener title=Telegram class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M248 8C111.033 8 0 119.033 0 256s111.033 248 248 248 248-111.033 248-248S384.967 8 248 8m114.952 168.66c-3.732 39.215-19.881 134.378-28.1 178.3-3.476 18.584-10.322 24.816-16.948 25.425-14.4 1.326-25.338-9.517-39.287-18.661-21.827-14.308-34.158-23.215-55.346-37.177-24.485-16.135-8.612-25 5.342-39.5 3.652-3.793 67.107-61.51 68.335-66.746.153-.655.3-3.1-1.154-4.384s-3.59-.849-5.135-.5q-3.283.746-104.608 69.142-14.845 10.194-26.894 9.934c-8.855-.191-25.888-5.006-38.551-9.123-15.531-5.048-27.875-7.717-26.8-16.291q.84-6.7 18.45-13.7 108.446-47.248 144.628-62.3c68.872-28.647 83.183-33.623 92.511-33.789 2.052-.034 6.639.474 9.61 2.885a10.45 10.45 0 0 1 3.53 6.716 43.8 43.8 0 0 1 .417 9.769"/></svg> </a> <a href=https://phalcon.io/gab target=_blank rel=noopener title=Gab class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 576 512"><!-- Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M368 32c41.7 0 75.9 31.8 79.7 72.5l85.6 26.3c25.4 7.8 42.8 31.3 42.8 57.9 0 21.8-11.7 41.9-30.7 52.7l-144.6 82.1 92.5 92.5H544c17.7 0 32 14.3 32 32s-14.3 32-32 32h-64c-8.5 0-16.6-3.4-22.6-9.4L346.9 360.2c11.7-36 3.2-77.1-25.4-105.7-40.6-40.6-106.3-40.6-146.9-.1l-73.6 70c-6.4 6.1-6.7 16.2-.6 22.6s16.2 6.6 22.6.6l73.8-70.2.1-.1.1-.1c3.5-3.5 7.3-6.6 11.3-9.2 27.9-18.5 65.9-15.4 90.5 9.2 24.7 24.7 27.7 62.9 9 90.9-2.6 3.8-5.6 7.5-9 10.9l-37 37H352c17.7 0 32 14.3 32 32s-14.3 32-32 32H64c-35.3 0-64-28.7-64-64C0 249.6 127 112.9 289.3 97.5 296.2 60.2 328.8 32 368 32m0 104a24 24 0 1 0 0-48 24 24 0 1 0 0 48"/></svg> </a> <a href=https://phalcon.io/t target=_blank rel=noopener title=Twitter class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8l164.9-188.5L26.8 48h145.6l100.5 132.9zm-24.8 373.8h39.1L151.1 88h-42z"/></svg> </a> <a href=https://phalcon.io/fb target=_blank rel=noopener title=Facebook class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M512 256C512 114.6 397.4 0 256 0S0 114.6 0 256c0 120 82.7 220.8 194.2 248.5V334.2h-52.8V256h52.8v-33.7c0-87.1 39.4-127.5 125-127.5 16.2 0 44.2 3.2 55.7 6.4V172c-6-.6-16.5-1-29.6-1-42 0-58.2 15.9-58.2 57.2V256h83.6l-14.4 78.2H287v175.9C413.8 494.8 512 386.9 512 256"/></svg> </a> <a href=https://phalcon.io/linkedin target=_blank rel=noopener title=LinkedIn class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5m282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg> </a> <a href=https://phalcon.io/youtube target=_blank rel=noopener title=LinkedIn class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 576 512"><!-- Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305m-317.51 213.508V175.185l142.739 81.205z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <script id=__config type=application/json>{"base": "..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.code.select", "content.tooltips", "navigation.footer", "navigation.indexes", "navigation.instant", "navigation.instant.progress", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script> <script src=../assets/javascripts/bundle.88dd0f4e.min.js></script> </body> </html>